import{cn as x,co as g,r as c,cp as q,k as E}from"./index-YgCCTjDf.js";var S=()=>{const[r,n]=c.useState(""),[s,t]=c.useState(""),a=c.useCallback(q(i=>t(i),300),[]);return c.useEffect(()=>(a(r),()=>a.cancel()),[r,a]),{searchValue:r,onSearchValueChange:n,query:s||void 0}},I=({queryKey:r,queryFn:n,getOptions:s,defaultValue:t,defaultValueKey:a,pageSize:i=10,enabled:u=!0})=>{const{searchValue:f,onSearchValueChange:b,query:m}=S(),v=a||"id",{data:y}=x({queryKey:r,queryFn:async()=>n({[v]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t&&u}),{data:h,...d}=g({queryKey:[...r,m],queryFn:async({pageParam:e=0})=>await n({q:m,limit:i,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:E,enabled:u}),o=(h==null?void 0:h.pages.flatMap(e=>s(e)))??[],l=y?s(y):[],D=!d.isPending&&!o.length&&!f||!u;return t&&l.length&&!f&&l.forEach(e=>{o.find(p=>p.value===e.value)||o.unshift(e)}),{options:o,searchValue:f,onSearchValueChange:b,disabled:D,...d}};export{S as a,I as u};
