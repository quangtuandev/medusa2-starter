import{u as g}from"./chunk-YIZSVS2R-BCa6gext.js";import{C as b}from"./chunk-GZBFGV7Y-BD-1aP4e.js";import{K as I}from"./chunk-6HTZNHPT-GPn7HI7g.js";import{b as t,u as q}from"./chunk-ZCO6EK4W-D1Hp_Okz.js";import{b as L,h as K,j as e,H as k,af as w,ag as z,eB as B,t as V,w as n,I as M,B as F,aj as i,s as C}from"./index-BesHffBj.js";import{S as c}from"./select-reKGyaD3.js";import"./triangles-mini-R_jLwpox.js";import"./plus-mini-BVC5XQYu.js";import"./prompt-vcbHvE-h.js";import"./check-DuTwIOJD.js";var R=i.object({name:i.string().min(1),default_currency_code:i.string().optional(),default_region_id:i.string().optional(),default_sales_channel_id:i.string().optional(),default_location_id:i.string().optional()}),H=({store:s})=>{var y,S;const{t:r}=L(),{handleSuccess:f}=q(),l=w({defaultValues:{name:s.name,default_region_id:s.default_region_id||void 0,default_currency_code:((S=(y=s.supported_currencies)==null?void 0:y.find(a=>a.is_default))==null?void 0:S.currency_code)||void 0,default_sales_channel_id:s.default_sales_channel_id||void 0,default_location_id:s.default_location_id||void 0},resolver:z(R)}),{mutateAsync:j,isPending:p}=B(s.id),u=g({queryKey:["regions","default_region_id"],queryFn:a=>C.admin.region.list({...a,fields:"id,name"}),defaultValue:s.default_region_id||void 0,getOptions:a=>a.regions.map(o=>({label:o.name,value:o.id}))}),m=g({queryFn:a=>C.admin.salesChannel.list({...a,fields:"id,name"}),getOptions:a=>a.sales_channels.map(o=>({label:o.name,value:o.id})),queryKey:["sales_channels","default_sales_channel_id"],defaultValue:s.default_sales_channel_id||void 0}),h=g({queryFn:a=>C.admin.stockLocation.list({...a,fields:"id,name"}),getOptions:a=>a.stock_locations.map(o=>({label:o.name,value:o.id})),queryKey:["stock_locations","default_location_id"],defaultValue:s.default_location_id||void 0}),E=l.handleSubmit(async a=>{var v;const{default_currency_code:o,..._}=a,d={..._,supported_currencies:(v=s.supported_currencies)==null?void 0:v.map(x=>({...x,is_default:x.currency_code===o}))};await j(d,{onSuccess:()=>{V.success(r("store.toast.update")),f()},onError:x=>{V.error(x.message)}})});return e.jsx(t.Form,{form:l,children:e.jsxs(I,{onSubmit:E,className:"flex h-full flex-col",children:[e.jsx(t.Body,{children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsx(n.Field,{control:l.control,name:"name",render:({field:a})=>e.jsxs(n.Item,{children:[e.jsx(n.Label,{children:r("fields.name")}),e.jsx(n.Control,{children:e.jsx(M,{placeholder:"ACME",...a})}),e.jsx(n.ErrorMessage,{})]})}),e.jsx(n.Field,{control:l.control,name:"default_currency_code",render:({field:{onChange:a,...o}})=>{var _;return e.jsxs(n.Item,{children:[e.jsx(n.Label,{children:r("store.defaultCurrency")}),e.jsx(n.Control,{children:e.jsxs(c,{...o,onValueChange:a,children:[e.jsx(c.Trigger,{ref:o.ref,children:e.jsx(c.Value,{})}),e.jsx(c.Content,{children:(_=s.supported_currencies)==null?void 0:_.map(d=>e.jsx(c.Item,{value:d.currency_code,children:d.currency_code.toUpperCase()},d.currency_code))})]})})]})}}),e.jsx(n.Field,{control:l.control,name:"default_region_id",render:({field:a})=>e.jsxs(n.Item,{children:[e.jsx(n.Label,{children:r("store.defaultRegion")}),e.jsx(n.Control,{children:e.jsx(b,{...a,options:u.options,searchValue:u.searchValue,onSearchValueChange:u.onSearchValueChange,disabled:u.disabled})})]})}),e.jsx(n.Field,{control:l.control,name:"default_sales_channel_id",render:({field:a})=>e.jsxs(n.Item,{children:[e.jsx(n.Label,{children:r("store.defaultSalesChannel")}),e.jsx(n.Control,{children:e.jsx(b,{...a,options:m.options,searchValue:m.searchValue,onSearchValueChange:m.onSearchValueChange,disabled:m.disabled})})]})}),e.jsx(n.Field,{control:l.control,name:"default_location_id",render:({field:a})=>e.jsxs(n.Item,{children:[e.jsx(n.Label,{children:r("store.defaultLocation")}),e.jsx(n.Control,{children:e.jsx(b,{...a,options:h.options,searchValue:h.searchValue,onSearchValueChange:h.onSearchValueChange,disabled:h.disabled})})]})})]})}),e.jsx(t.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(t.Close,{asChild:!0,children:e.jsx(F,{size:"small",variant:"secondary",children:r("actions.cancel")})}),e.jsx(F,{size:"small",isLoading:p,type:"submit",children:r("actions.save")})]})})]})})},Q=()=>{const{t:s}=L(),{store:r,isPending:f,isError:l,error:j}=K();if(l)throw j;const p=!!r&&!f;return e.jsxs(t,{children:[e.jsx(t.Header,{children:e.jsx(k,{children:s("store.edit.header")})}),p&&e.jsx(H,{store:r})]})};export{Q as Component};
