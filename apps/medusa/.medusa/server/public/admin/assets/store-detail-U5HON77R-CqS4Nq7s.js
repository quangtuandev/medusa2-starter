import{u as V,a as Z,b as ee}from"./chunk-NEZX6265-4US7xnsm.js";import{d as se,h as re,a as te,j as e,dP as ie,ex as ae,ey as ne,q as Q,b as v,eu as ce,i as oe,bb as le,C as H,H as K,K as l,A as k,a3 as _,L as b,r as T,m as de,ez as J,a2 as ue,a1 as j,f as me,J as B,k as pe,t as h,eA as ge}from"./index-C3yGK_aL.js";import{S as xe}from"./chunk-ADOCJB6L-BMBwo4W1.js";import{u as he,_ as fe}from"./chunk-O6K7WXYN-BQ1QWn5z.js";import"./lodash-rUKIuOpM.js";import"./chunk-CIE5NZAY-B2Jivpb8.js";import{S as je}from"./chunk-2RQLKDBF-f2FiInzT.js";import{P as ye}from"./pencil-square-dqEis_fX.js";import{u as W}from"./use-prompt-dvRTLdBQ.js";import{X as _e}from"./x-circle-COFDWm4O.js";import{T as ve}from"./trash-8_n4yJ7m.js";import"./chunk-MSDRGCRR-Dt4W8YdQ.js";import"./chunk-P3UUX2T6-BJ2rYC2m.js";import"./chunk-C76H5USB-DgXYXjlf.js";import"./chunk-YEDAFXMB-xYNQ2GOF.js";import"./chunk-AOFGTNG6-DTwwgog4.js";import"./chunk-EMIHDNB7-Dfar3Se6.js";import"./plus-mini-CIkmqSQ3.js";import"./chunk-PWBTCXBJ-Cf2-uLa4.js";import"./format-D7z6fqVd.js";import"./_isIndex-DRu5FeBA.js";import"./index-BQI6RcAQ.js";import"./Trans-DLyHg8H6.js";import"./check-BWHxrb8O.js";import"./prompt-BrGfVhtU.js";var Ce=()=>({queryKey:ne.details(),queryFn:async()=>ae()}),Ve=async()=>{const s=Ce();return Q.getQueryData(s.queryKey)??await Q.fetchQuery(s)},Se=({store:s})=>{var a,m,x;const{t:r}=v(),{region:t}=ce(s.default_region_id,void 0,{enabled:!!s.default_region_id}),i=(a=s.supported_currencies)==null?void 0:a.find(f=>f.is_default),{sales_channel:o}=oe(s.default_sales_channel_id,{enabled:!!s.default_sales_channel_id}),{stock_location:c}=le(s.default_location_id,{fields:"id,name"},{enabled:!!s.default_location_id});return e.jsxs(H,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsx(K,{children:r("store.domain")}),e.jsx(l,{className:"text-ui-fg-subtle",size:"small",children:r("store.manageYourStoresDetails")})]}),e.jsx(k,{groups:[{actions:[{icon:e.jsx(ye,{}),label:r("actions.edit"),to:"edit"}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(l,{size:"small",leading:"compact",weight:"plus",children:r("fields.name")}),e.jsx(l,{size:"small",leading:"compact",children:s.name})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(l,{size:"small",leading:"compact",weight:"plus",children:r("store.defaultCurrency")}),i?e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(_,{size:"2xsmall",children:(m=i.currency_code)==null?void 0:m.toUpperCase()}),e.jsx(l,{size:"small",leading:"compact",children:(x=i.currency)==null?void 0:x.name})]}):e.jsx(l,{size:"small",leading:"compact",children:"-"})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(l,{size:"small",leading:"compact",weight:"plus",children:r("store.defaultRegion")}),e.jsx("div",{className:"flex items-center gap-x-2",children:t?e.jsx(_,{size:"2xsmall",asChild:!0,children:e.jsx(b,{to:`/settings/regions/${t.id}`,children:t.name})}):e.jsx(l,{size:"small",leading:"compact",children:"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(l,{size:"small",leading:"compact",weight:"plus",children:r("store.defaultSalesChannel")}),e.jsx("div",{className:"flex items-center gap-x-2",children:o?e.jsx(_,{size:"2xsmall",asChild:!0,children:e.jsx(b,{to:`/settings/sales-channels/${o.id}`,children:o.name})}):e.jsx(l,{size:"small",leading:"compact",children:"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(l,{size:"small",leading:"compact",weight:"plus",children:r("store.defaultLocation")}),e.jsx("div",{className:"flex items-center gap-x-2",children:c?e.jsx(_,{size:"2xsmall",asChild:!0,children:e.jsx(b,{to:`/settings/locations/${c.id}`,children:c.name})}):e.jsx(l,{size:"small",leading:"compact",children:"-"})})]})]})},w=10,be=({store:s})=>{var E,I,R,D,A,q,L,M;const[r,t]=T.useState({}),{searchParams:i,raw:o}=V({pageSize:w}),{currencies:c,count:a,isPending:m,isError:x,error:f}=Z({code:(E=s.supported_currencies)==null?void 0:E.map(n=>n.currency_code),...i},{placeholderData:pe,enabled:!!((I=s.supported_currencies)!=null&&I.length)}),{price_preferences:g,isPending:y,isError:p,error:u}=de({attribute:"currency_code",value:(R=s.supported_currencies)==null?void 0:R.map(n=>n.currency_code)},{enabled:!!((D=s.supported_currencies)!=null&&D.length)}),z=Pe(),N=T.useMemo(()=>new Map(g==null?void 0:g.map(n=>[n.value,n])),[g]),Y=c==null?void 0:c.map(n=>{var C;return{...n,is_tax_inclusive:(C=N.get(n.code))==null?void 0:C.is_tax_inclusive}}),{table:$}=he({data:Y??[],columns:z,count:a,getRowId:n=>n.code,rowSelection:{state:r,updater:t},enablePagination:!0,enableRowSelection:!0,pageSize:w,meta:{storeId:s.id,supportedCurrencies:s.supported_currencies,defaultCurrencyCode:(q=(A=s.supported_currencies)==null?void 0:A.find(n=>n.is_default))==null?void 0:q.currency_code,preferencesMap:N}}),{mutateAsync:G}=J(s.id),{t:d}=v(),U=W(),X=async()=>{var O;const n=Object.keys(r);await U({title:d("general.areYouSure"),description:d("store.removeCurrencyWarning",{count:n.length}),confirmText:d("actions.remove"),cancelText:d("actions.cancel")})&&await G({supported_currencies:((O=s.supported_currencies)==null?void 0:O.filter(S=>!n.includes(S.currency_code)))??[]},{onSuccess:()=>{t({}),h.success(d("store.toast.currenciesRemoved"))},onError:S=>{h.error(S.message)}})};if(x)throw f;if(p)throw u;const F=m||y;return e.jsxs(H,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(K,{level:"h2",children:d("store.currencies")}),e.jsx(k,{groups:[{actions:[{icon:e.jsx(ue,{}),label:d("actions.add"),to:"currencies"}]}]})]}),e.jsx(fe,{orderBy:[{key:"name",label:d("fields.name")},{key:"code",label:d("fields.code")}],search:!0,pagination:!0,table:$,pageSize:w,columns:z,count:(L=s.supported_currencies)!=null&&L.length?a:0,isLoading:(M=s.supported_currencies)!=null&&M.length?F:!1,queryObject:o}),e.jsx(j,{open:!!Object.keys(r).length,children:e.jsxs(j.Bar,{children:[e.jsx(j.Value,{children:d("general.countSelected",{count:Object.keys(r).length})}),e.jsx(j.Seperator,{}),e.jsx(j.Command,{action:X,shortcut:"r",label:d("actions.remove")})]})})]})},we=({storeId:s,currency:r,supportedCurrencies:t,defaultCurrencyCode:i,preferencesMap:o})=>{var g,y;const{mutateAsync:c}=J(s),{t:a}=v(),m=W(),x=async()=>{await m({title:a("general.areYouSure"),description:a("store.removeCurrencyWarning",{count:1}),verificationInstruction:a("general.typeToConfirm"),verificationText:r.name,confirmText:a("actions.remove"),cancelText:a("actions.cancel")})&&await c({supported_currencies:t.filter(u=>u.currency_code!==r.code)},{onSuccess:()=>{h.success(a("store.toast.currenciesRemoved"))},onError:u=>{h.error(u.message)}})},f=async()=>{await c({supported_currencies:t.map(p=>{const u=o.get(p.currency_code);return{...p,is_tax_inclusive:p.currency_code===r.code?!(u!=null&&u.is_tax_inclusive):void 0}})},{onSuccess:()=>{h.success(a("store.toast.updatedTaxInclusivitySuccessfully"))},onError:p=>{h.error(p.message)}})};return e.jsx(k,{groups:[{actions:[{icon:(g=o.get(r.code))!=null&&g.is_tax_inclusive?e.jsx(_e,{}):e.jsx(ge,{}),label:(y=o.get(r.code))!=null&&y.is_tax_inclusive?a("store.disableTaxInclusivePricing"):a("store.enableTaxInclusivePricing"),onClick:f}]},{actions:[{icon:e.jsx(ve,{}),label:a("actions.remove"),onClick:x,disabled:r.code===i}]}]})},P=me(),Pe=()=>{const s=ee(),{t:r}=v();return T.useMemo(()=>[P.display({id:"select",header:({table:t})=>e.jsx(B,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:i=>t.toggleAllPageRowsSelected(!!i)}),cell:({row:t})=>e.jsx(B,{checked:t.getIsSelected(),onCheckedChange:i=>t.toggleSelected(!!i),onClick:i=>{i.stopPropagation()}})}),...s,P.accessor("is_tax_inclusive",{header:r("fields.taxInclusivePricing"),cell:({getValue:t})=>{const i=t();return e.jsx(xe,{color:i?"green":"grey",children:r(i?"fields.true":"fields.false")})}}),P.display({id:"actions",cell:({row:t,table:i})=>{const{supportedCurrencies:o,storeId:c,defaultCurrencyCode:a,preferencesMap:m}=i.options.meta;return e.jsx(we,{storeId:c,currency:t.original,supportedCurrencies:o,defaultCurrencyCode:a,preferencesMap:m})}})],[s,r])},Ze=()=>{const s=se(),{store:r,isPending:t,isError:i,error:o}=re(void 0,{initialData:s}),{getWidgets:c}=te();if(t||!r)return e.jsx(ie,{sections:2,showJSON:!0,showMetadata:!0});if(i)throw o;return e.jsxs(je,{widgets:{before:c("store.details.before"),after:c("store.details.after")},data:r,hasOutlet:!0,showMetadata:!0,showJSON:!0,children:[e.jsx(Se,{store:r}),e.jsx(be,{store:r})]})};export{Ze as Component,Ve as loader};
