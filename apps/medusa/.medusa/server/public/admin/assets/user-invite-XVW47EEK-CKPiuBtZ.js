import{u as A,_ as C}from"./chunk-YNFSSLHT-8nzYWYsK.js";import{r as i,j as a,b,ay as D,az as F,as as L,fk as R,H as I,a2 as U,J as u,K as z,B as H,C as B,au as $,g as q,ag as h,ae as y,ci as p,h as K,A as J,du as V,T as Q,dF as W}from"./index-DZUwpLH1.js";import{u as G}from"./chunk-C76H5USB-DwnlpqZR.js";import"./chunk-5JIBQRMV-BiEXXYr3.js";import{K as X}from"./chunk-6HTZNHPT-DhHk_kZ7.js";import{R as f}from"./chunk-AERWK3TJ-CHqJbyLZ.js";import{u as Y,a as Z,b as ee,c as ae}from"./chunk-RLY2SL5E-Cf17h_E9.js";import{T as re}from"./Trans-C4ztlIzE.js";import{A as se}from"./alert-NB2t1Zev.js";import"./chunk-HQKGZADC-DzTw7O4Q.js";import"./chunk-EMIHDNB7-HK_0mzMX.js";import"./chunk-PFKKVLZX-BBIQEAuX.js";import"./index-5B0enKCo.js";var te=Object.defineProperty,x=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,P=(e,r,s)=>r in e?te(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,ne=(e,r)=>{for(var s in r||(r={}))M.call(r,s)&&P(e,s,r[s]);if(x)for(var s of x(r))N.call(r,s)&&P(e,s,r[s]);return e},ie=(e,r)=>{var s={};for(var t in e)M.call(e,t)&&r.indexOf(t)<0&&(s[t]=e[t]);if(e!=null&&x)for(var t of x(e))r.indexOf(t)<0&&N.call(e,t)&&(s[t]=e[t]);return s};const S=i.forwardRef((e,r)=>{var s=e,{color:t="currentColor"}=s,n=ie(s,["color"]);return i.createElement("svg",ne({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},n),i.createElement("g",{stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},i.createElement("path",{d:"m6.44 3.965 1.59-1.591a3.25 3.25 0 1 1 4.597 4.596l-1.591 1.59M3.964 6.44l-1.59 1.59a3.25 3.25 0 1 0 4.596 4.597l1.59-1.591M5.909 9.09 9.091 5.91"})),i.createElement("defs",null,i.createElement("clipPath",{id:"a"},i.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});S.displayName="Link";var le=({prefix:e,pageSize:r=20})=>{const s=G(["offset","q","order","created_at","updated_at"],e),{offset:t,created_at:n,updated_at:l,q:o,order:c}=s;return{searchParams:{limit:r,offset:t?Number(t):0,order:c,created_at:n?JSON.parse(n):void 0,updated_at:l?JSON.parse(l):void 0,q:o},raw:s}},oe=L({email:$().email()}),j=10,g="usr_invite",ce=`${window.location.origin}/app/invite?token=`,de=()=>{const{t:e}=b(),r=D({defaultValues:{email:""},resolver:F(oe)}),{raw:s,searchParams:t}=le({prefix:g,pageSize:j}),{invites:n,count:l,isPending:o,isError:c,error:d}=Y(t),w=ue(),{table:E}=A({data:n??[],columns:w,count:l,enablePagination:!0,getRowId:m=>m.id,pageSize:j,prefix:g}),{mutateAsync:k,isPending:O}=Z(),T=r.handleSubmit(async m=>{try{await k({email:m.email}),r.reset()}catch(v){if(R(v)&&v.status===400){r.setError("root",{type:"manual",message:v.message});return}}});if(c)throw d;return a.jsx(f.Form,{form:r,children:a.jsxs(X,{onSubmit:T,className:"flex h-full flex-col overflow-hidden",children:[a.jsx(f.Header,{}),a.jsx(f.Body,{className:"flex flex-1 flex-col overflow-hidden",children:a.jsx("div",{className:"flex flex-1 flex-col items-center overflow-y-auto",children:a.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8 px-2 py-16",children:[a.jsxs("div",{children:[a.jsx(I,{children:e("users.inviteUser")}),a.jsx(U,{size:"small",className:"text-ui-fg-subtle",children:e("users.inviteUserHint")})]}),r.formState.errors.root&&a.jsx(se,{variant:"error",dismissible:!1,className:"text-balance",children:r.formState.errors.root.message}),a.jsxs("div",{className:"flex flex-col gap-y-4",children:[a.jsx("div",{className:"grid grid-cols-2 gap-4",children:a.jsx(u.Field,{control:r.control,name:"email",render:({field:m})=>a.jsxs(u.Item,{children:[a.jsx(u.Label,{children:e("fields.email")}),a.jsx(u.Control,{children:a.jsx(z,{...m})}),a.jsx(u.ErrorMessage,{})]})})}),a.jsx("div",{className:"flex items-center justify-end",children:a.jsx(H,{size:"small",variant:"secondary",type:"submit",isLoading:O,children:e("users.sendInvite")})})]}),a.jsxs("div",{className:"flex flex-col gap-y-4",children:[a.jsx(I,{level:"h2",children:e("users.pendingInvites")}),a.jsx(B,{className:"overflow-hidden p-0",children:a.jsx(C,{table:E,columns:w,count:l,pageSize:j,pagination:!0,search:"autofocus",isLoading:o,queryObject:s,prefix:g,orderBy:[{key:"email",label:e("fields.email")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}]})})]})]})})})]})})},me=({invite:e})=>{const{mutateAsync:r}=ee(e.id),{mutateAsync:s}=ae(e.id),t=K(),{t:n}=b(),l=async()=>{await t({title:n("general.areYouSure"),description:n("users.deleteInviteWarning",{email:e.email}),cancelText:n("actions.cancel"),confirmText:n("actions.delete")})&&await r()},o=async()=>{await s()},c=()=>{const d=`${ce}${e.token}`;W(d)};return a.jsx(J,{groups:[{actions:[{icon:a.jsx(V,{}),label:n("users.resendInvite"),onClick:o}]},{actions:[{icon:a.jsx(S,{}),label:n("users.copyInviteLink"),onClick:c}]},{actions:[{icon:a.jsx(Q,{}),label:n("actions.delete"),onClick:l}]}]})},_=q(),ue=()=>{const{t:e}=b();return i.useMemo(()=>[_.accessor("email",{header:e("fields.email"),cell:({getValue:r})=>r()}),_.accessor("accepted",{header:e("fields.status"),cell:({getValue:r,row:s})=>{const t=r(),n=new Date(s.original.expires_at)<new Date;return t?a.jsx(h,{content:e("users.acceptedOnDate",{date:p(new Date(s.original.updated_at),"dd MMM, yyyy")}),children:a.jsx(y,{color:"green",children:e("users.inviteStatus.accepted")})}):n?a.jsx(h,{content:e("users.expiredOnDate",{date:p(new Date(s.original.expires_at),"dd MMM, yyyy")}),children:a.jsx(y,{color:"red",children:e("users.inviteStatus.expired")})}):a.jsx(h,{content:a.jsx(re,{i18nKey:"users.validFromUntil",components:[a.jsx("span",{className:"font-medium"},"from"),a.jsx("span",{className:"font-medium"},"untill")],values:{from:p(new Date(s.original.created_at),"dd MMM, yyyy"),until:p(new Date(s.original.expires_at),"dd MMM, yyyy")}}),children:a.jsx(y,{color:"orange",children:e("users.inviteStatus.pending")})})}}),_.display({id:"actions",cell:({row:r})=>a.jsx(me,{invite:r.original})})],[e])},Me=()=>a.jsx(f,{children:a.jsx(de,{})});export{Me as Component};
