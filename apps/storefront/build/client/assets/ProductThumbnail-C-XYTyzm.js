import{r as l,j as c,i as k,f as T}from"./chunk-OIYGIGL5-Dw2D8vFu.js";import{e as z,m as D,u as H,a as F,F as _,c as V,i as $,f as y,g as q}from"./PlusIcon-CC2IgzJn.js";import{u as G,M as K}from"./MorphingShape-C-uetyU5.js";import{c as b}from"./clsx-B-dksMZM.js";import{I as W}from"./Image-DrDZq5nI.js";var w=(t=>(t.cart="cart",t.login="login",t.search="search",t))(w||{}),j=(t=>(t.toggle="toggle",t.set="set",t))(j||{});const M=l.createContext(null),Z={set:(t,{target:e,state:r})=>({...t,[e]:D({},t[e],r)}),toggle:(t,{target:e,open:r,state:o})=>({...t,[e]:D({},t[e],o,{open:r??!t[e].open})})},J=z({actionHandlers:Z}),Q={cart:{},login:{},search:{}},it=({data:t,...e})=>{const[r,o]=l.useReducer(J,Q);return c.jsx(M.Provider,{value:{state:D({},r,t),dispatch:o},...e})},S=(t,e)=>typeof e=="boolean"?{name:j.toggle,payload:{open:e,target:t}}:{name:j.toggle,payload:{...e,target:t}},U=({dispatch:t})=>({toggleCartDrawer:e=>t(S(w.cart,e)),toggleLoginModal:e=>t(S(w.login,e)),toggleSearchDrawer:e=>t(S(w.search,e))}),X=()=>{const t=l.useContext(M);if(!t)throw new Error("useStorefront must be used within a StorefrontContext.Provider");return{...t,actions:U(t)}},Y=()=>{var A,N,R,P,B;const{state:t,actions:e}=X(),r=H(),o=k(),[a,s]=l.useState(!1),d=l.useRef(null),i=l.useRef(0),u={removing:o.find(n=>{var v;return(n.state==="submitting"||n.state==="loading")&&n.key===F.cart.removeLineItem&&((v=n.formData)==null?void 0:v.get("lineItemId"))}),adding:o.filter(n=>{var v;return n.key===F.cart.createLineItem&&(n.state==="submitting"||n.state==="loading")&&((v=n.formData)==null?void 0:v.has("variantId"))})},f=r==null?void 0:r.cart,E=(f==null?void 0:f.items)||[],g=E.length;u.removing&&console.log("removing",(N=(A=u.removing)==null?void 0:A.formData)==null?void 0:N.get("lineItemId"));const h=u.adding.length>0,p=(P=(R=u.removing)==null?void 0:R.formData)==null?void 0:P.get("lineItemId"),x=p&&(g===1&&p===((B=E[0])==null?void 0:B.id)||g===0&&i.current===1&&u.removing),m=l.useCallback(()=>{d.current!==null&&(window.clearTimeout(d.current),d.current=null)},[]),I=l.useCallback(n=>{n!==!!t.cart.open&&(e.toggleCartDrawer(n),n||s(!1))},[e,t.cart.open]);l.useEffect(()=>{m();const n=!!t.cart.open;return x&&!a&&(s(!0),n&&(d.current=window.setTimeout(()=>{e.toggleCartDrawer(!1),s(!1)},1500))),i.current=g,m},[t.cart.open,g,x,a,e,m]),l.useEffect(()=>{(!t.cart.open||h)&&s(!1)},[t.cart.open,h]),l.useEffect(()=>m,[m]);const C=!h&&g===0&&!a,O=t.cart.open===!0;return{cart:f,isAddingItem:h,isRemovingItemId:p,isRemovingLastItem:a,cartDrawerOpen:O,toggleCartDrawer:I,showEmptyCartMessage:C}},tt=()=>{var r,o;const t=T({key:F.cart.createLineItem});return{addToCart:a=>{const s=new FormData;s.append("productId",a.productId),s.append("quantity",String(a.quantity||1)),a.options&&Object.entries(a.options).forEach(([d,i])=>{s.append(`options.${d}`,i)}),t.submit(s,{method:"post",action:"/api/cart/line-items/create"})},isLoading:t.state==="submitting"||t.state==="loading",error:(r=t.data)==null?void 0:r.errors,cart:(o=t.data)==null?void 0:o.cart,state:t.state}},lt=({product:t,selectedOptions:e={},quantity:r=1,disabled:o=!1,className:a,variant:s="primary",size:d="md",isFullText:i=!1})=>{const{t:u}=G(),{addToCart:f,isLoading:E}=tt(),{toggleCartDrawer:g}=Y(),h=C=>{C.preventDefault(),f({productId:t.id,options:e,quantity:r}),g(!0)},p=o||E,x="font-medium rounded-[100px] transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 flex items-center p-2",m={primary:{enabled:"bg-black text-white hover:bg-gray-800 focus:ring-gray-500",disabled:"bg-gray-300 text-gray-500 cursor-not-allowed"},secondary:{enabled:"bg-white text-black border border-black hover:bg-gray-50 focus:ring-gray-500",disabled:"bg-gray-100 text-gray-400 border border-gray-300 cursor-not-allowed"}},I=b(x,p?m[s].disabled:m[s].enabled,a);return c.jsxs("button",{onClick:h,disabled:p,className:b(I,{"justify-center":i}),"aria-label":`${u("common.addToCart")} ${t.title}`,children:[c.jsx("i",{hidden:i,className:"w-4",children:c.jsx(_,{className:"size-1"})}),c.jsx("span",{className:b("text-nowrap btn-add ",{"text-center":i,"opacity-0 w-0 h-0 transition-all duration-300 group-hover/product-card:opacity-100 group-hover/product-card:w-auto group-hover/product-card:h-auto":!i}),children:" Add to cart"})]})},et=({variant:t,currencyCode:e})=>{const{original:r,calculated:o}=V(t),a=$(o)&&o<(r??0);return c.jsx(c.Fragment,{children:a?c.jsxs("span",{className:"inline-flex items-center gap-1",children:[c.jsx("span",{children:y(o,{currency:e})}),c.jsx("s",{className:"text-gray-400",children:y(r||0,{currency:e})})]}):y(r||0,{currency:e})})},dt=({product:t,currencyCode:e,...r})=>{const o=l.useMemo(()=>r.variant||q(t),[r.variant,t,e]);return o?c.jsx(et,{variant:o,currencyCode:e}):null},L={BLOSSOM:{colorStart:"#FFFFFF",colorEnd:"#6DCB8F",offsetStart:8.85,offsetEnd:79.19},SAFFRON:{colorStart:"#BEB1F8",colorEnd:"#8F5DDB",offsetStart:8.85,offsetEnd:79.19},HAZE:{colorStart:"#BFFAED",colorEnd:"#BBEE7C",offsetStart:8.85,offsetEnd:79.19},RICE:{colorStart:"#EEF7FF",colorEnd:"#A2D4FD",offsetStart:8.85,offsetEnd:79.19},LATTE:{colorStart:"#E4E3D8",colorEnd:"#89E4BB",offsetStart:8.85,offsetEnd:79.19},COFFEE:{colorStart:"#F5DDDD",colorEnd:"#FFB578",offsetStart:8.85,offsetEnd:79.19}},rt=(t=null)=>{const e=t?L[t]:Object.values(L),r=Array.isArray(e)?e[Math.floor(Math.random()*e.length)]:e;return{blur:20,zoom:.42,className:"flex justify-center",id:Math.random().toString(36).substring(2,15),...r}},ut=t=>{let e=t.trim();if(e.includes(" ")){const[s,...d]=e.split(/\s+/);return[s,"_"+d.join(" ")]}const r=Math.floor(e.length/2),o=e.slice(0,r),a=e.slice(r);return[o,"_"+a]},mt=({product:t,className:e,isTransitioning:r,classNameImage:o,isRemoveStyleDefault:a=!1,forcedZoom:s,...d})=>{const i=t.images&&t.images[0]&&t.images[0].url||t.thumbnail,u=t.images&&t.images[1]&&t.images[1].url;return c.jsxs("figure",{className:b("product-thumbnail overflow-hidden",!a&&"aspect-w-1 aspect-h-1 w-full",e),style:{viewTransitionName:r?"product-thumbnail":void 0},...d,children:[c.jsx(K,{...rt(t.subtitle),zoom:s,classNameWrapper:b(a&&"!h-auto")}),i?c.jsx(W,{loading:"lazy",src:i,alt:t.title,className:b("h-full w-full object-cover object-center transition-all duration-300 -rotate-[14deg]",{"group-hover/product-card:opacity-75":!u,"relative top-[-200px]":a},o)}):c.jsx("div",{className:"flex h-full w-full items-center justify-center object-cover object-center group-hover/product-card:opacity-75",children:"No Image"})]})};export{lt as A,et as P,it as S,mt as a,dt as b,ut as g,rt as r,Q as s,Y as u};
