import{j as r,r as m,i as Nt,g as Et,R as S,f as ee,L as Ye,a as _t,w as At,u as wt}from"./chunk-OIYGIGL5-Dw2D8vFu.js";import{b as Pt,h as kt,x as It,D as Rt,M as Tt,a as z,F as Ce,A as Ot,o as Dt,s as Te,e as Ft,c as Oe,f as Lt,d as Bt,m as Mt,g as de}from"./data-table-router-form-DXpTcO2C.js";import{u as Je,e as Ut,h as qt,d as Vt,a as pe,f as me}from"./PlusIcon-CC2IgzJn.js";import{B as Q}from"./Button-nspP1mxw.js";import{c as U}from"./clsx-B-dksMZM.js";import{u as $t,a as Wt,F as Gt,b as Kt}from"./useRegions-Hug1TnGg.js";import{o as H,c as Yt,s as j,d as ge,e as De,b as oe}from"./zod-ydI_oUWi.js";import{u as ze,a as ie,R as ae,S as Ne}from"./SubmitButton-OHl3iZdz.js";import{n as Jt,Q as zt}from"./QuantitySelector-CNu5O9Zp.js";import{I as Qt}from"./Image-DrDZq5nI.js";import{B as Ht}from"./ButtonLink-BCp6hWhH.js";import{d as te}from"./tabs-W0_EixNg.js";import"./createLucideIcon-BU51__11.js";import"./index-6F69r3HC.js";import"./use-is-mounted-Dk7IirPH.js";const ve=(e,t=new FormData,n="")=>e==null?t:typeof e=="object"&&!(e instanceof Date)&&!(e instanceof File)?(Object.entries(e).forEach(([s,i])=>{ve(i,t,n?e[s]instanceof File?n:`${n}.${s}`:s)}),t):Array.isArray(e)?(e.forEach((s,i)=>{ve(s,t,`${n}.${i}`)}),t):(t.append(n,e),t),Xt=H({cartId:j(),shippingOptionIds:Yt(j())}),Zt=H({cartId:j(),customerId:j().optional(),email:j().email("Please enter a valid email"),shippingAddress:H({firstName:j().min(1,"First name is required"),lastName:j().min(1,"Last name is required"),company:j().optional(),address1:j().min(1,"Address is required"),address2:j().optional(),city:j().min(1,"City is required"),province:j().min(1,"Province is required"),countryCode:j().min(1,"Country is required"),postalCode:j().min(1,"Postal code is required"),phone:j().optional()}),shippingAddressId:j(),isExpressCheckout:ge().optional()}),en=H({lineItemId:j().min(1,"Line item ID is required"),quantity:Jt().int()}),tn=H({cartId:j(),code:j().min(1,"Discount code is required")});function nn(e){const{control:t}=ze(),{components:n,...s}=e,i={FormDescription:Tt,FormControl:Rt,FormLabel:It,FormMessage:kt,...n};return r.jsx(Pt,{control:t,components:i,...s})}const xe={firstName:"",lastName:"",company:"",address1:"",address2:"",city:"",province:"",postalCode:"",countryCode:"",phone:""},Ee=e=>e?{...xe,firstName:(e==null?void 0:e.first_name)||"",lastName:(e==null?void 0:e.last_name)||"",company:(e==null?void 0:e.company)||"",address1:(e==null?void 0:e.address_1)||"",address2:(e==null?void 0:e.address_2)||"",city:(e==null?void 0:e.city)||"",countryCode:(e==null?void 0:e.country_code)||"",phone:(e==null?void 0:e.phone)||"",postalCode:(e==null?void 0:e.postal_code)||"",province:(e==null?void 0:e.province)||""}:xe,_e=e=>{const t=e.reduce((n,s)=>{const i=s.shipping_profile_id;return i&&(n[i]||(n[i]=[]),n[i].push(s)),n},{});return Object.keys(t).forEach(n=>t[n].sort((s,i)=>(s.amount||0)-(i.amount||0))),t},rn=(e,t)=>!!e.email||!!(t!=null&&t.email),Ae=e=>{var t;return!!((t=e.shipping_address)!=null&&t.address_1)},sn=(e,t)=>{var i;const n=((i=e.shipping_methods)==null?void 0:i.map(o=>o.shipping_option_id))||[],s=_e(t);return Object.values(s).every(o=>o.find(a=>n.includes(a.id)))};function on(e){if((e==null?void 0:e.length)<1)return 0;const t=_e(e);return Object.values(t).reduce((n,s)=>{const i=s.reduce((o,a)=>(o.amount||0)<((a==null?void 0:a.amount)||0)?o:a);return n+(i.amount||0)},0)}const an=H({firstName:j().min(1,"First name is required").optional(),lastName:j().min(1,"Last name is required").optional(),company:j().optional(),address1:j().min(1,"Address is required").optional(),address2:j().optional(),city:j().min(1,"City is required").optional(),province:j().min(1,"Province is required").optional(),countryCode:j().min(1,"Country is required"),postalCode:j().min(1,"Postal code is required"),phone:j().optional()}),cn=H({cartId:j(),providerId:j(),paymentMethodId:j(),sameAsShipping:ge().optional(),billingAddress:De(),noRedirect:ge().optional()}).refine(e=>e.sameAsShipping?De():an.safeParse(e.billingAddress).success,{message:"Valid billing address is required when creating a new address",path:["root"]}),we=()=>{const e=Je();return{customer:e==null?void 0:e.customer}};var K=(e=>(e.CONTACT_INFO="contactInfo",e.ACCOUNT_DETAILS="accountDetails",e.PAYMENT="payment",e.SUCCESS="success",e))(K||{});const Qe=e=>{const{cart:t}=e,{customer:n}=we(),s=!!(n!=null&&n.id),i=m.useMemo(()=>rn(t,n),[t,n]),o=m.useMemo(()=>Ae(t),[t,s]);let a="accountDetails";return i&&(a="accountDetails"),o&&(a="payment"),a},He=m.createContext(null),ln={setStep:(e,t)=>({...e,step:t})},un=Ut({actionHandlers:ln}),dn=({data:e,...t})=>{const s={step:Qe({...e}),cart:null,shippingOptions:[],paymentProviders:[],activePaymentSession:null},[i,o]=m.useReducer(un,s);return r.jsx(He.Provider,{value:{state:{...i,...e},dispatch:o},...t})},pn=({dispatch:e})=>({setStep:t=>e({name:"setStep",payload:t})}),q=()=>{const e=m.useContext(He),t=Qe(e.state),{state:n}=e,i=Nt().filter(o=>o.key.startsWith(qt));if(!n.step)throw new Error("useCheckout must be used within a CheckoutProvider");return{...n,...pn(e),goToNextStep:()=>e.dispatch({name:"setStep",payload:t}),isCartMutating:i.some(o=>["loading","submitting"].includes(o.state))}},be=({className:e,name:t,...n})=>r.jsx(z,{...n,className:U("[&_input]:!h-12 [&_input]:border-gray-200 [&_input]:!bg-white [&_input]:text-[16px] [&_input]:shadow-sm [&_input]:!ring-0","[&_input:-webkit-autofill]:!transition-[background-color_5000s_ease-in-out_0s]","[&_input:-webkit-autofill]:!shadow-[0_0_0_1000px_white_inset]","[&_label]:text-[16px] [&_label]:text-gray-600",e),name:t});function mn({title:e,titleId:t,...n},s){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},n),e?m.createElement("title",{id:t},e):null,m.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const fn=m.forwardRef(mn),Xe=({completed:e,setStep:t,step:n,children:s})=>r.jsxs("header",{className:"relative flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s}),e&&r.jsxs(r.Fragment,{children:[r.jsx(Q,{className:"text-sm",variant:"link",onClick:()=>t(n),children:"Edit"}),r.jsx("span",{className:"absolute -left-10 mt-0.5 hidden h-6 w-6 items-center justify-center rounded-full bg-green-100 text-green-700 md:flex",children:r.jsx(fn,{className:"h-4 w-4"})})]})]}),Ze=({address:e,prefix:t})=>r.jsx(r.Fragment,{children:Object.keys(e).map(n=>{const s=n;if(e[s]!=null)return r.jsx(z,{type:"hidden",name:`${t}.${n}`,value:e[s]??""},s)})}),Pe=()=>{const e=Je();if(!(e!=null&&e.env))throw new Error("No env data found, this should be provided in the root loader");return{env:e==null?void 0:e.env}};var et={exports:{}},hn="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",yn=hn,gn=yn;function tt(){}function nt(){}nt.resetWarningCache=tt;var vn=function(){function e(s,i,o,a,l,c){if(c!==gn){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:nt,resetWarningCache:tt};return n.PropTypes=n,n};et.exports=vn();var xn=et.exports;const E=Et(xn);function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fe(Object(n),!0).forEach(function(s){rt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function ue(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ue=function(t){return typeof t}:ue=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(e)}function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function st(e,t){return bn(e)||jn(e,t)||Sn(e,t)||Cn()}function bn(e){if(Array.isArray(e))return e}function jn(e,t){var n=e&&(typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"]);if(n!=null){var s=[],i=!0,o=!1,a,l;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(s.push(a.value),!(t&&s.length===t));i=!0);}catch(c){o=!0,l=c}finally{try{!i&&n.return!=null&&n.return()}finally{if(o)throw l}}return s}}function Sn(e,t){if(e){if(typeof e=="string")return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}}function Be(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function Cn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=function(t,n,s){var i=!!s,o=S.useRef(s);S.useEffect(function(){o.current=s},[s]),S.useEffect(function(){if(!i||!t)return function(){};var a=function(){o.current&&o.current.apply(o,arguments)};return t.on(n,a),function(){t.off(n,a)}},[i,n,t,o])},je=function(t){var n=S.useRef(t);return S.useEffect(function(){n.current=t},[t]),n.current},Z=function(t){return t!==null&&ue(t)==="object"},Nn=function(t){return Z(t)&&typeof t.then=="function"},En=function(t){return Z(t)&&typeof t.elements=="function"&&typeof t.createToken=="function"&&typeof t.createPaymentMethod=="function"&&typeof t.confirmCardPayment=="function"},Me="[object Object]",_n=function e(t,n){if(!Z(t)||!Z(n))return t===n;var s=Array.isArray(t),i=Array.isArray(n);if(s!==i)return!1;var o=Object.prototype.toString.call(t)===Me,a=Object.prototype.toString.call(n)===Me;if(o!==a)return!1;if(!o&&!s)return t===n;var l=Object.keys(t),c=Object.keys(n);if(l.length!==c.length)return!1;for(var d={},u=0;u<l.length;u+=1)d[l[u]]=!0;for(var p=0;p<c.length;p+=1)d[c[p]]=!0;var h=Object.keys(d);if(h.length!==l.length)return!1;var b=t,y=n,v=function(f){return e(b[f],y[f])};return h.every(v)},ot=function(t,n,s){return Z(t)?Object.keys(t).reduce(function(i,o){var a=!Z(n)||!_n(t[o],n[o]);return s.includes(o)?(a&&console.warn("Unsupported prop change: options.".concat(o," is not a mutable property.")),i):a?Le(Le({},i||{}),{},rt({},o,t[o])):i},null):null},it="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",Ue=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:it;if(t===null||En(t))return t;throw new Error(n)},An=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:it;if(Nn(t))return{tag:"async",stripePromise:Promise.resolve(t).then(function(i){return Ue(i,n)})};var s=Ue(t,n);return s===null?{tag:"empty"}:{tag:"sync",stripe:s}},wn=function(t){!t||!t._registerWrapper||!t.registerAppInfo||(t._registerWrapper({name:"react-stripe-js",version:"2.7.3"}),t.registerAppInfo({name:"react-stripe-js",version:"2.7.3",url:"https://stripe.com/docs/stripe-js/react"}))},fe=S.createContext(null);fe.displayName="ElementsContext";var at=function(t,n){if(!t)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return t},ke=function(t){var n=t.stripe,s=t.options,i=t.children,o=S.useMemo(function(){return An(n)},[n]),a=S.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(s):null}}),l=st(a,2),c=l[0],d=l[1];S.useEffect(function(){var h=!0,b=function(v){d(function(x){return x.stripe?x:{stripe:v,elements:v.elements(s)}})};return o.tag==="async"&&!c.stripe?o.stripePromise.then(function(y){y&&h&&b(y)}):o.tag==="sync"&&!c.stripe&&b(o.stripe),function(){h=!1}},[o,c,s]);var u=je(n);S.useEffect(function(){u!==null&&u!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[u,n]);var p=je(s);return S.useEffect(function(){if(c.elements){var h=ot(s,p,["clientSecret","fonts"]);h&&c.elements.update(h)}},[s,p,c.elements]),S.useEffect(function(){wn(c.stripe)},[c.stripe]),S.createElement(fe.Provider,{value:c},i)};ke.propTypes={stripe:E.any,options:E.object};var Pn=function(t){var n=S.useContext(fe);return at(n,t)},kn=function(){var t=Pn("calls useElements()"),n=t.elements;return n};E.func.isRequired;var ct=S.createContext(null);ct.displayName="CustomCheckoutSdkContext";var In=function(t,n){if(!t)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(n," in an <CustomCheckoutProvider> provider."));return t},Rn=S.createContext(null);Rn.displayName="CustomCheckoutContext";E.any,E.shape({clientSecret:E.string.isRequired,elementsOptions:E.object}).isRequired;var Se=function(t){var n=S.useContext(ct),s=S.useContext(fe);if(n&&s)throw new Error("You cannot wrap the part of your app that ".concat(t," in both <CustomCheckoutProvider> and <Elements> providers."));return n?In(n,t):at(s,t)},Tn=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},I=function(t,n){var s="".concat(Tn(t),"Element"),i=function(c){var d=c.id,u=c.className,p=c.options,h=p===void 0?{}:p,b=c.onBlur,y=c.onFocus,v=c.onReady,x=c.onChange,f=c.onEscape,A=c.onClick,_=c.onLoadError,w=c.onLoaderStart,g=c.onNetworksChange,k=c.onConfirm,T=c.onCancel,D=c.onShippingAddressChange,C=c.onShippingRateChange,O=Se("mounts <".concat(s,">")),B="elements"in O?O.elements:null,$="customCheckoutSdk"in O?O.customCheckoutSdk:null,N=S.useState(null),Y=st(N,2),F=Y[0],Ct=Y[1],W=S.useRef(null),he=S.useRef(null);M(F,"blur",b),M(F,"focus",y),M(F,"escape",f),M(F,"click",A),M(F,"loaderror",_),M(F,"loaderstart",w),M(F,"networkschange",g),M(F,"confirm",k),M(F,"cancel",T),M(F,"shippingaddresschange",D),M(F,"shippingratechange",C),M(F,"change",x);var ye;v&&(t==="expressCheckout"?ye=v:ye=function(){v(F)}),M(F,"ready",ye),S.useLayoutEffect(function(){if(W.current===null&&he.current!==null&&(B||$)){var V=null;$?V=$.createElement(t,h):B&&(V=B.create(t,h)),W.current=V,Ct(V),V&&V.mount(he.current)}},[B,$,h]);var Re=je(h);return S.useEffect(function(){if(W.current){var V=ot(h,Re,["paymentRequest"]);V&&W.current.update(V)}},[h,Re]),S.useLayoutEffect(function(){return function(){if(W.current&&typeof W.current.destroy=="function")try{W.current.destroy(),W.current=null}catch{}}},[]),S.createElement("div",{id:d,className:u,ref:he})},o=function(c){Se("mounts <".concat(s,">"));var d=c.id,u=c.className;return S.createElement("div",{id:d,className:u})},a=n?o:i;return a.propTypes={id:E.string,className:E.string,onChange:E.func,onBlur:E.func,onFocus:E.func,onReady:E.func,onEscape:E.func,onClick:E.func,onLoadError:E.func,onLoaderStart:E.func,onNetworksChange:E.func,onConfirm:E.func,onCancel:E.func,onShippingAddressChange:E.func,onShippingRateChange:E.func,options:E.object},a.displayName=s,a.__elementType=t,a},R=typeof window>"u",On=S.createContext(null);On.displayName="EmbeddedCheckoutProviderContext";var Dn=function(){var t=Se("calls useStripe()"),n=t.stripe;return n};I("auBankAccount",R);I("card",R);I("cardNumber",R);I("cardExpiry",R);I("cardCvc",R);I("fpxBank",R);I("iban",R);I("idealBank",R);I("p24Bank",R);I("epsBank",R);var Fn=I("payment",R);I("expressCheckout",R);I("paymentRequestButton",R);I("linkAuthentication",R);var Ln=I("address",R);I("shippingAddress",R);I("paymentMethodMessaging",R);I("affirmMessage",R);I("afterpayClearpayMessage",R);var lt="https://js.stripe.com/v3",Bn=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var Mn=function(){for(var t=document.querySelectorAll('script[src^="'.concat(lt,'"]')),n=0;n<t.length;n++){var s=t[n];if(Bn.test(s.src))return s}return null},qe=function(t){var n="",s=document.createElement("script");s.src="".concat(lt).concat(n);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(s),s},Un=function(t,n){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:n})},ne=null,ce=null,le=null,qn=function(t){return function(){t(new Error("Failed to load Stripe.js"))}},Vn=function(t,n){return function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))}},$n=function(t){return ne!==null?ne:(ne=new Promise(function(n,s){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var i=Mn();if(!(i&&t)){if(!i)i=qe(t);else if(i&&le!==null&&ce!==null){var o;i.removeEventListener("load",le),i.removeEventListener("error",ce),(o=i.parentNode)===null||o===void 0||o.removeChild(i),i=qe(t)}}le=Vn(n,s),ce=qn(s),i.addEventListener("load",le),i.addEventListener("error",ce)}catch(a){s(a);return}}),ne.catch(function(n){return ne=null,Promise.reject(n)}))},Wn=function(t,n,s){if(t===null)return null;var i=t.apply(void 0,n);return Un(i,s),i},re,ut=!1,dt=function(){return re||(re=$n(null).catch(function(t){return re=null,Promise.reject(t)}),re)};Promise.resolve().then(function(){return dt()}).catch(function(e){ut||console.warn(e)});var pt=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];ut=!0;var i=Date.now();return dt().then(function(o){return Wn(o,n,i)})};const Gn=e=>({address:{firstName:(e==null?void 0:e.first_name)||"",lastName:(e==null?void 0:e.last_name)||"",address1:(e==null?void 0:e.address_1)||"",address2:(e==null?void 0:e.address_2)||"",province:(e==null?void 0:e.province)||"",city:(e==null?void 0:e.city)||"",countryCode:(e==null?void 0:e.country_code)||"us",postalCode:(e==null?void 0:e.postal_code)||"",phone:(e==null?void 0:e.phone)||""},completed:!1}),mt=({title:e,address:t,mode:n,allowedCountries:s=[],setAddress:i})=>{var u;const{env:o}=Pe(),{cart:a}=q(),{region:l}=Vt(),c=p=>{var x,f;const h=((x=p.value.name)==null?void 0:x.split(" "))||[],b=h.slice(0,-1).join(" "),y=h.slice(-1).join(" "),v=p.complete&&!p.value.address.state;i({address:{firstName:p.value.firstName||b||"",lastName:p.value.lastName||y||"",address1:p.value.address.line1,address2:p.value.address.line2??"",province:v?"-":p.value.address.state,city:p.value.address.city,countryCode:(f=p.value.address.country)==null?void 0:f.toLowerCase(),postalCode:p.value.address.postal_code,phone:p.value.phone??""},completed:p.complete})},d=m.useMemo(()=>o.STRIPE_PUBLIC_KEY?pt(o.STRIPE_PUBLIC_KEY):null,[o.STRIPE_PUBLIC_KEY]);return a?r.jsxs("div",{children:[e&&r.jsx("h3",{className:"mt-6 text-sm",children:e}),r.jsx(ke,{stripe:d,options:{mode:"setup",currency:l.currency_code,appearance:{variables:{borderRadius:"6px",spacingUnit:"4.601px",fontSizeBase:"16px",colorText:"#374151",fontWeightNormal:"400",fontWeightBold:"700",fontSizeSm:"16px"},rules:{".Input":{fontSize:"1rem",color:"#000000"},".Input:focus":{boxShadow:"inset 0 0 0 1px rgba(210, 213, 218, 1)"},".Label":{FontWeight:"700"}}}},children:r.jsx(Ln,{options:{mode:n,allowedCountries:s,display:{name:"split"},fields:{phone:"always"},validation:{phone:{required:"always"}},defaultValues:{address:{line1:t.address1,line2:t.address2,city:t.city,state:t.province,postal_code:t.postalCode,country:((u=t.countryCode)==null?void 0:u.toUpperCase())||"us"},phone:t.phone,firstName:t.firstName,lastName:t.lastName}},onChange:c})})]}):null},ft=({title:e,address:t,countryOptions:n})=>{var s;return r.jsxs("span",{children:[e&&r.jsx("dt",{className:"mt-6 text-sm font-bold text-gray-700",children:e}),r.jsxs("dd",{className:"mt-0.5",children:[(t==null?void 0:t.company)&&r.jsxs(r.Fragment,{children:[t==null?void 0:t.company,r.jsx("br",{})]}),t==null?void 0:t.address1,r.jsx("br",{}),(t==null?void 0:t.address2)&&r.jsxs(r.Fragment,{children:[t==null?void 0:t.address2,r.jsx("br",{})]}),t==null?void 0:t.city,", ",t==null?void 0:t.province," ",t==null?void 0:t.postalCode,r.jsx("br",{}),(t==null?void 0:t.countryCode)&&r.jsxs(r.Fragment,{children:[(s=n.find(({value:i})=>i===(t==null?void 0:t.countryCode)))==null?void 0:s.label,r.jsx("br",{})]})]})]})},Kn=(e,t)=>{var s,i,o;return e.shipping_address?e.shipping_address:!t||!((s=t==null?void 0:t.addresses)!=null&&s.length)?null:(t!=null&&t.default_shipping_address_id?(i=t.addresses)==null?void 0:i.find(a=>a.id===(t==null?void 0:t.default_shipping_address_id)):(o=t==null?void 0:t.addresses)==null?void 0:o[0])||null},Yn="new",Jn=()=>{var k,T,D;const e=ee({key:pe.cart.accountDetails}),{customer:t}=we(),{regions:n}=$t(),{step:s,setStep:i,goToNextStep:o,cart:a,isCartMutating:l}=q(),c=s===K.ACCOUNT_DETAILS;if(!a)return null;const d=(n??[]).flatMap(C=>C.countries.map(O=>O.iso_2)),u=Kn(a,t),p=Ae(a),h=["submitting","loading"].includes(e.state),b=!!((k=e.data)!=null&&k.errors),y=(u==null?void 0:u.id)??Yn,v=((D=(T=a.region)==null?void 0:T.countries)==null?void 0:D.map(C=>({value:C.iso_2,label:C.display_name})))??[],x={cartId:a.id,email:(t==null?void 0:t.email)||a.email||"",customerId:t==null?void 0:t.id,allowSuggestions:!0,shippingAddress:{...Ee(u)},shippingAddressId:y},f=ie({resolver:oe(Zt),defaultValues:x,fetcher:e,submitConfig:{method:"post",action:"/api/checkout/account-details"}}),A=C=>{f.setValue("shippingAddress.address1",C.address.address1??""),f.setValue("shippingAddress.address2",C.address.address2??""),f.setValue("shippingAddress.city",C.address.city??""),f.setValue("shippingAddress.province",C.address.province??""),f.setValue("shippingAddress.countryCode",C.address.countryCode??""),f.setValue("shippingAddress.postalCode",C.address.postalCode??""),f.setValue("shippingAddress.phone",C.address.phone??""),f.setValue("shippingAddress.firstName",C.address.firstName??""),f.setValue("shippingAddress.lastName",C.address.lastName??""),f.setValue("shippingAddress.company",C.address.company??""),f.setValue("shippingAddress.phone",C.address.phone??"")},_=f.watch("shippingAddress");m.useEffect(()=>{c&&!h&&!b&&p&&(f.reset(),o())},[h,p]);const w=()=>{o()},g=p&&!c;return r.jsxs("div",{className:"checkout-account-details",children:[r.jsx(Xe,{completed:g,setStep:i,step:K.ACCOUNT_DETAILS,children:"Account details"}),!c&&p&&r.jsx(ft,{title:"Shipping Address",address:_,countryOptions:v}),c&&r.jsxs(r.Fragment,{children:[t!=null&&t.email?r.jsx("p",{className:"mt-2 text-sm mb-2",children:"To get started, please select your shipping address."}):r.jsx("p",{className:"mt-2 text-sm mb-4",children:"To get started, enter your email address."}),r.jsx(ae,{...f,children:r.jsxs(e.Form,{id:"checkout-account-details-form",onSubmit:f.handleSubmit,children:[r.jsx(z,{type:"hidden",name:"cartId"}),r.jsx(z,{type:"hidden",name:"customerId"}),r.jsx(be,{name:"email",type:"email",autoComplete:"email",placeholder:"Email address",label:"Email Address",className:"[&_input]:!ring-0 mb-2"}),r.jsx(Ze,{address:_,prefix:"shippingAddress"}),r.jsx(be,{type:"hidden",name:"shippingAddressId",value:y}),r.jsx(mt,{mode:"shipping",address:_,allowedCountries:d,setAddress:A}),r.jsx(Ce,{}),r.jsxs(Ot,{children:[r.jsx(Ne,{disabled:h||l,children:h?"Saving...":"Save and continue"}),p&&r.jsx(Q,{disabled:h,onClick:w,children:"Cancel edit"})]})]})})]})]})},zn="/assets/StripeBadge-D70kF_jj.png",Qn=({className:e})=>r.jsx("img",{className:e,width:320,src:zn,alt:"stripe security badge"});Dt({page:Oe.number().int().min(0).default(0),pageSize:Oe.number().int().min(1).default(10),sortField:Te().optional(),sortOrder:Ft(["asc","desc"]).default("asc"),dataTableSearch:Te().optional()}).passthrough();const Hn=({shippingOption:e,region:t,value:n})=>{const s=n===e.id;return r.jsx("div",{className:"relative col-span-1",children:r.jsx("label",{htmlFor:e.id,className:"",children:r.jsxs("div",{className:U("group relative flex h-full flex-col justify-between rounded-lg border bg-white p-4 shadow-sm","active:ring-primary-500 hover:border-gray-400 focus:outline-none active:ring-2",s?"border-transparent":"border-gray-300"),children:[r.jsxs("div",{className:"flex justify-between gap-1",children:[r.jsx("div",{className:"block text-sm font-bold text-gray-900",children:e.name}),r.jsx(Lt,{id:e.id,value:e.id,className:"text-primary-600 h-5 w-5 border-0",indicator:r.jsx(Bt,{className:"text-primary-600 h-5 w-5","aria-hidden":"true"})})]}),r.jsx("div",{className:"mt-6 flex items-end justify-between text-sm text-gray-500",children:r.jsx("div",{children:me(e.amount,{currency:t.currency_code})})}),r.jsx("div",{className:U("pointer-events-none absolute -inset-px rounded-lg border-2 active:border",s?"border-primary-500":"border-transparent"),"aria-hidden":"true"})]})})})},Xn=({name:e,shippingOptions:t,region:n,value:s,onValueChange:i,disabled:o})=>{const a=ze(),l=a.formState.isSubmitting,c=async d=>{if(!l){i==null||i(d);try{await a.handleSubmit()}catch(u){console.error("Failed to submit shipping option:",u)}}};return t.length?r.jsx(Mt,{name:e,value:s??"",onValueChange:c,className:U("xs:grid-cols-2 my-6 grid grid-cols-1 gap-4",l&&"pointer-events-none"),disabled:l||o,children:t.map(d=>r.jsx(Hn,{shippingOption:d,region:n},d.id))}):r.jsx("div",{children:"No shipping options available"})},Zn=(e,t)=>{var s;const n=((s=e.shipping_methods)==null?void 0:s.map(i=>i.shipping_option_id))??[];return Object.values(t).reduce((i,o)=>{const a=o.find(l=>n.includes(l.id));return i.push(a?a.id:o[0].id),i},[])},er=(e,t)=>({cartId:e.id,shippingOptionIds:Zn(e,t)}),tr=()=>{var f,A,_;const e=ee(),{step:t,shippingOptions:n,setStep:s,goToNextStep:i,cart:o,isCartMutating:a}=q(),l=t===K.PAYMENT,c=["submitting","loading"].includes(e.state);if(!o)return null;const d=!!((f=e.data)!=null&&f.errors),u=Ae(o),p=m.useMemo(()=>_e(n),[n]),h=m.useMemo(()=>sn(o,n),[o,n]),b=m.useMemo(()=>er(o,p),[o,p]),y=ie({resolver:oe(Xt),defaultValues:b,fetcher:e,submitConfig:{method:"post",action:"/api/checkout/shipping-methods"}}),v=y.watch("shippingOptionIds");m.useEffect(()=>{var w;y.setValue("shippingOptionIds",((w=o.shipping_methods)==null?void 0:w.map(g=>g.shipping_option_id))??[])},[o.shipping_methods]),m.useEffect(()=>{l&&!c&&!d&&h&&i()},[c,h]);const x=!l&&u;return r.jsxs("div",{className:"checkout-delivery-method",children:[r.jsx(Xe,{completed:x,setStep:s,step:K.PAYMENT,children:"Delivery & Payment"}),!l&&r.jsxs(r.Fragment,{children:[((A=o.shipping_methods)==null?void 0:A.length)===0&&r.jsx(Qn,{className:"mt-4"}),r.jsx("dl",{children:(_=o.shipping_methods)==null?void 0:_.map((w,g)=>{var O;const{id:k,shipping_option_id:T,amount:D}=w,C=n.find(B=>B.id===T);return r.jsxs(m.Fragment,{children:[r.jsx("dt",{className:`${g>0?"mt-6":"mt-4"} text-sm font-bold text-gray-700`,children:"Delivery method for: All items"}),r.jsxs("dd",{className:"mt-0.5",children:[C==null?void 0:C.name," (",me(D,{currency:(O=o==null?void 0:o.region)==null?void 0:O.currency_code}),")"]})]},k)})})]}),l&&r.jsx(ae,{...y,children:r.jsxs(e.Form,{children:[r.jsx(z,{type:"hidden",name:"cartId",value:o.id}),Object.entries(p).map(([w,g],k)=>{var T;return g.length<1?null:r.jsxs(m.Fragment,{children:[k>0&&r.jsx("hr",{className:"my-6"}),!!((T=o==null?void 0:o.shipping_methods)!=null&&T.length)&&r.jsx(de,{type:"info",className:"my-6",children:"Choose your delivery option"}),r.jsx(Xn,{disabled:a,name:`shippingOptionIds.${k}`,shippingOptions:g,region:o.region,value:(v==null?void 0:v[k])??null,onValueChange:D=>y.setValue(`shippingOptionIds.${k}`,D)})]},w)})]})})]})},nr=({formId:e,item:t,className:n,maxInventory:s=10,...i})=>{const o=ee({key:pe.cart.updateLineItem}),a=["submitting","loading"].includes(o.state),l=ie({resolver:oe(en),defaultValues:{lineItemId:t.id,quantity:t.quantity.toString()},fetcher:o,submitConfig:{method:"post",action:"/api/cart/line-items/update"}}),c=d=>{o.submit({lineItemId:t.id,quantity:d},{method:"post",action:"/api/cart/line-items/update"})};return r.jsx(ae,{...l,children:r.jsx(o.Form,{id:e,className:U("line-item-quantity-select",n),...i,onSubmit:l.handleSubmit,children:r.jsx(zt,{formId:e,className:U({"pointer-events-none opacity-50":a}),variant:t.variant,onChange:c})})})},rr=({item:e,name:t})=>{var a,l,c;const{cart:n}=q(),s=Wt(),i=()=>s.submit(e),o=["loading","submitting"].includes(s.state);return n?r.jsxs("li",{className:"flex px-4 py-6 sm:px-6",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Qt,{src:((l=(a=e.variant)==null?void 0:a.product)==null?void 0:l.thumbnail)||"",alt:e.product_title||"product thumbnail",className:"w-20 rounded-md"})}),r.jsxs("div",{className:"ml-6 flex flex-1 flex-col",children:[r.jsxs("div",{className:"flex",children:[r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsx("h4",{className:"text-base",children:r.jsx(Ye,{to:`/products/${e.product_handle}`,className:"font-bold text-gray-700 hover:text-gray-800",children:e.product_title})}),r.jsx("p",{className:"mt-0.5 text-sm text-gray-500",children:e.variant_title})]}),r.jsx("div",{className:"ml-4 flow-root flex-shrink-0",children:r.jsx(Q,{variant:"link",onClick:i,disabled:o,className:"text-sm",children:o?"Removing":"Remove"})})]}),r.jsxs("div",{className:"flex flex-1 items-end justify-between pt-2",children:[r.jsx("div",{className:"mr-4",children:r.jsx(nr,{formId:`quantity-${t}-${e.id}`,item:e})}),r.jsx("p",{className:"mt-1 text-lg",children:r.jsx("span",{className:"font-bold text-gray-900",children:me(e.unit_price,{currency:(c=n.region)==null?void 0:c.currency_code})})})]})]})]}):null},sr=({cart:e,name:t})=>{var n;return r.jsx("ul",{role:"list",className:"divide-y divide-gray-200",children:(n=e.items)==null?void 0:n.map(s=>r.jsx(rr,{item:s,name:t},s.id))})},or=({cart:e,promotion:t})=>{const n=ee({key:pe.cart.removePromotionCode});return["submitting","loading"].includes(n.state)?null:r.jsxs(n.Form,{method:"post",action:"/api/checkout/remove-discount-code",children:[r.jsx("input",{type:"hidden",name:"cartId",value:e.id}),r.jsx("input",{type:"hidden",name:"code",value:t.code}),r.jsxs("button",{className:"focus:ring-primary-100 focus:border-primary-100 inline-flex h-8 items-center rounded-md border border-gray-300 bg-white px-2 text-xs font-bold text-gray-900 shadow-sm hover:bg-gray-100",children:[r.jsx("span",{children:t.code}),r.jsx("div",{className:"ml-[4px] inline-block text-gray-400",children:r.jsx(Gt,{className:"inline-block h-4 w-4 leading-none"})})]})]})},ir=({cart:e})=>{var p,h,b;const t=m.useRef(null),n=m.useRef(null),s=ee(),[i,o]=m.useState(!!e.promotions.length),a=!!((p=e.promotions)!=null&&p.length),l=Object.keys(((h=s.data)==null?void 0:h.errors)||{}).length>0,c=["submitting","loading"].includes(s.state),d=ie({resolver:oe(tn),defaultValues:{cartId:e.id,code:""},fetcher:s,submitConfig:{method:"post",action:"/api/checkout/discount-code"}});m.useEffect(()=>{var y;!c&&!l&&(d.reset(),(y=n.current)==null||y.focus())},[c,l]);const u=()=>{o(!0),setTimeout(()=>{var y;return(y=n.current)==null?void 0:y.focus()},0)};return r.jsxs("div",{className:"mb-6",children:[!i&&r.jsx("div",{children:r.jsx(Ht,{size:"sm",onClick:u,children:"Add promo code"})}),i&&r.jsxs(r.Fragment,{children:[r.jsx(ae,{...d,children:r.jsxs(s.Form,{ref:t,onSubmit:d.handleSubmit,children:[r.jsx("input",{type:"hidden",name:"cartId",value:e.id}),r.jsxs("div",{className:"!my-0 !flex items-start gap-1",children:[r.jsx(be,{name:"code",className:"flex-grow",placeholder:"Discount code","aria-label":"discount code"}),r.jsx(Ne,{type:"submit",className:"flex-shrink-0 flex-grow-0",disabled:c,children:c?"Applying...":"Apply"})]}),r.jsx(Ce,{})]})}),a&&r.jsx("div",{className:"mt-2",children:(b=e.promotions)==null?void 0:b.map(y=>r.jsx(or,{cart:e,promotion:y},y.id))})]})]})},X=({label:e,amount:t,className:n,region:s})=>r.jsxs("div",{className:U("flex items-center justify-between text-sm",n),children:[r.jsx("dt",{children:e}),r.jsx("dd",{className:"font-bold text-gray-900",children:me(t||0,{currency:s==null?void 0:s.currency_code})})]}),ar=({shippingOptions:e,cart:t})=>{const s=(t.shipping_methods||[]).length>0,i=on(e),o=t.discount_total??0,a=t.shipping_total??0,l=t.total??0,c=s?l:l+i;return r.jsxs("div",{className:"border-t border-gray-200 px-4 py-6 sm:px-6",children:[r.jsx(ir,{cart:t}),r.jsxs("dl",{className:"flex flex-col gap-2",children:[r.jsx(X,{label:"Subtotal",amount:t.item_subtotal,region:t.region}),o>0&&r.jsx(X,{label:"Discount",amount:-o,region:t.region}),s&&r.jsx(X,{label:"Shipping",amount:a,region:t.region}),!s&&r.jsx(X,{label:"Estimated Shipping",amount:i,region:t.region}),r.jsx(X,{label:"Taxes",amount:t.tax_total,region:t.region}),r.jsx(X,{label:"Total",amount:c,className:"border-t border-gray-200 pt-6 !text-xl",region:t.region})]})]})},ht=({submitButton:e,name:t})=>{const{shippingOptions:n,cart:s}=q();return s?r.jsxs("div",{className:"my-0 rounded-lg border border-gray-200 bg-white shadow-sm",children:[r.jsx("h3",{className:"sr-only",children:"Items in your cart"}),r.jsx(sr,{cart:s,name:t}),r.jsx(ar,{cart:s,shippingOptions:n}),e&&r.jsx("div",{className:"border-t border-gray-200 p-4 sm:p-6",children:e})]}):null},yt=({id:e,submitMessage:t,onSubmit:n,paymentMethods:s,children:i,providerId:o,className:a})=>{var B,$;const{activePaymentSession:l,cart:c,isCartMutating:d}=q(),u=ee({key:pe.cart.completeCheckout}),[p,h]=m.useState(!1),b=["submitting","loading"].includes(u.state)||p,y=s.filter(N=>N.provider_id===o),v=y.length>0,x=v?y[0].data.id:"new";if(!c)return null;const f=Ee(c.billing_address),A=Gn(c==null?void 0:c.shipping_address)??xe,_=(($=(B=c.region)==null?void 0:B.countries)==null?void 0:$.map(N=>({value:N.iso_2,label:N.display_name})))??[],w={cartId:c.id,paymentMethodId:x,sameAsShipping:!0,billingAddress:f,providerId:o},g=ie({resolver:oe(cn),defaultValues:w,fetcher:u,submitConfig:{method:"post",action:"/api/checkout/complete"}}),k=g.watch("sameAsShipping"),T=g.watch("billingAddress"),D=async N=>{N.preventDefault(),h(!0);const Y=g.getValues();return typeof n=="function"?await n(Y,N,{setSubmitting:h,submit:()=>g.handleSubmit()}):g.handleSubmit()},C=N=>{g.setValue("billingAddress.address1",N.address.address1??""),g.setValue("billingAddress.address2",N.address.address2??""),g.setValue("billingAddress.city",N.address.city??""),g.setValue("billingAddress.province",N.address.province??""),g.setValue("billingAddress.countryCode",N.address.countryCode??""),g.setValue("billingAddress.postalCode",N.address.postalCode??""),g.setValue("billingAddress.phone",N.address.phone??""),g.setValue("billingAddress.firstName",N.address.firstName??""),g.setValue("billingAddress.lastName",N.address.lastName??""),g.setValue("billingAddress.company",N.address.company??""),g.setValue("billingAddress.phone",N.address.phone??"")},O=()=>r.jsx(Ne,{form:e,className:"w-full lg:w-auto",disabled:b||d||!k&&!T,children:b?"Confirming...":t??"Confirm & Pay"});return l?r.jsx(r.Fragment,{children:r.jsxs(ae,{...g,children:[r.jsxs(u.Form,{id:e,onSubmit:D,className:a,children:[r.jsx(z,{type:"hidden",name:"cartId",value:c.id}),r.jsx(z,{type:"hidden",name:"providerId",value:o}),r.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Billing address"}),r.jsx(nn,{className:"my-4",name:"sameAsShipping",label:"Same as shipping address"}),!k&&r.jsx(mt,{mode:"billing",address:T,setAddress:C}),r.jsx(Ze,{address:T,prefix:"billingAddress"}),k&&r.jsx("div",{className:"-mt-2 mb-4",children:r.jsx(ft,{address:A.address,countryOptions:_})}),!v&&r.jsx("input",{type:"hidden",name:"paymentMethodId",value:"new"}),r.jsx("div",{className:`stripe-payment-form ${x!=="new"?"hidden":""}`,children:i}),r.jsx(Ce,{})]}),r.jsx("div",{className:"block lg:hidden",children:r.jsx(ht,{name:"checkout",submitButton:r.jsx(O,{})})}),r.jsx("div",{className:"hidden lg:block",children:r.jsx(O,{})})]})}):null},cr=e=>r.jsx(yt,{providerId:"pp_system_default",id:"TestPaymentForm",submitMessage:"Checkout using Test Payment",className:"mt-4",...e}),lr=({options:e,children:t})=>{var l,c;const{env:n}=Pe(),{cart:s}=q(),i=m.useMemo(()=>n.STRIPE_PUBLIC_KEY?pt(n.STRIPE_PUBLIC_KEY):null,[]),o=m.useMemo(()=>{var d,u;return(u=(d=s==null?void 0:s.payment_collection)==null?void 0:d.payment_sessions)==null?void 0:u.find(p=>p.provider_id==="pp_stripe_stripe")},[(l=s==null?void 0:s.payment_collection)==null?void 0:l.payment_sessions]),a=(c=o==null?void 0:o.data)==null?void 0:c.client_secret;return!o||!i||!a?null:r.jsx(ke,{stripe:i,options:e??{clientSecret:a},children:t},a)},ur=({isActiveStep:e,paymentMethods:t})=>{var v,x;const[n,s]=m.useState(),[i,o]=m.useState(),a=Dn(),l=kn(),{activePaymentSession:c,cart:d}=q(),u=m.useMemo(()=>t==null?void 0:t.filter(f=>f.provider_id==="pp_stripe_stripe"),[t]);m.useEffect(()=>{l&&l.fetchUpdates()},[(v=c==null?void 0:c.payment)==null?void 0:v.updated_at]);const p=u.length>0,h=p?(x=u[0].data)==null?void 0:x.id:"new";if(m.useEffect(()=>{e&&n&&n.focus()},[e,n]),!d||!a||!l)return null;const b=async(f,A,{setSubmitting:_,submit:w})=>{if(o(void 0),f.paymentMethodId!=="new"){w(A.target);return}const g=f.sameAsShipping?Ee(d.billing_address):f.billingAddress,k={name:`${g.firstName} ${g.lastName}`,email:d.email,phone:g.phone||"",address:{line1:g.address1||"",line2:g.address2||"",city:g.city||"",state:g.province||"",postal_code:g.postalCode||"",country:g.countryCode||""}};return _(!0),a.confirmPayment({elements:l,confirmParams:{return_url:`${window.location.origin}/checkout/success`,payment_method_data:{billing_details:k}},redirect:"if_required"}).then(({paymentIntent:T,error:D})=>{if(D){o(D.message),_(!1),n==null||n.focus();return}w(A.target)}).catch(T=>{_(!1),console.error(T)})},y=f=>{s(f)};return r.jsx(r.Fragment,{children:r.jsx(yt,{providerId:"pp_stripe_stripe",id:"stripePaymentForm",paymentMethods:u,onSubmit:b,children:r.jsxs("div",{className:U({"h-0 overflow-hidden opacity-0":p&&h!=="new"}),children:[r.jsx(Fn,{onReady:y,className:"my-6 w-full",options:{fields:{billingDetails:{address:{country:"never",postalCode:"never"}}},terms:{card:"never"}}}),i&&r.jsx(de,{type:"error",className:U("form__error -mt-4 mb-2"),children:i})]})})})},dr=e=>{const{isActiveStep:t,...n}=e;return r.jsx(lr,{children:r.jsx(ur,{...n,isActiveStep:t})})},pr=({isActiveStep:e,paymentMethods:t})=>{var v;const{cart:n,selectPaymentMethod:s,completeCheckout:i}=q(),[o,a]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{if(n!=null&&n.payment_sessions){const x=n.payment_sessions.find(f=>f.provider_id==="pp_bank_transfer");if(x&&x.data){const f=x.data;a({bankName:f.bankName,accountHolder:f.accountHolder,accountNumber:f.accountNumber,bankCode:f.bankCode,swiftCode:f.swiftCode,qrCodeUrl:f.qrCodeUrl})}}},[n==null?void 0:n.payment_sessions]);const b=async()=>{try{c(!0),u(null),await s("pp_bank_transfer"),c(!1)}catch(x){u(x.message||"Failed to select bank transfer payment"),c(!1)}},y=async()=>{try{c(!0),u(null),await i(),c(!1)}catch(x){u(x.message||"Failed to complete order"),c(!1)}};return r.jsxs("div",{className:"bank-transfer-payment space-y-4",children:[d&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:d}),o?r.jsxs("div",{className:"space-y-6 bg-gray-50 p-6 rounded-lg",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Bank Transfer Details"}),r.jsxs("div",{className:"space-y-3 bg-white p-4 rounded border border-gray-200",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600 font-medium",children:"Bank:"}),r.jsx("span",{className:"text-gray-800",children:o.bankName})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600 font-medium",children:"Account Holder:"}),r.jsx("span",{className:"text-gray-800",children:o.accountHolder})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600 font-medium",children:"Account Number:"}),r.jsx("span",{className:"text-gray-800 font-mono",children:o.accountNumber})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600 font-medium",children:"Bank Code:"}),r.jsx("span",{className:"text-gray-800 font-mono",children:o.bankCode})]}),o.swiftCode&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600 font-medium",children:"SWIFT Code:"}),r.jsx("span",{className:"text-gray-800 font-mono",children:o.swiftCode})]}),r.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[r.jsx("span",{className:"text-gray-600 font-medium",children:"Amount to Pay:"}),r.jsx("span",{className:"text-lg font-bold text-green-600",children:(v=n==null?void 0:n.totals)==null?void 0:v.formatted_total})]})]})]}),o.qrCodeUrl&&r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Payment QR Code"}),r.jsx("button",{type:"button",onClick:()=>h(!p),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:p?"Hide":"Show"})]})}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded space-y-2",children:[r.jsx("h4",{className:"font-semibold text-blue-900",children:"Payment Instructions:"}),r.jsxs("ol",{className:"list-decimal list-inside text-sm text-blue-800 space-y-1",children:[r.jsx("li",{children:"Log into your bank account"}),r.jsx("li",{children:"Create a transfer to the account details shown above"}),r.jsx("li",{children:"Use your Order ID as the reference/memo"}),r.jsx("li",{children:"Transfer the exact amount shown"}),r.jsx("li",{children:"The admin will verify your payment and update your order status"})]})]}),r.jsx(Q,{isLoading:l,onClick:y,className:"w-full bg-green-600 hover:bg-green-700",children:"Complete Order"}),r.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Your order will be marked as pending payment until verified by admin."})]}):r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-gray-600",children:"Select Bank Transfer to pay via bank wire. You'll receive payment instructions after placing the order."}),r.jsx(Q,{isLoading:l,onClick:b,className:"w-full bg-blue-600 hover:bg-blue-700",children:"Select Bank Transfer"})]})]})},mr=()=>{const{env:e}=Pe(),{step:t,paymentProviders:n,cart:s}=q(),i=t===K.PAYMENT;if(!s)return null;const o=m.useMemo(()=>n==null?void 0:n.some(u=>u.id.includes("pp_stripe_stripe")),[n]),a=m.useMemo(()=>!!(n!=null&&n.some(u=>u.id.includes("pp_system_default"))),[n]),l=m.useMemo(()=>!!(n!=null&&n.some(u=>u.id.includes("pp_bank_transfer"))),[n]),c=[{id:"pp_stripe_stripe",label:"Credit Card",component:dr,isActive:o},{id:"pp_bank_transfer",label:"Bank Transfer",component:pr,isActive:l},{id:"pp_system_default",label:"Test Payment",component:cr,isActive:a&&e.NODE_ENV==="development"}],d=m.useMemo(()=>c.filter(u=>u.isActive),[c]);return r.jsx("div",{className:"checkout-payment",children:r.jsx("div",{className:U({"h-0 overflow-hidden opacity-0":!i}),children:r.jsxs(te.Group,{children:[d.length>1&&r.jsx(te.List,{className:"bg-primary-50 mb-2 mt-6 inline-flex gap-0.5 rounded-full p-2",children:d.map((u,p)=>r.jsx(te,{as:Q,className:({selected:h})=>U("!rounded-full",{"!bg-white !text-gray-700 shadow-sm":h,"!bg-primary-50 !border-primary-100 !text-primary-600 hover:!text-primary-800 hover:!bg-primary-100 !border-none":!h}),children:u.label},u.id))}),r.jsx(te.Panels,{children:d.map(u=>{const p=u.component;return r.jsx(te.Panel,{children:r.jsx(p,{isActiveStep:i,paymentMethods:[]})},u.id)})})]})})})},Ve={update:async e=>{const t=await fetch("/api/checkout/express",{method:"POST",body:ve(e)});return t.ok?[await t.json(),null]:[null,new Error("Failed to update shipping address")]}};/*!
 * react-paypal-js v8.9.2 (2025-10-02T20:17:55.069Z)
 * Copyright 2020-present, PayPal, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var L;(function(e){e.INITIAL="initial",e.PENDING="pending",e.REJECTED="rejected",e.RESOLVED="resolved"})(L||(L={}));var G;(function(e){e.LOADING_STATUS="setLoadingStatus",e.RESET_OPTIONS="resetOptions",e.SET_BRAINTREE_INSTANCE="braintreeInstance"})(G||(G={}));var $e;(function(e){e.NUMBER="number",e.CVV="cvv",e.EXPIRATION_DATE="expirationDate",e.EXPIRATION_MONTH="expirationMonth",e.EXPIRATION_YEAR="expirationYear",e.POSTAL_CODE="postalCode"})($e||($e={}));var P=function(){return P=Object.assign||function(t){for(var n,s=1,i=arguments.length;s<i;s++){n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},P.apply(this,arguments)};function gt(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]]);return n}function We(e,t,n){if(n||arguments.length===2)for(var s=0,i=t.length,o;s<i;s++)(o||!(s in t))&&(o||(o=Array.prototype.slice.call(t,0,s)),o[s]=t[s]);return e.concat(o||Array.prototype.slice.call(t))}var se="data-react-paypal-script-id",J={DATA_JS_SDK_LIBRARY:"dataJsSdkLibrary",DATA_LIBRARY_VALUE:"react-paypal-js",DATA_NAMESPACE:"dataNamespace",DATA_SDK_INTEGRATION_SOURCE:"dataSdkIntegrationSource"},fr="Failed to load the PayPal JS SDK script.",vt="paypal",hr="usePayPalScriptReducer must be used within a PayPalScriptProvider";function yr(e){return e===void 0&&(e=vt),window[e]}function gr(e){for(var t="",n=0;n<e.length;n++){var s=e[n].charCodeAt(0)*n;e[n+1]&&(s+=e[n+1].charCodeAt(0)*(n-1)),t+=String.fromCharCode(97+Math.abs(s)%26)}return t}function vr(e){var t=e.reactComponentName,n=e.sdkComponentKey,s=e.sdkRequestedComponents,i=s===void 0?"":s,o=e.sdkDataNamespace,a=o===void 0?vt:o,l=n.charAt(0).toUpperCase().concat(n.substring(1)),c="Unable to render <".concat(t," /> because window.").concat(a,".").concat(l," is undefined."),d=typeof i=="string"?i:i.join(",");if(!d.includes(n)){var u=[d,n].filter(Boolean).join();c+=`
To fix the issue, add '`.concat(n,"' to the list of components passed to the parent PayPalScriptProvider:")+"\n`<PayPalScriptProvider options={{ components: '".concat(u,"'}}>`.")}return c}function xt(e){var t=e,n=se;t[n];var s=gt(t,[n+""]);return"react-paypal-js-".concat(gr(JSON.stringify(s)))}function xr(e){var t=self.document.querySelector("script[".concat(se,'="').concat(e,'"]'));t!=null&&t.parentNode&&t.parentNode.removeChild(t)}function br(e,t){var n,s;switch(t.type){case G.LOADING_STATUS:return typeof t.value=="object"?P(P({},e),{loadingStatus:t.value.state,loadingStatusErrorMessage:t.value.message}):P(P({},e),{loadingStatus:t.value});case G.RESET_OPTIONS:return xr(e.options[se]),P(P({},e),{loadingStatus:L.PENDING,options:P(P((n={},n[J.DATA_SDK_INTEGRATION_SOURCE]=J.DATA_LIBRARY_VALUE,n),t.value),(s={},s[se]="".concat(xt(t.value)),s))});case G.SET_BRAINTREE_INSTANCE:return P(P({},e),{braintreePayPalCheckoutInstance:t.value});default:return e}}var bt=m.createContext(null);function jr(e){if(typeof(e==null?void 0:e.dispatch)=="function"&&e.dispatch.length!==0)return e;throw new Error(hr)}function Sr(){var e=jr(m.useContext(bt)),t=P(P({},e),{isInitial:e.loadingStatus===L.INITIAL,isPending:e.loadingStatus===L.PENDING,isResolved:e.loadingStatus===L.RESOLVED,isRejected:e.loadingStatus===L.REJECTED});return[t,e.dispatch]}m.createContext({});function Cr(e){var t=m.useRef(new Proxy({},{get:function(n,s,i){return typeof n[s]=="function"?function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return n[s].apply(n,o)}:Reflect.get(n,s,i)}}));return t.current=Object.assign(t.current,e),t.current}var Ie=function(e){var t,n=e.className,s=n===void 0?"":n,i=e.disabled,o=i===void 0?!1:i,a=e.children,l=e.forceReRender,c=l===void 0?[]:l,d=gt(e,["className","disabled","children","forceReRender"]),u=o?{opacity:.38}:{},p="".concat(s," ").concat(o?"paypal-buttons-disabled":"").trim(),h=m.useRef(null),b=m.useRef(null),y=Cr(d),v=Sr()[0],x=v.isResolved,f=v.options,A=m.useState(null),_=A[0],w=A[1],g=m.useState(!0),k=g[0],T=g[1],D=m.useState(null),C=D[1];function O(){b.current!==null&&b.current.close().catch(function(){})}return!((t=b.current)===null||t===void 0)&&t.updateProps&&b.current.updateProps({message:d.message}),m.useEffect(function(){if(x===!1)return O;var B=yr(f.dataNamespace);if(B===void 0||B.Buttons===void 0)return C(function(){throw new Error(vr({reactComponentName:Ie.displayName,sdkComponentKey:"buttons",sdkRequestedComponents:f.components,sdkDataNamespace:f[J.DATA_NAMESPACE]}))}),O;var $=function(N,Y){w(Y),typeof d.onInit=="function"&&d.onInit(N,Y)};try{b.current=B.Buttons(P(P({},y),{onInit:$}))}catch(N){return C(function(){throw new Error("Failed to render <PayPalButtons /> component. Failed to initialize:  ".concat(N))})}return b.current.isEligible()===!1?(T(!1),O):(h.current&&b.current.render(h.current).catch(function(N){h.current===null||h.current.children.length===0||C(function(){throw new Error("Failed to render <PayPalButtons /> component. ".concat(N))})}),O)},We(We([x],c,!0),[d.fundingSource],!1)),m.useEffect(function(){_!==null&&(o===!0?_.disable().catch(function(){}):_.enable().catch(function(){}))},[o,_]),S.createElement(S.Fragment,null,k?S.createElement("div",{ref:h,style:u,className:p}):a)};Ie.displayName="PayPalButtons";function Nr(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]]);return n}function Er(e,t){var n=document.querySelector('script[src="'.concat(e,'"]'));if(n===null)return null;var s=jt(e,t),i=n.cloneNode();if(delete i.dataset.uidAuto,Object.keys(i.dataset).length!==Object.keys(s.dataset).length)return null;var o=!0;return Object.keys(i.dataset).forEach(function(a){i.dataset[a]!==s.dataset[a]&&(o=!1)}),o?n:null}function _r(e){var t=e.url,n=e.attributes,s=e.onSuccess,i=e.onError,o=jt(t,n);o.onerror=i,o.onload=s,document.head.insertBefore(o,document.head.firstElementChild)}function Ar(e){var t=e.sdkBaseUrl,n=e.environment,s=Nr(e,["sdkBaseUrl","environment"]),i=t||kr(n),o=s,a=Object.keys(o).filter(function(d){return typeof o[d]<"u"&&o[d]!==null&&o[d]!==""}).reduce(function(d,u){var p=o[u].toString();return u=wr(u),u.substring(0,4)==="data"||u==="crossorigin"?d.attributes[u]=p:d.queryParams[u]=p,d},{queryParams:{},attributes:{}}),l=a.queryParams,c=a.attributes;return l["merchant-id"]&&l["merchant-id"].indexOf(",")!==-1&&(c["data-merchant-id"]=l["merchant-id"],l["merchant-id"]="*"),{url:"".concat(i,"?").concat(Pr(l)),attributes:c}}function wr(e){var t=function(n,s){return(s?"-":"")+n.toLowerCase()};return e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,t)}function Pr(e){var t="";return Object.keys(e).forEach(function(n){t.length!==0&&(t+="&"),t+=n+"="+e[n]}),t}function kr(e){return e==="sandbox"?"https://www.sandbox.paypal.com/sdk/js":"https://www.paypal.com/sdk/js"}function jt(e,t){t===void 0&&(t={});var n=document.createElement("script");return n.src=e,Object.keys(t).forEach(function(s){n.setAttribute(s,t[s]),s==="data-csp-nonce"&&n.setAttribute("nonce",t["data-csp-nonce"])}),n}function Ir(e,t){if(t===void 0&&(t=Promise),St(e,t),typeof document>"u")return t.resolve(null);var n=Ar(e),s=n.url,i=n.attributes,o=i["data-namespace"]||"paypal",a=Ge(o);return i["data-js-sdk-library"]||(i["data-js-sdk-library"]="paypal-js"),Er(s,i)&&a?t.resolve(a):Rr({url:s,attributes:i},t).then(function(){var l=Ge(o);if(l)return l;throw new Error("The window.".concat(o," global variable is not available."))})}function Rr(e,t){t===void 0&&(t=Promise),St(e,t);var n=e.url,s=e.attributes;if(typeof n!="string"||n.length===0)throw new Error("Invalid url.");if(typeof s<"u"&&typeof s!="object")throw new Error("Expected attributes to be an object.");return new t(function(i,o){if(typeof document>"u")return i();_r({url:n,attributes:s,onSuccess:function(){return i()},onError:function(){var a=new Error('The script "'.concat(n,'" failed to load. Check the HTTP status code and response body in DevTools to learn more.'));return o(a)}})})}function Ge(e){return window[e]}function St(e,t){if(typeof e!="object"||e===null)throw new Error("Expected an options object.");var n=e.environment;if(n&&n!=="production"&&n!=="sandbox")throw new Error('The `environment` option must be either "production" or "sandbox".');if(typeof t<"u"&&typeof t!="function")throw new Error("Expected PromisePonyfill to be a function.")}var Tr=function(e){var t,n=e.options,s=n===void 0?{clientId:"test"}:n,i=e.children,o=e.deferLoading,a=o===void 0?!1:o,l=m.useReducer(br,{options:P(P({},s),(t={},t[J.DATA_JS_SDK_LIBRARY]=J.DATA_LIBRARY_VALUE,t[J.DATA_SDK_INTEGRATION_SOURCE]=J.DATA_LIBRARY_VALUE,t[se]="".concat(xt(s)),t)),loadingStatus:a?L.INITIAL:L.PENDING}),c=l[0],d=l[1];return m.useEffect(function(){if(a===!1&&c.loadingStatus===L.INITIAL)return d({type:G.LOADING_STATUS,value:L.PENDING});if(c.loadingStatus===L.PENDING){var u=!0;return Ir(c.options).then(function(){u&&d({type:G.LOADING_STATUS,value:L.RESOLVED})}).catch(function(p){console.error("".concat(fr," ").concat(p)),u&&d({type:G.LOADING_STATUS,value:{state:L.REJECTED,message:String(p)}})}),function(){u=!1}}},[c.options,a,c.loadingStatus]),S.createElement(bt.Provider,{value:P(P({},c),{dispatch:d})},i)};function Ke(){}m.createContext({cardFieldsForm:null,fields:{},registerField:Ke,unregisterField:Ke});function Or({cart:e}){const t=_t(),{paymentProviders:n,step:s}=q(),[i,o]=m.useState(null),[a,l]=m.useState(e),c=s===K.PAYMENT,d=m.useMemo(()=>n==null?void 0:n.some(y=>{var v;return(v=y.id)==null?void 0:v.includes("paypal")}),[n]),u=m.useMemo(()=>({clientId:"AUvtGlVenK_bQoUrek0Nl43oRCDETrBjP2ZlhRQcdBuJp1Pt16gSaitZV3aXAhUFIIQBGY29PqKhncLq",components:"buttons",intent:"capture",currency:(a.currency_code||"USD").toUpperCase()}),[a.currency_code]);if(m.useEffect(()=>{l(e)},[e]),!a||!d)return null;const p={borderRadius:10},h=async()=>{var A,_,w;const[y,v]=await Ve.update({cartId:a.id,complete:!1});if(v)return o({title:"Error updating account details",description:v.message}),"";const f=(_=(A=y.cart.payment_collection)==null?void 0:A.payment_sessions)==null?void 0:_[0];return((w=f==null?void 0:f.data)==null?void 0:w.id)||""},b=async(y,v)=>{try{if(!(v!=null&&v.order))return;const[x,f]=await Ve.update({cartId:a.id,complete:!0});if(f){o({title:"Payment failed",description:f.message});return}const{order:A}=x;if(!A){o({title:"Payment failed",description:"Error trying to complete checkout."});return}t(`/checkout/success?order_id=${A.id}`)}catch(x){const f=x instanceof Error?x.message:"Error trying to submit payment.";o({title:"Payment failed",description:f})}};return r.jsxs("div",{className:U("App",!c&&"hidden"),children:[i?r.jsx(de,{type:"error",title:i.title,className:"mt-4",children:i.description}):null,r.jsx("div",{className:"py-4 relative z-0",children:r.jsx(Tr,{options:u,children:r.jsx(Ie,{style:p,createOrder:h,onApprove:b,onError:y=>{const v=y instanceof Error?y.message:"PayPal error";o({title:"Payment failed",description:v})}})})})]})}const Dr=()=>{const{customer:e}=we(),{goToNextStep:t,cart:n}=q(),s=!!(e!=null&&e.id);if(n)return m.useEffect(()=>(s&&t(),()=>t()),[s]),r.jsx(r.Fragment,{children:r.jsxs("div",{className:"lg:min-h-[calc(100vh-320px)] lg:pl-8",children:[s&&r.jsxs(de,{type:"info",className:"mb-8",children:["Checking out as:"," ",r.jsxs("strong",{className:"font-bold",children:[e.first_name," ",e.last_name," (",e.email,")"]})]}),r.jsx(Jn,{}),r.jsx("hr",{className:"my-10"}),r.jsx(tr,{}),r.jsx(Or,{cart:n}),r.jsx(mr,{})]})})},Fr=()=>{const{step:e}=q();return r.jsx("div",{className:U("h-full",{"hidden lg:block":e===K.PAYMENT}),children:r.jsx("div",{className:"sticky top-24",children:r.jsx(ht,{name:"sidebar"})})})},Lr=({icon:e,title:t,description:n,action:s})=>r.jsxs("div",{className:"py-16 text-center",children:[e&&r.jsx("div",{className:"inline-block text-gray-300",children:r.jsx(e,{className:"h-10 w-10"})}),r.jsx("h2",{className:"mt-2 text-lg font-bold text-gray-900",children:t}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n}),s&&r.jsx("div",{className:"mt-6",children:s})]}),Zr=At(function(){var o;const{shippingOptions:t,paymentProviders:n,activePaymentSession:s,cart:i}=wt();return!i||!((o=i.items)!=null&&o.length)?r.jsx(Lr,{icon:Kt,title:"No items in your cart.",description:"Add items to your cart",action:r.jsx(Q,{variant:"primary",as:a=>r.jsx(Ye,{to:"/products",...a}),children:"Start shopping"})}):r.jsx(dn,{data:{cart:i,activePaymentSession:s,shippingOptions:t,paymentProviders:n},children:r.jsx("section",{children:r.jsx("div",{className:"mx-auto max-w-2xl px-4 pb-8 pt-6 sm:px-6 sm:pb-16 sm:pt-8 lg:max-w-7xl lg:px-8 lg:pb-24 lg:pt-16",children:r.jsxs("div",{className:"lg:grid lg:grid-cols-[4fr_3fr] lg:gap-x-12 xl:gap-x-16",children:[r.jsx(Dr,{}),r.jsx(Fr,{})]})})})})});export{Zr as default};
