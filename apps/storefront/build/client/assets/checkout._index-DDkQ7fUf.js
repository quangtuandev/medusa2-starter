import{j as s,r as m,f as Ft,g as Lt,R as C,h as re,L as tt,a as Mt,w as Bt,u as Ut}from"./chunk-OIYGIGL5-DCgkdKKb.js";import{b as Vt,h as qt,x as $t,D as Wt,M as Gt,a as Q,F as we,A as Kt,o as Yt,s as Ve,e as Jt,c as qe,f as zt,d as Qt,m as Xt,g as ve}from"./data-table-router-form-C_cEYWO6.js";import{u as nt,c as Zt,b as Ht,a as en,F as ge}from"./useRegion-Bk1_9y5j.js";import{B as ce}from"./Button-E-8QNY68.js";import{c as W}from"./clsx-B-dksMZM.js";import{u as tn,a as nn,F as rn,b as sn}from"./ShoppingCartIcon-CW0mJDUx.js";import{o as X,c as on,s as S,d as je,e as $e,b as le}from"./zod-v2Wtl3bk.js";import{u as rt,a as ue,R as de,S as Pe}from"./SubmitButton-CSe2QbSv.js";import{I as an}from"./Image-Bcn-QzFe.js";import{f as xe}from"./prices-DJiVn0T5.js";import{n as cn,Q as ln}from"./QuantitySelector-CUhvbZM0.js";import{B as un}from"./ButtonLink-BQ1Kovmq.js";import{d as se}from"./tabs-D4HrBTLt.js";import"./createLucideIcon-D6tX4iXv.js";import"./index-ryUWhltf.js";import"./PlusIcon-A66bXQM6.js";import"./use-is-mounted-CDs0S30a.js";const Ce=(e,t=new FormData,n="")=>e==null?t:typeof e=="object"&&!(e instanceof Date)&&!(e instanceof File)?(Object.entries(e).forEach(([r,i])=>{Ce(i,t,n?e[r]instanceof File?n:`${n}.${r}`:r)}),t):Array.isArray(e)?(e.forEach((r,i)=>{Ce(r,t,`${n}.${i}`)}),t):(t.append(n,e),t),dn=X({cartId:S(),shippingOptionIds:on(S())}),pn=X({cartId:S(),customerId:S().optional(),email:S().email("Please enter a valid email"),shippingAddress:X({firstName:S().min(1,"First name is required"),lastName:S().min(1,"Last name is required"),company:S().optional(),address1:S().min(1,"Address is required"),address2:S().optional(),city:S().min(1,"City is required"),province:S().min(1,"Province is required"),countryCode:S().min(1,"Country is required"),postalCode:S().min(1,"Postal code is required"),phone:S().optional()}),shippingAddressId:S(),isExpressCheckout:je().optional()}),mn=X({lineItemId:S().min(1,"Line item ID is required"),quantity:cn().int()}),fn=X({cartId:S(),code:S().min(1,"Discount code is required")});function hn(e){const{control:t}=rt(),{components:n,...r}=e,i={FormDescription:Gt,FormControl:Wt,FormLabel:$t,FormMessage:qt,...n};return s.jsx(Vt,{control:t,components:i,...r})}const Ee={firstName:"",lastName:"",company:"",address1:"",address2:"",city:"",province:"",postalCode:"",countryCode:"",phone:""},Ie=e=>e?{...Ee,firstName:(e==null?void 0:e.first_name)||"",lastName:(e==null?void 0:e.last_name)||"",company:(e==null?void 0:e.company)||"",address1:(e==null?void 0:e.address_1)||"",address2:(e==null?void 0:e.address_2)||"",city:(e==null?void 0:e.city)||"",countryCode:(e==null?void 0:e.country_code)||"",phone:(e==null?void 0:e.phone)||"",postalCode:(e==null?void 0:e.postal_code)||"",province:(e==null?void 0:e.province)||""}:Ee,Re=e=>{const t=e.reduce((n,r)=>{const i=r.shipping_profile_id;return i&&(n[i]||(n[i]=[]),n[i].push(r)),n},{});return Object.keys(t).forEach(n=>t[n].sort((r,i)=>(r.amount||0)-(i.amount||0))),t},yn=(e,t)=>!!e.email||!!(t!=null&&t.email),ke=e=>{var t;return!!((t=e.shipping_address)!=null&&t.address_1)},vn=(e,t)=>{var i;const n=((i=e.shipping_methods)==null?void 0:i.map(o=>o.shipping_option_id))||[],r=Re(t);return Object.values(r).every(o=>o.find(a=>n.includes(a.id)))};function gn(e){if((e==null?void 0:e.length)<1)return 0;const t=Re(e);return Object.values(t).reduce((n,r)=>{const i=r.reduce((o,a)=>(o.amount||0)<((a==null?void 0:a.amount)||0)?o:a);return n+(i.amount||0)},0)}const xn=X({firstName:S().min(1,"First name is required").optional(),lastName:S().min(1,"Last name is required").optional(),company:S().optional(),address1:S().min(1,"Address is required").optional(),address2:S().optional(),city:S().min(1,"City is required").optional(),province:S().min(1,"Province is required").optional(),countryCode:S().min(1,"Country is required"),postalCode:S().min(1,"Postal code is required"),phone:S().optional()}),bn=X({cartId:S(),providerId:S(),paymentMethodId:S(),sameAsShipping:je().optional(),billingAddress:$e(),noRedirect:je().optional()}).refine(e=>e.sameAsShipping?$e():xn.safeParse(e.billingAddress).success,{message:"Valid billing address is required when creating a new address",path:["root"]}),Oe=()=>{const e=nt();return{customer:e==null?void 0:e.customer}};var Z=(e=>(e.CONTACT_INFO="contactInfo",e.ACCOUNT_DETAILS="accountDetails",e.PAYMENT="payment",e.SUCCESS="success",e))(Z||{});const st=e=>{const{cart:t}=e,{customer:n}=Oe(),r=!!(n!=null&&n.id),i=m.useMemo(()=>yn(t,n),[t,n]),o=m.useMemo(()=>ke(t),[t,r]);let a="accountDetails";return i&&(a="accountDetails"),o&&(a="payment"),a},ot=m.createContext(null),Sn={setStep:(e,t)=>({...e,step:t})},jn=Zt({actionHandlers:Sn}),Cn=({data:e,...t})=>{const r={step:st({...e}),cart:null,shippingOptions:[],paymentProviders:[],activePaymentSession:null},[i,o]=m.useReducer(jn,r);return s.jsx(ot.Provider,{value:{state:{...i,...e},dispatch:o},...t})},En=({dispatch:e})=>({setStep:t=>e({name:"setStep",payload:t})}),G=()=>{const e=m.useContext(ot),t=st(e.state),{state:n}=e,i=Ft().filter(o=>o.key.startsWith(Ht));if(!n.step)throw new Error("useCheckout must be used within a CheckoutProvider");return{...n,...En(e),goToNextStep:()=>e.dispatch({name:"setStep",payload:t}),isCartMutating:i.some(o=>["loading","submitting"].includes(o.state))}},Ne=({className:e,name:t,...n})=>s.jsx(Q,{...n,className:W("[&_input]:!h-12 [&_input]:border-gray-200 [&_input]:!bg-white [&_input]:text-[16px] [&_input]:shadow-sm [&_input]:!ring-0","[&_input:-webkit-autofill]:!transition-[background-color_5000s_ease-in-out_0s]","[&_input:-webkit-autofill]:!shadow-[0_0_0_1000px_white_inset]","[&_label]:text-[16px] [&_label]:text-gray-600",e),name:t});function Nn({title:e,titleId:t,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?m.createElement("title",{id:t},e):null,m.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const _n=m.forwardRef(Nn),it=({completed:e,setStep:t,step:n,children:r})=>s.jsxs("header",{className:"relative flex items-center justify-between",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r}),e&&s.jsxs(s.Fragment,{children:[s.jsx(ce,{className:"text-sm",variant:"link",onClick:()=>t(n),children:"Edit"}),s.jsx("span",{className:"absolute -left-10 mt-0.5 hidden h-6 w-6 items-center justify-center rounded-full bg-green-100 text-green-700 md:flex",children:s.jsx(_n,{className:"h-4 w-4"})})]})]}),at=({address:e,prefix:t})=>s.jsx(s.Fragment,{children:Object.keys(e).map(n=>{const r=n;if(e[r]!=null)return s.jsx(Q,{type:"hidden",name:`${t}.${n}`,value:e[r]??""},r)})}),Te=()=>{const e=nt();if(!(e!=null&&e.env))throw new Error("No env data found, this should be provided in the root loader");return{env:e==null?void 0:e.env}};var ct={exports:{}},An="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",wn=An,Pn=wn;function lt(){}function ut(){}ut.resetWarningCache=lt;var In=function(){function e(r,i,o,a,u,c){if(c!==Pn){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:ut,resetWarningCache:lt};return n.PropTypes=n,n};ct.exports=In();var Rn=ct.exports;const A=Lt(Rn);function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?We(Object(n),!0).forEach(function(r){dt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ye(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ye=function(t){return typeof t}:ye=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(e)}function dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pt(e,t){return kn(e)||On(e,t)||Tn(e,t)||Dn()}function kn(e){if(Array.isArray(e))return e}function On(e,t){var n=e&&(typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"]);if(n!=null){var r=[],i=!0,o=!1,a,u;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(r.push(a.value),!(t&&r.length===t));i=!0);}catch(c){o=!0,u=c}finally{try{!i&&n.return!=null&&n.return()}finally{if(o)throw u}}return r}}function Tn(e,t){if(e){if(typeof e=="string")return Ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ke(e,t)}}function Ke(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var V=function(t,n,r){var i=!!r,o=C.useRef(r);C.useEffect(function(){o.current=r},[r]),C.useEffect(function(){if(!i||!t)return function(){};var a=function(){o.current&&o.current.apply(o,arguments)};return t.on(n,a),function(){t.off(n,a)}},[i,n,t,o])},_e=function(t){var n=C.useRef(t);return C.useEffect(function(){n.current=t},[t]),n.current},ne=function(t){return t!==null&&ye(t)==="object"},Fn=function(t){return ne(t)&&typeof t.then=="function"},Ln=function(t){return ne(t)&&typeof t.elements=="function"&&typeof t.createToken=="function"&&typeof t.createPaymentMethod=="function"&&typeof t.confirmCardPayment=="function"},Ye="[object Object]",Mn=function e(t,n){if(!ne(t)||!ne(n))return t===n;var r=Array.isArray(t),i=Array.isArray(n);if(r!==i)return!1;var o=Object.prototype.toString.call(t)===Ye,a=Object.prototype.toString.call(n)===Ye;if(o!==a)return!1;if(!o&&!r)return t===n;var u=Object.keys(t),c=Object.keys(n);if(u.length!==c.length)return!1;for(var l={},d=0;d<u.length;d+=1)l[u[d]]=!0;for(var p=0;p<c.length;p+=1)l[c[p]]=!0;var f=Object.keys(l);if(f.length!==u.length)return!1;var v=t,x=n,N=function(y){return e(v[y],x[y])};return f.every(N)},mt=function(t,n,r){return ne(t)?Object.keys(t).reduce(function(i,o){var a=!ne(n)||!Mn(t[o],n[o]);return r.includes(o)?(a&&console.warn("Unsupported prop change: options.".concat(o," is not a mutable property.")),i):a?Ge(Ge({},i||{}),{},dt({},o,t[o])):i},null):null},ft="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",Je=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ft;if(t===null||Ln(t))return t;throw new Error(n)},Bn=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ft;if(Fn(t))return{tag:"async",stripePromise:Promise.resolve(t).then(function(i){return Je(i,n)})};var r=Je(t,n);return r===null?{tag:"empty"}:{tag:"sync",stripe:r}},Un=function(t){!t||!t._registerWrapper||!t.registerAppInfo||(t._registerWrapper({name:"react-stripe-js",version:"2.7.3"}),t.registerAppInfo({name:"react-stripe-js",version:"2.7.3",url:"https://stripe.com/docs/stripe-js/react"}))},be=C.createContext(null);be.displayName="ElementsContext";var ht=function(t,n){if(!t)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return t},De=function(t){var n=t.stripe,r=t.options,i=t.children,o=C.useMemo(function(){return Bn(n)},[n]),a=C.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(r):null}}),u=pt(a,2),c=u[0],l=u[1];C.useEffect(function(){var f=!0,v=function(N){l(function(_){return _.stripe?_:{stripe:N,elements:N.elements(r)}})};return o.tag==="async"&&!c.stripe?o.stripePromise.then(function(x){x&&f&&v(x)}):o.tag==="sync"&&!c.stripe&&v(o.stripe),function(){f=!1}},[o,c,r]);var d=_e(n);C.useEffect(function(){d!==null&&d!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[d,n]);var p=_e(r);return C.useEffect(function(){if(c.elements){var f=mt(r,p,["clientSecret","fonts"]);f&&c.elements.update(f)}},[r,p,c.elements]),C.useEffect(function(){Un(c.stripe)},[c.stripe]),C.createElement(be.Provider,{value:c},i)};De.propTypes={stripe:A.any,options:A.object};var Vn=function(t){var n=C.useContext(be);return ht(n,t)},qn=function(){var t=Vn("calls useElements()"),n=t.elements;return n};A.func.isRequired;var yt=C.createContext(null);yt.displayName="CustomCheckoutSdkContext";var $n=function(t,n){if(!t)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(n," in an <CustomCheckoutProvider> provider."));return t},Wn=C.createContext(null);Wn.displayName="CustomCheckoutContext";A.any,A.shape({clientSecret:A.string.isRequired,elementsOptions:A.object}).isRequired;var Ae=function(t){var n=C.useContext(yt),r=C.useContext(be);if(n&&r)throw new Error("You cannot wrap the part of your app that ".concat(t," in both <CustomCheckoutProvider> and <Elements> providers."));return n?$n(n,t):ht(r,t)},Gn=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},T=function(t,n){var r="".concat(Gn(t),"Element"),i=function(c){var l=c.id,d=c.className,p=c.options,f=p===void 0?{}:p,v=c.onBlur,x=c.onFocus,N=c.onReady,_=c.onChange,y=c.onEscape,L=c.onClick,w=c.onLoadError,k=c.onLoaderStart,h=c.onNetworksChange,P=c.onConfirm,I=c.onCancel,F=c.onShippingAddressChange,j=c.onShippingRateChange,R=Ae("mounts <".concat(r,">")),B="elements"in R?R.elements:null,q="customCheckoutSdk"in R?R.customCheckoutSdk:null,E=C.useState(null),Y=pt(E,2),M=Y[0],pe=Y[1],K=C.useRef(null),H=C.useRef(null);V(M,"blur",v),V(M,"focus",x),V(M,"escape",y),V(M,"click",L),V(M,"loaderror",w),V(M,"loaderstart",k),V(M,"networkschange",h),V(M,"confirm",P),V(M,"cancel",I),V(M,"shippingaddresschange",F),V(M,"shippingratechange",j),V(M,"change",_);var ee;N&&(t==="expressCheckout"?ee=N:ee=function(){N(M)}),V(M,"ready",ee),C.useLayoutEffect(function(){if(K.current===null&&H.current!==null&&(B||q)){var b=null;q?b=q.createElement(t,f):B&&(b=B.create(t,f)),K.current=b,pe(b),b&&b.mount(H.current)}},[B,q,f]);var $=_e(f);return C.useEffect(function(){if(K.current){var b=mt(f,$,["paymentRequest"]);b&&K.current.update(b)}},[f,$]),C.useLayoutEffect(function(){return function(){if(K.current&&typeof K.current.destroy=="function")try{K.current.destroy(),K.current=null}catch{}}},[]),C.createElement("div",{id:l,className:d,ref:H})},o=function(c){Ae("mounts <".concat(r,">"));var l=c.id,d=c.className;return C.createElement("div",{id:l,className:d})},a=n?o:i;return a.propTypes={id:A.string,className:A.string,onChange:A.func,onBlur:A.func,onFocus:A.func,onReady:A.func,onEscape:A.func,onClick:A.func,onLoadError:A.func,onLoaderStart:A.func,onNetworksChange:A.func,onConfirm:A.func,onCancel:A.func,onShippingAddressChange:A.func,onShippingRateChange:A.func,options:A.object},a.displayName=r,a.__elementType=t,a},D=typeof window>"u",Kn=C.createContext(null);Kn.displayName="EmbeddedCheckoutProviderContext";var Yn=function(){var t=Ae("calls useStripe()"),n=t.stripe;return n};T("auBankAccount",D);T("card",D);T("cardNumber",D);T("cardExpiry",D);T("cardCvc",D);T("fpxBank",D);T("iban",D);T("idealBank",D);T("p24Bank",D);T("epsBank",D);var Jn=T("payment",D);T("expressCheckout",D);T("paymentRequestButton",D);T("linkAuthentication",D);var zn=T("address",D);T("shippingAddress",D);T("paymentMethodMessaging",D);T("affirmMessage",D);T("afterpayClearpayMessage",D);var vt="https://js.stripe.com/v3",Qn=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var Xn=function(){for(var t=document.querySelectorAll('script[src^="'.concat(vt,'"]')),n=0;n<t.length;n++){var r=t[n];if(Qn.test(r.src))return r}return null},ze=function(t){var n="",r=document.createElement("script");r.src="".concat(vt).concat(n);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(r),r},Zn=function(t,n){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:n})},oe=null,fe=null,he=null,Hn=function(t){return function(){t(new Error("Failed to load Stripe.js"))}},er=function(t,n){return function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))}},tr=function(t){return oe!==null?oe:(oe=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var i=Xn();if(!(i&&t)){if(!i)i=ze(t);else if(i&&he!==null&&fe!==null){var o;i.removeEventListener("load",he),i.removeEventListener("error",fe),(o=i.parentNode)===null||o===void 0||o.removeChild(i),i=ze(t)}}he=er(n,r),fe=Hn(r),i.addEventListener("load",he),i.addEventListener("error",fe)}catch(a){r(a);return}}),oe.catch(function(n){return oe=null,Promise.reject(n)}))},nr=function(t,n,r){if(t===null)return null;var i=t.apply(void 0,n);return Zn(i,r),i},ie,gt=!1,xt=function(){return ie||(ie=tr(null).catch(function(t){return ie=null,Promise.reject(t)}),ie)};Promise.resolve().then(function(){return xt()}).catch(function(e){gt||console.warn(e)});var bt=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];gt=!0;var i=Date.now();return xt().then(function(o){return nr(o,n,i)})};const rr=e=>({address:{firstName:(e==null?void 0:e.first_name)||"",lastName:(e==null?void 0:e.last_name)||"",address1:(e==null?void 0:e.address_1)||"",address2:(e==null?void 0:e.address_2)||"",province:(e==null?void 0:e.province)||"",city:(e==null?void 0:e.city)||"",countryCode:(e==null?void 0:e.country_code)||"us",postalCode:(e==null?void 0:e.postal_code)||"",phone:(e==null?void 0:e.phone)||""},completed:!1}),St=({title:e,address:t,mode:n,allowedCountries:r=[],setAddress:i})=>{var d;const{env:o}=Te(),{cart:a}=G(),{region:u}=en(),c=p=>{var _,y;const f=((_=p.value.name)==null?void 0:_.split(" "))||[],v=f.slice(0,-1).join(" "),x=f.slice(-1).join(" "),N=p.complete&&!p.value.address.state;i({address:{firstName:p.value.firstName||v||"",lastName:p.value.lastName||x||"",address1:p.value.address.line1,address2:p.value.address.line2??"",province:N?"-":p.value.address.state,city:p.value.address.city,countryCode:(y=p.value.address.country)==null?void 0:y.toLowerCase(),postalCode:p.value.address.postal_code,phone:p.value.phone??""},completed:p.complete})},l=m.useMemo(()=>o.STRIPE_PUBLIC_KEY?bt(o.STRIPE_PUBLIC_KEY):null,[o.STRIPE_PUBLIC_KEY]);return a?s.jsxs("div",{children:[e&&s.jsx("h3",{className:"mt-6 text-sm",children:e}),s.jsx(De,{stripe:l,options:{mode:"setup",currency:u.currency_code,appearance:{variables:{borderRadius:"6px",spacingUnit:"4.601px",fontSizeBase:"16px",colorText:"#374151",fontWeightNormal:"400",fontWeightBold:"700",fontSizeSm:"16px"},rules:{".Input":{fontSize:"1rem",color:"#000000"},".Input:focus":{boxShadow:"inset 0 0 0 1px rgba(210, 213, 218, 1)"},".Label":{FontWeight:"700"}}}},children:s.jsx(zn,{options:{mode:n,allowedCountries:r,display:{name:"split"},fields:{phone:"always"},validation:{phone:{required:"always"}},defaultValues:{address:{line1:t.address1,line2:t.address2,city:t.city,state:t.province,postal_code:t.postalCode,country:((d=t.countryCode)==null?void 0:d.toUpperCase())||"us"},phone:t.phone,firstName:t.firstName,lastName:t.lastName}},onChange:c})})]}):null},jt=({title:e,address:t,countryOptions:n})=>{var r;return s.jsxs("span",{children:[e&&s.jsx("dt",{className:"mt-6 text-sm font-bold text-gray-700",children:e}),s.jsxs("dd",{className:"mt-0.5",children:[(t==null?void 0:t.company)&&s.jsxs(s.Fragment,{children:[t==null?void 0:t.company,s.jsx("br",{})]}),t==null?void 0:t.address1,s.jsx("br",{}),(t==null?void 0:t.address2)&&s.jsxs(s.Fragment,{children:[t==null?void 0:t.address2,s.jsx("br",{})]}),t==null?void 0:t.city,", ",t==null?void 0:t.province," ",t==null?void 0:t.postalCode,s.jsx("br",{}),(t==null?void 0:t.countryCode)&&s.jsxs(s.Fragment,{children:[(r=n.find(({value:i})=>i===(t==null?void 0:t.countryCode)))==null?void 0:r.label,s.jsx("br",{})]})]})]})},sr=(e,t)=>{var r,i,o;return e.shipping_address?e.shipping_address:!t||!((r=t==null?void 0:t.addresses)!=null&&r.length)?null:(t!=null&&t.default_shipping_address_id?(i=t.addresses)==null?void 0:i.find(a=>a.id===(t==null?void 0:t.default_shipping_address_id)):(o=t==null?void 0:t.addresses)==null?void 0:o[0])||null},or="new",ir=()=>{var P,I,F;const e=re({key:ge.cart.accountDetails}),{customer:t}=Oe(),{regions:n}=tn(),{step:r,setStep:i,goToNextStep:o,cart:a,isCartMutating:u}=G(),c=r===Z.ACCOUNT_DETAILS;if(!a)return null;const l=(n??[]).flatMap(j=>j.countries.map(R=>R.iso_2)),d=sr(a,t),p=ke(a),f=["submitting","loading"].includes(e.state),v=!!((P=e.data)!=null&&P.errors),x=(d==null?void 0:d.id)??or,N=((F=(I=a.region)==null?void 0:I.countries)==null?void 0:F.map(j=>({value:j.iso_2,label:j.display_name})))??[],_={cartId:a.id,email:(t==null?void 0:t.email)||a.email||"",customerId:t==null?void 0:t.id,allowSuggestions:!0,shippingAddress:{...Ie(d)},shippingAddressId:x},y=ue({resolver:le(pn),defaultValues:_,fetcher:e,submitConfig:{method:"post",action:"/api/checkout/account-details"}}),L=j=>{y.setValue("shippingAddress.address1",j.address.address1??""),y.setValue("shippingAddress.address2",j.address.address2??""),y.setValue("shippingAddress.city",j.address.city??""),y.setValue("shippingAddress.province",j.address.province??""),y.setValue("shippingAddress.countryCode",j.address.countryCode??""),y.setValue("shippingAddress.postalCode",j.address.postalCode??""),y.setValue("shippingAddress.phone",j.address.phone??""),y.setValue("shippingAddress.firstName",j.address.firstName??""),y.setValue("shippingAddress.lastName",j.address.lastName??""),y.setValue("shippingAddress.company",j.address.company??""),y.setValue("shippingAddress.phone",j.address.phone??"")},w=y.watch("shippingAddress");m.useEffect(()=>{c&&!f&&!v&&p&&(y.reset(),o())},[f,p]);const k=()=>{o()},h=p&&!c;return s.jsxs("div",{className:"checkout-account-details",children:[s.jsx(it,{completed:h,setStep:i,step:Z.ACCOUNT_DETAILS,children:"Account details"}),!c&&p&&s.jsx(jt,{title:"Shipping Address",address:w,countryOptions:N}),c&&s.jsxs(s.Fragment,{children:[t!=null&&t.email?s.jsx("p",{className:"mt-2 text-sm mb-2",children:"To get started, please select your shipping address."}):s.jsx("p",{className:"mt-2 text-sm mb-4",children:"To get started, enter your email address."}),s.jsx(de,{...y,children:s.jsxs(e.Form,{id:"checkout-account-details-form",onSubmit:y.handleSubmit,children:[s.jsx(Q,{type:"hidden",name:"cartId"}),s.jsx(Q,{type:"hidden",name:"customerId"}),s.jsx(Ne,{name:"email",type:"email",autoComplete:"email",placeholder:"Email address",label:"Email Address",className:"[&_input]:!ring-0 mb-2"}),s.jsx(at,{address:w,prefix:"shippingAddress"}),s.jsx(Ne,{type:"hidden",name:"shippingAddressId",value:x}),s.jsx(St,{mode:"shipping",address:w,allowedCountries:l,setAddress:L}),s.jsx(we,{}),s.jsxs(Kt,{children:[s.jsx(Pe,{disabled:f||u,children:f?"Saving...":"Save and continue"}),p&&s.jsx(ce,{disabled:f,onClick:k,children:"Cancel edit"})]})]})})]})]})},ar="/assets/StripeBadge-D70kF_jj.png",cr=({className:e})=>s.jsx("img",{className:e,width:320,src:ar,alt:"stripe security badge"});Yt({page:qe.number().int().min(0).default(0),pageSize:qe.number().int().min(1).default(10),sortField:Ve().optional(),sortOrder:Jt(["asc","desc"]).default("asc"),dataTableSearch:Ve().optional()}).passthrough();const lr=({shippingOption:e,region:t,value:n})=>{const r=n===e.id;return s.jsx("div",{className:"relative col-span-1",children:s.jsx("label",{htmlFor:e.id,className:"",children:s.jsxs("div",{className:W("group relative flex h-full flex-col justify-between rounded-lg border bg-white p-4 shadow-sm","active:ring-primary-500 hover:border-gray-400 focus:outline-none active:ring-2",r?"border-transparent":"border-gray-300"),children:[s.jsxs("div",{className:"flex justify-between gap-1",children:[s.jsx("div",{className:"block text-sm font-bold text-gray-900",children:e.name}),s.jsx(zt,{id:e.id,value:e.id,className:"text-primary-600 h-5 w-5 border-0",indicator:s.jsx(Qt,{className:"text-primary-600 h-5 w-5","aria-hidden":"true"})})]}),s.jsx("div",{className:"mt-6 flex items-end justify-between text-sm text-gray-500",children:s.jsx("div",{children:xe(e.amount,{currency:t.currency_code})})}),s.jsx("div",{className:W("pointer-events-none absolute -inset-px rounded-lg border-2 active:border",r?"border-primary-500":"border-transparent"),"aria-hidden":"true"})]})})})},ur=({name:e,shippingOptions:t,region:n,value:r,onValueChange:i,disabled:o})=>{const a=rt(),u=a.formState.isSubmitting,c=async l=>{if(!u){i==null||i(l);try{await a.handleSubmit()}catch(d){console.error("Failed to submit shipping option:",d)}}};return t.length?s.jsx(Xt,{name:e,value:r??"",onValueChange:c,className:W("xs:grid-cols-2 my-6 grid grid-cols-1 gap-4",u&&"pointer-events-none"),disabled:u||o,children:t.map(l=>s.jsx(lr,{shippingOption:l,region:n},l.id))}):s.jsx("div",{children:"No shipping options available"})},dr=(e,t)=>{var r;const n=((r=e.shipping_methods)==null?void 0:r.map(i=>i.shipping_option_id))??[];return Object.values(t).reduce((i,o)=>{const a=o.find(u=>n.includes(u.id));return i.push(a?a.id:o[0].id),i},[])},pr=(e,t)=>({cartId:e.id,shippingOptionIds:dr(e,t)}),mr=()=>{var y,L,w;const e=re(),{step:t,shippingOptions:n,setStep:r,goToNextStep:i,cart:o,isCartMutating:a}=G(),u=t===Z.PAYMENT,c=["submitting","loading"].includes(e.state);if(!o)return null;const l=!!((y=e.data)!=null&&y.errors),d=ke(o),p=m.useMemo(()=>Re(n),[n]),f=m.useMemo(()=>vn(o,n),[o,n]),v=m.useMemo(()=>pr(o,p),[o,p]),x=ue({resolver:le(dn),defaultValues:v,fetcher:e,submitConfig:{method:"post",action:"/api/checkout/shipping-methods"}}),N=x.watch("shippingOptionIds");m.useEffect(()=>{var k;x.setValue("shippingOptionIds",((k=o.shipping_methods)==null?void 0:k.map(h=>h.shipping_option_id))??[])},[o.shipping_methods]),m.useEffect(()=>{u&&!c&&!l&&f&&i()},[c,f]);const _=!u&&d;return s.jsxs("div",{className:"checkout-delivery-method",children:[s.jsx(it,{completed:_,setStep:r,step:Z.PAYMENT,children:"Delivery & Payment"}),!u&&s.jsxs(s.Fragment,{children:[((L=o.shipping_methods)==null?void 0:L.length)===0&&s.jsx(cr,{className:"mt-4"}),s.jsx("dl",{children:(w=o.shipping_methods)==null?void 0:w.map((k,h)=>{var R;const{id:P,shipping_option_id:I,amount:F}=k,j=n.find(B=>B.id===I);return s.jsxs(m.Fragment,{children:[s.jsx("dt",{className:`${h>0?"mt-6":"mt-4"} text-sm font-bold text-gray-700`,children:"Delivery method for: All items"}),s.jsxs("dd",{className:"mt-0.5",children:[j==null?void 0:j.name," (",xe(F,{currency:(R=o==null?void 0:o.region)==null?void 0:R.currency_code}),")"]})]},P)})})]}),u&&s.jsx(de,{...x,children:s.jsxs(e.Form,{children:[s.jsx(Q,{type:"hidden",name:"cartId",value:o.id}),Object.entries(p).map(([k,h],P)=>{var I;return h.length<1?null:s.jsxs(m.Fragment,{children:[P>0&&s.jsx("hr",{className:"my-6"}),!!((I=o==null?void 0:o.shipping_methods)!=null&&I.length)&&s.jsx(ve,{type:"info",className:"my-6",children:"Choose your delivery option"}),s.jsx(ur,{disabled:a,name:`shippingOptionIds.${P}`,shippingOptions:h,region:o.region,value:(N==null?void 0:N[P])??null,onValueChange:F=>x.setValue(`shippingOptionIds.${P}`,F)})]},k)})]})})]})},fr=({formId:e,item:t,className:n,maxInventory:r=10,...i})=>{const o=re({key:ge.cart.updateLineItem}),a=["submitting","loading"].includes(o.state),u=ue({resolver:le(mn),defaultValues:{lineItemId:t.id,quantity:t.quantity.toString()},fetcher:o,submitConfig:{method:"post",action:"/api/cart/line-items/update"}}),c=l=>{o.submit({lineItemId:t.id,quantity:l},{method:"post",action:"/api/cart/line-items/update"})};return s.jsx(de,{...u,children:s.jsx(o.Form,{id:e,className:W("line-item-quantity-select",n),...i,onSubmit:u.handleSubmit,children:s.jsx(ln,{formId:e,className:W({"pointer-events-none opacity-50":a}),variant:t.variant,onChange:c})})})},hr=({item:e,name:t})=>{var a,u,c;const{cart:n}=G(),r=nn(),i=()=>r.submit(e),o=["loading","submitting"].includes(r.state);return n?s.jsxs("li",{className:"flex px-4 py-6 sm:px-6",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(an,{src:((u=(a=e.variant)==null?void 0:a.product)==null?void 0:u.thumbnail)||"",alt:e.product_title||"product thumbnail",className:"w-20 rounded-md"})}),s.jsxs("div",{className:"ml-6 flex flex-1 flex-col",children:[s.jsxs("div",{className:"flex",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h4",{className:"text-base",children:s.jsx(tt,{to:`/products/${e.product_handle}`,className:"font-bold text-gray-700 hover:text-gray-800",children:e.product_title})}),s.jsx("p",{className:"mt-0.5 text-sm text-gray-500",children:e.variant_title})]}),s.jsx("div",{className:"ml-4 flow-root flex-shrink-0",children:s.jsx(ce,{variant:"link",onClick:i,disabled:o,className:"text-sm",children:o?"Removing":"Remove"})})]}),s.jsxs("div",{className:"flex flex-1 items-end justify-between pt-2",children:[s.jsx("div",{className:"mr-4",children:s.jsx(fr,{formId:`quantity-${t}-${e.id}`,item:e})}),s.jsx("p",{className:"mt-1 text-lg",children:s.jsx("span",{className:"font-bold text-gray-900",children:xe(e.unit_price,{currency:(c=n.region)==null?void 0:c.currency_code})})})]})]})]}):null},yr=({cart:e,name:t})=>{var n;return s.jsx("ul",{role:"list",className:"divide-y divide-gray-200",children:(n=e.items)==null?void 0:n.map(r=>s.jsx(hr,{item:r,name:t},r.id))})},vr=({cart:e,promotion:t})=>{const n=re({key:ge.cart.removePromotionCode});return["submitting","loading"].includes(n.state)?null:s.jsxs(n.Form,{method:"post",action:"/api/checkout/remove-discount-code",children:[s.jsx("input",{type:"hidden",name:"cartId",value:e.id}),s.jsx("input",{type:"hidden",name:"code",value:t.code}),s.jsxs("button",{className:"focus:ring-primary-100 focus:border-primary-100 inline-flex h-8 items-center rounded-md border border-gray-300 bg-white px-2 text-xs font-bold text-gray-900 shadow-sm hover:bg-gray-100",children:[s.jsx("span",{children:t.code}),s.jsx("div",{className:"ml-[4px] inline-block text-gray-400",children:s.jsx(rn,{className:"inline-block h-4 w-4 leading-none"})})]})]})},gr=({cart:e})=>{var p,f,v;const t=m.useRef(null),n=m.useRef(null),r=re(),[i,o]=m.useState(!!e.promotions.length),a=!!((p=e.promotions)!=null&&p.length),u=Object.keys(((f=r.data)==null?void 0:f.errors)||{}).length>0,c=["submitting","loading"].includes(r.state),l=ue({resolver:le(fn),defaultValues:{cartId:e.id,code:""},fetcher:r,submitConfig:{method:"post",action:"/api/checkout/discount-code"}});m.useEffect(()=>{var x;!c&&!u&&(l.reset(),(x=n.current)==null||x.focus())},[c,u]);const d=()=>{o(!0),setTimeout(()=>{var x;return(x=n.current)==null?void 0:x.focus()},0)};return s.jsxs("div",{className:"mb-6",children:[!i&&s.jsx("div",{children:s.jsx(un,{size:"sm",onClick:d,children:"Add promo code"})}),i&&s.jsxs(s.Fragment,{children:[s.jsx(de,{...l,children:s.jsxs(r.Form,{ref:t,onSubmit:l.handleSubmit,children:[s.jsx("input",{type:"hidden",name:"cartId",value:e.id}),s.jsxs("div",{className:"!my-0 !flex items-start gap-1",children:[s.jsx(Ne,{name:"code",className:"flex-grow",placeholder:"Discount code","aria-label":"discount code"}),s.jsx(Pe,{type:"submit",className:"flex-shrink-0 flex-grow-0",disabled:c,children:c?"Applying...":"Apply"})]}),s.jsx(we,{})]})}),a&&s.jsx("div",{className:"mt-2",children:(v=e.promotions)==null?void 0:v.map(x=>s.jsx(vr,{cart:e,promotion:x},x.id))})]})]})},te=({label:e,amount:t,className:n,region:r})=>s.jsxs("div",{className:W("flex items-center justify-between text-sm",n),children:[s.jsx("dt",{children:e}),s.jsx("dd",{className:"font-bold text-gray-900",children:xe(t||0,{currency:r==null?void 0:r.currency_code})})]}),xr=({shippingOptions:e,cart:t})=>{const r=(t.shipping_methods||[]).length>0,i=gn(e),o=t.discount_total??0,a=t.shipping_total??0,u=t.total??0,c=r?u:u+i;return s.jsxs("div",{className:"border-t border-gray-200 px-4 py-6 sm:px-6",children:[s.jsx(gr,{cart:t}),s.jsxs("dl",{className:"flex flex-col gap-2",children:[s.jsx(te,{label:"Subtotal",amount:t.item_subtotal,region:t.region}),o>0&&s.jsx(te,{label:"Discount",amount:-o,region:t.region}),r&&s.jsx(te,{label:"Shipping",amount:a,region:t.region}),!r&&s.jsx(te,{label:"Estimated Shipping",amount:i,region:t.region}),s.jsx(te,{label:"Taxes",amount:t.tax_total,region:t.region}),s.jsx(te,{label:"Total",amount:c,className:"border-t border-gray-200 pt-6 !text-xl",region:t.region})]})]})},Ct=({submitButton:e,name:t})=>{const{shippingOptions:n,cart:r}=G();return r?s.jsxs("div",{className:"my-0 rounded-lg border border-gray-200 bg-white shadow-sm",children:[s.jsx("h3",{className:"sr-only",children:"Items in your cart"}),s.jsx(yr,{cart:r,name:t}),s.jsx(xr,{cart:r,shippingOptions:n}),e&&s.jsx("div",{className:"border-t border-gray-200 p-4 sm:p-6",children:e})]}):null},Et=({id:e,submitMessage:t,onSubmit:n,paymentMethods:r,children:i,providerId:o,className:a})=>{var B,q;const{activePaymentSession:u,cart:c,isCartMutating:l}=G(),d=re({key:ge.cart.completeCheckout}),[p,f]=m.useState(!1),v=["submitting","loading"].includes(d.state)||p,x=r.filter(E=>E.provider_id===o),N=x.length>0,_=N?x[0].data.id:"new";if(!c)return null;const y=Ie(c.billing_address),L=rr(c==null?void 0:c.shipping_address)??Ee,w=((q=(B=c.region)==null?void 0:B.countries)==null?void 0:q.map(E=>({value:E.iso_2,label:E.display_name})))??[],k={cartId:c.id,paymentMethodId:_,sameAsShipping:!0,billingAddress:y,providerId:o},h=ue({resolver:le(bn),defaultValues:k,fetcher:d,submitConfig:{method:"post",action:"/api/checkout/complete"}}),P=h.watch("sameAsShipping"),I=h.watch("billingAddress"),F=async E=>{E.preventDefault(),f(!0);const Y=h.getValues();return typeof n=="function"?await n(Y,E,{setSubmitting:f,submit:()=>h.handleSubmit()}):h.handleSubmit()},j=E=>{h.setValue("billingAddress.address1",E.address.address1??""),h.setValue("billingAddress.address2",E.address.address2??""),h.setValue("billingAddress.city",E.address.city??""),h.setValue("billingAddress.province",E.address.province??""),h.setValue("billingAddress.countryCode",E.address.countryCode??""),h.setValue("billingAddress.postalCode",E.address.postalCode??""),h.setValue("billingAddress.phone",E.address.phone??""),h.setValue("billingAddress.firstName",E.address.firstName??""),h.setValue("billingAddress.lastName",E.address.lastName??""),h.setValue("billingAddress.company",E.address.company??""),h.setValue("billingAddress.phone",E.address.phone??"")},R=()=>s.jsx(Pe,{form:e,className:"w-full lg:w-auto",disabled:v||l||!P&&!I,children:v?"Confirming...":t??"Confirm & Pay"});return u?s.jsx(s.Fragment,{children:s.jsxs(de,{...h,children:[s.jsxs(d.Form,{id:e,onSubmit:F,className:a,children:[s.jsx(Q,{type:"hidden",name:"cartId",value:c.id}),s.jsx(Q,{type:"hidden",name:"providerId",value:o}),s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Billing address"}),s.jsx(hn,{className:"my-4",name:"sameAsShipping",label:"Same as shipping address"}),!P&&s.jsx(St,{mode:"billing",address:I,setAddress:j}),s.jsx(at,{address:I,prefix:"billingAddress"}),P&&s.jsx("div",{className:"-mt-2 mb-4",children:s.jsx(jt,{address:L.address,countryOptions:w})}),!N&&s.jsx("input",{type:"hidden",name:"paymentMethodId",value:"new"}),s.jsx("div",{className:`stripe-payment-form ${_!=="new"?"hidden":""}`,children:i}),s.jsx(we,{})]}),s.jsx("div",{className:"block lg:hidden",children:s.jsx(Ct,{name:"checkout",submitButton:s.jsx(R,{})})}),s.jsx("div",{className:"hidden lg:block",children:s.jsx(R,{})})]})}):null},br=e=>s.jsx(Et,{providerId:"pp_system_default",id:"TestPaymentForm",submitMessage:"Checkout using Test Payment",className:"mt-4",...e}),Sr=({options:e,children:t})=>{var u,c;const{env:n}=Te(),{cart:r}=G(),i=m.useMemo(()=>n.STRIPE_PUBLIC_KEY?bt(n.STRIPE_PUBLIC_KEY):null,[]),o=m.useMemo(()=>{var l,d;return(d=(l=r==null?void 0:r.payment_collection)==null?void 0:l.payment_sessions)==null?void 0:d.find(p=>p.provider_id==="pp_stripe_stripe")},[(u=r==null?void 0:r.payment_collection)==null?void 0:u.payment_sessions]),a=(c=o==null?void 0:o.data)==null?void 0:c.client_secret;return!o||!i||!a?null:s.jsx(De,{stripe:i,options:e??{clientSecret:a},children:t},a)},jr=({isActiveStep:e,paymentMethods:t})=>{var N,_;const[n,r]=m.useState(),[i,o]=m.useState(),a=Yn(),u=qn(),{activePaymentSession:c,cart:l}=G(),d=m.useMemo(()=>t==null?void 0:t.filter(y=>y.provider_id==="pp_stripe_stripe"),[t]);m.useEffect(()=>{u&&u.fetchUpdates()},[(N=c==null?void 0:c.payment)==null?void 0:N.updated_at]);const p=d.length>0,f=p?(_=d[0].data)==null?void 0:_.id:"new";if(m.useEffect(()=>{e&&n&&n.focus()},[e,n]),!l||!a||!u)return null;const v=async(y,L,{setSubmitting:w,submit:k})=>{if(o(void 0),y.paymentMethodId!=="new"){k(L.target);return}const h=y.sameAsShipping?Ie(l.billing_address):y.billingAddress,P={name:`${h.firstName} ${h.lastName}`,email:l.email,phone:h.phone||"",address:{line1:h.address1||"",line2:h.address2||"",city:h.city||"",state:h.province||"",postal_code:h.postalCode||"",country:h.countryCode||""}};return w(!0),a.confirmPayment({elements:u,confirmParams:{return_url:`${window.location.origin}/checkout/success`,payment_method_data:{billing_details:P}},redirect:"if_required"}).then(({paymentIntent:I,error:F})=>{if(F){o(F.message),w(!1),n==null||n.focus();return}k(L.target)}).catch(I=>{w(!1),console.error(I)})},x=y=>{r(y)};return s.jsx(s.Fragment,{children:s.jsx(Et,{providerId:"pp_stripe_stripe",id:"stripePaymentForm",paymentMethods:d,onSubmit:v,children:s.jsxs("div",{className:W({"h-0 overflow-hidden opacity-0":p&&f!=="new"}),children:[s.jsx(Jn,{onReady:x,className:"my-6 w-full",options:{fields:{billingDetails:{address:{country:"never",postalCode:"never"}}},terms:{card:"never"}}}),i&&s.jsx(ve,{type:"error",className:W("form__error -mt-4 mb-2"),children:i})]})})})},Cr=e=>{const{isActiveStep:t,...n}=e;return s.jsx(Sr,{children:s.jsx(jr,{...n,isActiveStep:t})})},Er=()=>{const{env:e}=Te(),{step:t,paymentProviders:n,cart:r}=G(),i=t===Z.PAYMENT;if(!r)return null;const o=m.useMemo(()=>n==null?void 0:n.some(l=>l.id.includes("pp_stripe_stripe")),[n]),a=m.useMemo(()=>!!(n!=null&&n.some(l=>l.id.includes("pp_system_default"))),[n]),u=[{id:"pp_stripe_stripe",label:"Credit Card",component:Cr,isActive:o},{id:"pp_system_default",label:"Test Payment",component:br,isActive:a&&e.NODE_ENV==="development"}],c=m.useMemo(()=>u.filter(l=>l.isActive),[u]);return s.jsx("div",{className:"checkout-payment",children:s.jsx("div",{className:W({"h-0 overflow-hidden opacity-0":!i}),children:s.jsxs(se.Group,{children:[c.length>1&&s.jsx(se.List,{className:"bg-primary-50 mb-2 mt-6 inline-flex gap-0.5 rounded-full p-2",children:c.map((l,d)=>s.jsx(se,{as:ce,className:({selected:p})=>W("!rounded-full",{"!bg-white !text-gray-700 shadow-sm":p,"!bg-primary-50 !border-primary-100 !text-primary-600 hover:!text-primary-800 hover:!bg-primary-100 !border-none":!p}),children:l.label},l.id))}),s.jsx(se.Panels,{children:c.map(l=>{const d=l.component;return s.jsx(se.Panel,{children:s.jsx(d,{isActiveStep:i,paymentMethods:[]})},l.id)})})]})})})},Qe={update:async e=>{const t=await fetch("/api/checkout/express",{method:"POST",body:Ce(e)});return t.ok?[await t.json(),null]:[null,new Error("Failed to update shipping address")]}};/*!
 * react-paypal-js v8.9.2 (2025-10-02T20:17:55.069Z)
 * Copyright 2020-present, PayPal, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var U;(function(e){e.INITIAL="initial",e.PENDING="pending",e.REJECTED="rejected",e.RESOLVED="resolved"})(U||(U={}));var J;(function(e){e.LOADING_STATUS="setLoadingStatus",e.RESET_OPTIONS="resetOptions",e.SET_BRAINTREE_INSTANCE="braintreeInstance"})(J||(J={}));var Xe;(function(e){e.NUMBER="number",e.CVV="cvv",e.EXPIRATION_DATE="expirationDate",e.EXPIRATION_MONTH="expirationMonth",e.EXPIRATION_YEAR="expirationYear",e.POSTAL_CODE="postalCode"})(Xe||(Xe={}));var O=function(){return O=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},O.apply(this,arguments)};function Nt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Ze(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var ae="data-react-paypal-script-id",z={DATA_JS_SDK_LIBRARY:"dataJsSdkLibrary",DATA_LIBRARY_VALUE:"react-paypal-js",DATA_NAMESPACE:"dataNamespace",DATA_SDK_INTEGRATION_SOURCE:"dataSdkIntegrationSource"},Nr="Failed to load the PayPal JS SDK script.",_t="paypal",_r="usePayPalScriptReducer must be used within a PayPalScriptProvider";function Ar(e){return e===void 0&&(e=_t),window[e]}function wr(e){for(var t="",n=0;n<e.length;n++){var r=e[n].charCodeAt(0)*n;e[n+1]&&(r+=e[n+1].charCodeAt(0)*(n-1)),t+=String.fromCharCode(97+Math.abs(r)%26)}return t}function Pr(e){var t=e.reactComponentName,n=e.sdkComponentKey,r=e.sdkRequestedComponents,i=r===void 0?"":r,o=e.sdkDataNamespace,a=o===void 0?_t:o,u=n.charAt(0).toUpperCase().concat(n.substring(1)),c="Unable to render <".concat(t," /> because window.").concat(a,".").concat(u," is undefined."),l=typeof i=="string"?i:i.join(",");if(!l.includes(n)){var d=[l,n].filter(Boolean).join();c+=`
To fix the issue, add '`.concat(n,"' to the list of components passed to the parent PayPalScriptProvider:")+"\n`<PayPalScriptProvider options={{ components: '".concat(d,"'}}>`.")}return c}function At(e){var t=e,n=ae;t[n];var r=Nt(t,[n+""]);return"react-paypal-js-".concat(wr(JSON.stringify(r)))}function Ir(e){var t=self.document.querySelector("script[".concat(ae,'="').concat(e,'"]'));t!=null&&t.parentNode&&t.parentNode.removeChild(t)}function Rr(e,t){var n,r;switch(t.type){case J.LOADING_STATUS:return typeof t.value=="object"?O(O({},e),{loadingStatus:t.value.state,loadingStatusErrorMessage:t.value.message}):O(O({},e),{loadingStatus:t.value});case J.RESET_OPTIONS:return Ir(e.options[ae]),O(O({},e),{loadingStatus:U.PENDING,options:O(O((n={},n[z.DATA_SDK_INTEGRATION_SOURCE]=z.DATA_LIBRARY_VALUE,n),t.value),(r={},r[ae]="".concat(At(t.value)),r))});case J.SET_BRAINTREE_INSTANCE:return O(O({},e),{braintreePayPalCheckoutInstance:t.value});default:return e}}var wt=m.createContext(null);function kr(e){if(typeof(e==null?void 0:e.dispatch)=="function"&&e.dispatch.length!==0)return e;throw new Error(_r)}function Or(){var e=kr(m.useContext(wt)),t=O(O({},e),{isInitial:e.loadingStatus===U.INITIAL,isPending:e.loadingStatus===U.PENDING,isResolved:e.loadingStatus===U.RESOLVED,isRejected:e.loadingStatus===U.REJECTED});return[t,e.dispatch]}m.createContext({});function Tr(e){var t=m.useRef(new Proxy({},{get:function(n,r,i){return typeof n[r]=="function"?function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return n[r].apply(n,o)}:Reflect.get(n,r,i)}}));return t.current=Object.assign(t.current,e),t.current}var Fe=function(e){var t,n=e.className,r=n===void 0?"":n,i=e.disabled,o=i===void 0?!1:i,a=e.children,u=e.forceReRender,c=u===void 0?[]:u,l=Nt(e,["className","disabled","children","forceReRender"]),d=o?{opacity:.38}:{},p="".concat(r," ").concat(o?"paypal-buttons-disabled":"").trim(),f=m.useRef(null),v=m.useRef(null),x=Tr(l),N=Or()[0],_=N.isResolved,y=N.options,L=m.useState(null),w=L[0],k=L[1],h=m.useState(!0),P=h[0],I=h[1],F=m.useState(null),j=F[1];function R(){v.current!==null&&v.current.close().catch(function(){})}return!((t=v.current)===null||t===void 0)&&t.updateProps&&v.current.updateProps({message:l.message}),m.useEffect(function(){if(_===!1)return R;var B=Ar(y.dataNamespace);if(B===void 0||B.Buttons===void 0)return j(function(){throw new Error(Pr({reactComponentName:Fe.displayName,sdkComponentKey:"buttons",sdkRequestedComponents:y.components,sdkDataNamespace:y[z.DATA_NAMESPACE]}))}),R;var q=function(E,Y){k(Y),typeof l.onInit=="function"&&l.onInit(E,Y)};try{v.current=B.Buttons(O(O({},x),{onInit:q}))}catch(E){return j(function(){throw new Error("Failed to render <PayPalButtons /> component. Failed to initialize:  ".concat(E))})}return v.current.isEligible()===!1?(I(!1),R):(f.current&&v.current.render(f.current).catch(function(E){f.current===null||f.current.children.length===0||j(function(){throw new Error("Failed to render <PayPalButtons /> component. ".concat(E))})}),R)},Ze(Ze([_],c,!0),[l.fundingSource],!1)),m.useEffect(function(){w!==null&&(o===!0?w.disable().catch(function(){}):w.enable().catch(function(){}))},[o,w]),C.createElement(C.Fragment,null,P?C.createElement("div",{ref:f,style:d,className:p}):a)};Fe.displayName="PayPalButtons";function Dr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Fr(e,t){var n=document.querySelector('script[src="'.concat(e,'"]'));if(n===null)return null;var r=Pt(e,t),i=n.cloneNode();if(delete i.dataset.uidAuto,Object.keys(i.dataset).length!==Object.keys(r.dataset).length)return null;var o=!0;return Object.keys(i.dataset).forEach(function(a){i.dataset[a]!==r.dataset[a]&&(o=!1)}),o?n:null}function Lr(e){var t=e.url,n=e.attributes,r=e.onSuccess,i=e.onError,o=Pt(t,n);o.onerror=i,o.onload=r,document.head.insertBefore(o,document.head.firstElementChild)}function Mr(e){var t=e.sdkBaseUrl,n=e.environment,r=Dr(e,["sdkBaseUrl","environment"]),i=t||Vr(n),o=r,a=Object.keys(o).filter(function(l){return typeof o[l]<"u"&&o[l]!==null&&o[l]!==""}).reduce(function(l,d){var p=o[d].toString();return d=Br(d),d.substring(0,4)==="data"||d==="crossorigin"?l.attributes[d]=p:l.queryParams[d]=p,l},{queryParams:{},attributes:{}}),u=a.queryParams,c=a.attributes;return u["merchant-id"]&&u["merchant-id"].indexOf(",")!==-1&&(c["data-merchant-id"]=u["merchant-id"],u["merchant-id"]="*"),{url:"".concat(i,"?").concat(Ur(u)),attributes:c}}function Br(e){var t=function(n,r){return(r?"-":"")+n.toLowerCase()};return e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,t)}function Ur(e){var t="";return Object.keys(e).forEach(function(n){t.length!==0&&(t+="&"),t+=n+"="+e[n]}),t}function Vr(e){return e==="sandbox"?"https://www.sandbox.paypal.com/sdk/js":"https://www.paypal.com/sdk/js"}function Pt(e,t){t===void 0&&(t={});var n=document.createElement("script");return n.src=e,Object.keys(t).forEach(function(r){n.setAttribute(r,t[r]),r==="data-csp-nonce"&&n.setAttribute("nonce",t["data-csp-nonce"])}),n}function qr(e,t){if(t===void 0&&(t=Promise),It(e,t),typeof document>"u")return t.resolve(null);var n=Mr(e),r=n.url,i=n.attributes,o=i["data-namespace"]||"paypal",a=He(o);return i["data-js-sdk-library"]||(i["data-js-sdk-library"]="paypal-js"),Fr(r,i)&&a?t.resolve(a):$r({url:r,attributes:i},t).then(function(){var u=He(o);if(u)return u;throw new Error("The window.".concat(o," global variable is not available."))})}function $r(e,t){t===void 0&&(t=Promise),It(e,t);var n=e.url,r=e.attributes;if(typeof n!="string"||n.length===0)throw new Error("Invalid url.");if(typeof r<"u"&&typeof r!="object")throw new Error("Expected attributes to be an object.");return new t(function(i,o){if(typeof document>"u")return i();Lr({url:n,attributes:r,onSuccess:function(){return i()},onError:function(){var a=new Error('The script "'.concat(n,'" failed to load. Check the HTTP status code and response body in DevTools to learn more.'));return o(a)}})})}function He(e){return window[e]}function It(e,t){if(typeof e!="object"||e===null)throw new Error("Expected an options object.");var n=e.environment;if(n&&n!=="production"&&n!=="sandbox")throw new Error('The `environment` option must be either "production" or "sandbox".');if(typeof t<"u"&&typeof t!="function")throw new Error("Expected PromisePonyfill to be a function.")}var Wr=function(e){var t,n=e.options,r=n===void 0?{clientId:"test"}:n,i=e.children,o=e.deferLoading,a=o===void 0?!1:o,u=m.useReducer(Rr,{options:O(O({},r),(t={},t[z.DATA_JS_SDK_LIBRARY]=z.DATA_LIBRARY_VALUE,t[z.DATA_SDK_INTEGRATION_SOURCE]=z.DATA_LIBRARY_VALUE,t[ae]="".concat(At(r)),t)),loadingStatus:a?U.INITIAL:U.PENDING}),c=u[0],l=u[1];return m.useEffect(function(){if(a===!1&&c.loadingStatus===U.INITIAL)return l({type:J.LOADING_STATUS,value:U.PENDING});if(c.loadingStatus===U.PENDING){var d=!0;return qr(c.options).then(function(){d&&l({type:J.LOADING_STATUS,value:U.RESOLVED})}).catch(function(p){console.error("".concat(Nr," ").concat(p)),d&&l({type:J.LOADING_STATUS,value:{state:U.REJECTED,message:String(p)}})}),function(){d=!1}}},[c.options,a,c.loadingStatus]),C.createElement(wt.Provider,{value:O(O({},c),{dispatch:l})},i)};function et(){}m.createContext({cardFieldsForm:null,fields:{},registerField:et,unregisterField:et});function Gr({cart:e}){const t=Mt(),{paymentProviders:n}=G(),[r,i]=m.useState(null),[o,a]=m.useState(e),u=m.useMemo(()=>n==null?void 0:n.some(f=>{var v;return(v=f.id)==null?void 0:v.includes("paypal")}),[n]),c=m.useMemo(()=>({clientId:"AUvtGlVenK_bQoUrek0Nl43oRCDETrBjP2ZlhRQcdBuJp1Pt16gSaitZV3aXAhUFIIQBGY29PqKhncLq",components:"buttons",intent:"capture",currency:(o.currency_code||"USD").toUpperCase()}),[o.currency_code]);if(m.useEffect(()=>{a(e)},[e]),!o||!u)return null;const l=(o.total||0).toFixed(2),d={borderRadius:10},p=async(f,v)=>{var x,N,_,y,L,w,k,h,P,I,F,j,R,B,q,E,Y,M,pe,K,H,ee;try{if(!(v!=null&&v.order))return;const $=await v.order.capture(),b=$==null?void 0:$.payer,Se=(x=$==null?void 0:$.purchase_units)==null?void 0:x[0],g=Se==null?void 0:Se.shipping,Le=((N=g==null?void 0:g.name)==null?void 0:N.full_name)||`${((_=b==null?void 0:b.name)==null?void 0:_.given_name)??""} ${((y=b==null?void 0:b.name)==null?void 0:y.surname)??""}`,me=Le.trim().split(" "),Rt={firstName:me[0]??"",lastName:me.slice(1).join(" ")??"",address1:((L=g==null?void 0:g.address)==null?void 0:L.address_line_1)??"",address2:((w=g==null?void 0:g.address)==null?void 0:w.address_line_2)??"",city:((k=g==null?void 0:g.address)==null?void 0:k.admin_area_2.toLowerCase())??"",province:((h=g==null?void 0:g.address)==null?void 0:h.admin_area_1.toLowerCase())??"",postalCode:((P=g==null?void 0:g.address)==null?void 0:P.postal_code)??"",countryCode:(((I=g==null?void 0:g.address)==null?void 0:I.country_code)??"").toLowerCase(),phone:((j=(F=b==null?void 0:b.phone)==null?void 0:F.phone_number)==null?void 0:j.national_number)??""},kt={firstName:((R=b==null?void 0:b.name)==null?void 0:R.given_name)??me[0]??"",lastName:((B=b==null?void 0:b.name)==null?void 0:B.surname)??me.slice(1).join(" ")??"",address1:((q=g==null?void 0:g.address)==null?void 0:q.address_line_1)??"",address2:((E=g==null?void 0:g.address)==null?void 0:E.address_line_2)??"",city:((Y=g==null?void 0:g.address)==null?void 0:Y.admin_area_2.toLowerCase())??"",province:((M=g==null?void 0:g.address)==null?void 0:M.admin_area_1.toLowerCase())??"",postalCode:((pe=g==null?void 0:g.address)==null?void 0:pe.postal_code)??"",countryCode:(((K=g==null?void 0:g.address)==null?void 0:K.country_code)??"").toLowerCase(),phone:((ee=(H=b==null?void 0:b.phone)==null?void 0:H.phone_number)==null?void 0:ee.national_number)??"",company:Le},[Ot,Me]=await Qe.update({cartId:o.id,email:(b==null?void 0:b.email_address)??o.email??void 0,shippingAddress:Rt,billingAddress:kt,complete:!1});if(Me){i({title:"Error updating account details",description:Me.message});return}const Tt=Ot.cart,[Dt,Be]=await Qe.update({cartId:Tt.id,complete:!0});if(Be){i({title:"Payment failed",description:Be.message});return}const{order:Ue}=Dt;if(!Ue){i({title:"Payment failed",description:"Error trying to complete checkout."});return}t(`/checkout/success?order_id=${Ue.id}`)}catch($){const b=$ instanceof Error?$.message:"Error trying to submit payment.";i({title:"Payment failed",description:b})}};return s.jsxs("div",{className:"App",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Express Checkout"}),r?s.jsx(ve,{type:"error",title:r.title,className:"mt-4",children:r.description}):null,s.jsx("div",{className:"py-4",children:s.jsx(Wr,{options:c,children:s.jsx(Fe,{style:d,createOrder:(f,v)=>v.order.create({intent:"CAPTURE",purchase_units:[{amount:{currency_code:(o.currency_code||"USD").toUpperCase(),value:l}}]}),onApprove:p,onError:f=>{const v=f instanceof Error?f.message:"PayPal error";i({title:"Payment failed",description:v})}})})})]})}const Kr=()=>{const{customer:e}=Oe(),{goToNextStep:t,cart:n}=G(),r=!!(e!=null&&e.id);if(n)return m.useEffect(()=>(r&&t(),()=>t()),[r]),s.jsx(s.Fragment,{children:s.jsxs("div",{className:"lg:min-h-[calc(100vh-320px)] lg:pl-8",children:[r&&s.jsxs(ve,{type:"info",className:"mb-8",children:["Checking out as:"," ",s.jsxs("strong",{className:"font-bold",children:[e.first_name," ",e.last_name," (",e.email,")"]})]}),s.jsx(Gr,{cart:n}),s.jsx(ir,{}),s.jsx("hr",{className:"my-10"}),s.jsx(mr,{}),s.jsx(Er,{})]})})},Yr=()=>{const{step:e}=G();return s.jsx("div",{className:W("h-full",{"hidden lg:block":e===Z.PAYMENT}),children:s.jsx("div",{className:"sticky top-24",children:s.jsx(Ct,{name:"sidebar"})})})},Jr=({icon:e,title:t,description:n,action:r})=>s.jsxs("div",{className:"py-16 text-center",children:[e&&s.jsx("div",{className:"inline-block text-gray-300",children:s.jsx(e,{className:"h-10 w-10"})}),s.jsx("h2",{className:"mt-2 text-lg font-bold text-gray-900",children:t}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n}),r&&s.jsx("div",{className:"mt-6",children:r})]}),ps=Bt(function(){var o;const{shippingOptions:t,paymentProviders:n,activePaymentSession:r,cart:i}=Ut();return!i||!((o=i.items)!=null&&o.length)?s.jsx(Jr,{icon:sn,title:"No items in your cart.",description:"Add items to your cart",action:s.jsx(ce,{variant:"primary",as:a=>s.jsx(tt,{to:"/products",...a}),children:"Start shopping"})}):s.jsx(Cn,{data:{cart:i,activePaymentSession:r,shippingOptions:t,paymentProviders:n},children:s.jsx("section",{children:s.jsx("div",{className:"mx-auto max-w-2xl px-4 pb-8 pt-6 sm:px-6 sm:pb-16 sm:pt-8 lg:max-w-7xl lg:px-8 lg:pb-24 lg:pt-16",children:s.jsxs("div",{className:"lg:grid lg:grid-cols-[4fr_3fr] lg:gap-x-12 xl:gap-x-16",children:[s.jsx(Kr,{}),s.jsx(Yr,{})]})})})})});export{ps as default};
