import{r as l,j as c,k,f as T}from"./chunk-OIYGIGL5-DA7B83DT.js";import{e as z,u as H,a as C,F as _,c as V,i as $,f as I,g as q}from"./PlusIcon-B0nCS5Pn.js";import{m as F,I as G}from"./Image-C-YIAXD2.js";import{u as K,M as Z}from"./MorphingShape-BeQZ52ZC.js";import{c as S}from"./clsx-B-dksMZM.js";var E=(t=>(t.cart="cart",t.login="login",t.search="search",t))(E||{}),D=(t=>(t.toggle="toggle",t.set="set",t))(D||{});const L=l.createContext(null),J={set:(t,{target:e,state:r})=>({...t,[e]:F({},t[e],r)}),toggle:(t,{target:e,open:r,state:o})=>({...t,[e]:F({},t[e],o,{open:r??!t[e].open})})},Q=z({actionHandlers:J}),U={cart:{},login:{},search:{}},it=({data:t,...e})=>{const[r,o]=l.useReducer(Q,U);return c.jsx(L.Provider,{value:{state:F({},r,t),dispatch:o},...e})},y=(t,e)=>typeof e=="boolean"?{name:D.toggle,payload:{open:e,target:t}}:{name:D.toggle,payload:{...e,target:t}},W=({dispatch:t})=>({toggleCartDrawer:e=>t(y(E.cart,e)),toggleLoginModal:e=>t(y(E.login,e)),toggleSearchDrawer:e=>t(y(E.search,e))}),X=()=>{const t=l.useContext(L);if(!t)throw new Error("useStorefront must be used within a StorefrontContext.Provider");return{...t,actions:W(t)}},Y=()=>{var j,R,A,N,P;const{state:t,actions:e}=X(),r=H(),o=k(),[a,s]=l.useState(!1),i=l.useRef(null),d=l.useRef(0),u={removing:o.find(n=>{var v;return(n.state==="submitting"||n.state==="loading")&&n.key===C.cart.removeLineItem&&((v=n.formData)==null?void 0:v.get("lineItemId"))}),adding:o.filter(n=>{var v;return n.key===C.cart.createLineItem&&(n.state==="submitting"||n.state==="loading")&&((v=n.formData)==null?void 0:v.has("variantId"))})},h=r==null?void 0:r.cart,x=(h==null?void 0:h.items)||[],m=x.length;u.removing&&console.log("removing",(R=(j=u.removing)==null?void 0:j.formData)==null?void 0:R.get("lineItemId"));const g=u.adding.length>0,p=(N=(A=u.removing)==null?void 0:A.formData)==null?void 0:N.get("lineItemId"),b=p&&(m===1&&p===((P=x[0])==null?void 0:P.id)||m===0&&d.current===1&&u.removing),f=l.useCallback(()=>{i.current!==null&&(window.clearTimeout(i.current),i.current=null)},[]),w=l.useCallback(n=>{n!==!!t.cart.open&&(e.toggleCartDrawer(n),n||s(!1))},[e,t.cart.open]);l.useEffect(()=>{f();const n=!!t.cart.open;return b&&!a&&(s(!0),n&&(i.current=window.setTimeout(()=>{e.toggleCartDrawer(!1),s(!1)},1500))),d.current=m,f},[t.cart.open,m,b,a,e,f]),l.useEffect(()=>{(!t.cart.open||g)&&s(!1)},[t.cart.open,g]),l.useEffect(()=>f,[f]);const M=!g&&m===0&&!a,O=t.cart.open===!0;return{cart:h,isAddingItem:g,isRemovingItemId:p,isRemovingLastItem:a,cartDrawerOpen:O,toggleCartDrawer:w,showEmptyCartMessage:M}},tt=()=>{var r,o;const t=T({key:C.cart.createLineItem});return{addToCart:a=>{const s=new FormData;s.append("productId",a.productId),s.append("quantity",String(a.quantity||1)),a.options&&Object.entries(a.options).forEach(([i,d])=>{s.append(`options.${i}`,d)}),t.submit(s,{method:"post",action:"/api/cart/line-items/create"})},isLoading:t.state==="submitting"||t.state==="loading",error:(r=t.data)==null?void 0:r.errors,cart:(o=t.data)==null?void 0:o.cart,state:t.state}},lt=({product:t,selectedOptions:e={},quantity:r=1,disabled:o=!1,className:a,variant:s="primary",size:i="md"})=>{const{t:d}=K(),{addToCart:u,isLoading:h}=tt(),{toggleCartDrawer:x}=Y(),m=w=>{w.preventDefault(),u({productId:t.id,options:e,quantity:r}),x(!0)},g=o||h,p="font-medium rounded-[100px] transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 flex items-center p-2",b={primary:{enabled:"bg-black text-white hover:bg-gray-800 focus:ring-gray-500",disabled:"bg-gray-300 text-gray-500 cursor-not-allowed"},secondary:{enabled:"bg-white text-black border border-black hover:bg-gray-50 focus:ring-gray-500",disabled:"bg-gray-100 text-gray-400 border border-gray-300 cursor-not-allowed"}},f=S(p,g?b[s].disabled:b[s].enabled,a);return c.jsxs("button",{onClick:m,disabled:g,className:f,"aria-label":`${d("common.addToCart")} ${t.title}`,children:[c.jsx("i",{className:"w-4",children:c.jsx(_,{className:"size-1"})}),c.jsx("span",{className:"text-nowrap btn-add opacity-0 w-0 h-0 transition-all duration-300 group-hover/product-card:opacity-100 group-hover/product-card:w-auto group-hover/product-card:h-auto",children:" Add to cart"})]})},et=({variant:t,currencyCode:e})=>{const{original:r,calculated:o}=V(t),a=$(o)&&o<(r??0);return c.jsx(c.Fragment,{children:a?c.jsxs("span",{className:"inline-flex items-center gap-1",children:[c.jsx("span",{children:I(o,{currency:e})}),c.jsx("s",{className:"text-gray-400",children:I(r||0,{currency:e})})]}):I(r||0,{currency:e})})},dt=({product:t,currencyCode:e,...r})=>{const o=l.useMemo(()=>r.variant||q(t),[r.variant,t,e]);return o?c.jsx(et,{variant:o,currencyCode:e}):null},B={BLOSSOM:{colorStart:"#FFFFFF",colorEnd:"#6DCB8F",offsetStart:8.85,offsetEnd:79.19},SAFFRON:{colorStart:"#BEB1F8",colorEnd:"#8F5DDB",offsetStart:8.85,offsetEnd:79.19},HAZE:{colorStart:"#BFFAED",colorEnd:"#BBEE7C",offsetStart:8.85,offsetEnd:79.19},RICE:{colorStart:"#EEF7FF",colorEnd:"#A2D4FD",offsetStart:8.85,offsetEnd:79.19},LATTE:{colorStart:"#E4E3D8",colorEnd:"#89E4BB",offsetStart:8.85,offsetEnd:79.19},COFFEE:{colorStart:"#F5DDDD",colorEnd:"#FFB578",offsetStart:8.85,offsetEnd:79.19}},rt=(t=null)=>{const e=t?B[t]:Object.values(B),r=Array.isArray(e)?e[Math.floor(Math.random()*e.length)]:e;return{blur:20,zoom:.42,className:"flex justify-center",id:Math.random().toString(36).substring(2,15),...r}},ut=t=>{let e=t.trim();if(e.includes(" ")){const[s,...i]=e.split(/\s+/);return[s,"_"+i.join(" ")]}const r=Math.floor(e.length/2),o=e.slice(0,r),a=e.slice(r);return[o,"_"+a]},mt=({product:t,className:e,isTransitioning:r,classNameImage:o,isRemoveStyleDefault:a=!1,...s})=>{const i=t.images&&t.images[0]&&t.images[0].url||t.thumbnail,d=t.images&&t.images[1]&&t.images[1].url;return c.jsxs("figure",{className:S("product-thumbnail overflow-hidden",!a&&"aspect-w-1 aspect-h-1 w-full",e),style:{viewTransitionName:r?"product-thumbnail":void 0},...s,children:[c.jsx(Z,{...rt(t.subtitle)}),i?c.jsx(G,{loading:"lazy",src:i,alt:t.title,className:S("h-full w-full object-cover object-center transition-all duration-300 -rotate-[14deg]",{"group-hover/product-card:opacity-75":!d},o)}):c.jsx("div",{className:"flex h-full w-full items-center justify-center object-cover object-center group-hover/product-card:opacity-75",children:"No Image"})]})};export{lt as A,et as P,it as S,mt as a,dt as b,ut as g,rt as r,U as s,Y as u};
