import{j as s,r as m,f as Et,h as Nt,R as b,g as H,L as Ye,a as At,w as _t,u as wt}from"./chunk-OIYGIGL5-Dqha4PIa.js";import{b as Pt,h as It,x as Rt,D as kt,M as Ot,a as z,F as Ce,A as Tt,o as Dt,s as Oe,e as Ft,c as Te,f as Lt,d as Mt,m as Bt,g as de}from"./data-table-router-form-C5avzeSv.js";import{u as Je,c as Ut,e as Vt,b as qt,F as pe,f as me}from"./prices-BOd7fUDf.js";import{B as se}from"./Button-DAWRIA4w.js";import{c as U}from"./clsx-B-dksMZM.js";import{u as $t,a as Wt,F as Gt,b as Kt}from"./ShoppingCartIcon-KBV_sxqF.js";import{o as Q,c as Yt,s as x,d as ye,e as De,b as oe}from"./zod-BUdEohrI.js";import{u as ze,a as ie,R as ae,S as Ee}from"./SubmitButton-DStrUbl4.js";import{n as Jt,Q as zt}from"./QuantitySelector-DPSbemQf.js";import{I as Qt}from"./Image-BHXbTTgt.js";import{B as Xt}from"./ButtonLink-DuBV1cLo.js";import{d as ee}from"./tabs-25V_ubya.js";import"./createLucideIcon-ZDKfE8TB.js";import"./index-C2UwRhCo.js";import"./PlusIcon-tA398x_T.js";import"./use-is-mounted-BLrle9PA.js";const ve=(e,t=new FormData,n="")=>e==null?t:typeof e=="object"&&!(e instanceof Date)&&!(e instanceof File)?(Object.entries(e).forEach(([r,i])=>{ve(i,t,n?e[r]instanceof File?n:`${n}.${r}`:r)}),t):Array.isArray(e)?(e.forEach((r,i)=>{ve(r,t,`${n}.${i}`)}),t):(t.append(n,e),t),Zt=Q({cartId:x(),shippingOptionIds:Yt(x())}),Ht=Q({cartId:x(),customerId:x().optional(),email:x().email("Please enter a valid email"),shippingAddress:Q({firstName:x().min(1,"First name is required"),lastName:x().min(1,"Last name is required"),company:x().optional(),address1:x().min(1,"Address is required"),address2:x().optional(),city:x().min(1,"City is required"),province:x().min(1,"Province is required"),countryCode:x().min(1,"Country is required"),postalCode:x().min(1,"Postal code is required"),phone:x().optional()}),shippingAddressId:x(),isExpressCheckout:ye().optional()}),en=Q({lineItemId:x().min(1,"Line item ID is required"),quantity:Jt().int()}),tn=Q({cartId:x(),code:x().min(1,"Discount code is required")});function nn(e){const{control:t}=ze(),{components:n,...r}=e,i={FormDescription:Ot,FormControl:kt,FormLabel:Rt,FormMessage:It,...n};return s.jsx(Pt,{control:t,components:i,...r})}const xe={firstName:"",lastName:"",company:"",address1:"",address2:"",city:"",province:"",postalCode:"",countryCode:"",phone:""},Ne=e=>e?{...xe,firstName:(e==null?void 0:e.first_name)||"",lastName:(e==null?void 0:e.last_name)||"",company:(e==null?void 0:e.company)||"",address1:(e==null?void 0:e.address_1)||"",address2:(e==null?void 0:e.address_2)||"",city:(e==null?void 0:e.city)||"",countryCode:(e==null?void 0:e.country_code)||"",phone:(e==null?void 0:e.phone)||"",postalCode:(e==null?void 0:e.postal_code)||"",province:(e==null?void 0:e.province)||""}:xe,Ae=e=>{const t=e.reduce((n,r)=>{const i=r.shipping_profile_id;return i&&(n[i]||(n[i]=[]),n[i].push(r)),n},{});return Object.keys(t).forEach(n=>t[n].sort((r,i)=>(r.amount||0)-(i.amount||0))),t},rn=(e,t)=>!!e.email||!!(t!=null&&t.email),_e=e=>{var t;return!!((t=e.shipping_address)!=null&&t.address_1)},sn=(e,t)=>{var i;const n=((i=e.shipping_methods)==null?void 0:i.map(o=>o.shipping_option_id))||[],r=Ae(t);return Object.values(r).every(o=>o.find(a=>n.includes(a.id)))};function on(e){if((e==null?void 0:e.length)<1)return 0;const t=Ae(e);return Object.values(t).reduce((n,r)=>{const i=r.reduce((o,a)=>(o.amount||0)<((a==null?void 0:a.amount)||0)?o:a);return n+(i.amount||0)},0)}const an=Q({firstName:x().min(1,"First name is required").optional(),lastName:x().min(1,"Last name is required").optional(),company:x().optional(),address1:x().min(1,"Address is required").optional(),address2:x().optional(),city:x().min(1,"City is required").optional(),province:x().min(1,"Province is required").optional(),countryCode:x().min(1,"Country is required"),postalCode:x().min(1,"Postal code is required"),phone:x().optional()}),cn=Q({cartId:x(),providerId:x(),paymentMethodId:x(),sameAsShipping:ye().optional(),billingAddress:De(),noRedirect:ye().optional()}).refine(e=>e.sameAsShipping?De():an.safeParse(e.billingAddress).success,{message:"Valid billing address is required when creating a new address",path:["root"]}),we=()=>{const e=Je();return{customer:e==null?void 0:e.customer}};var K=(e=>(e.CONTACT_INFO="contactInfo",e.ACCOUNT_DETAILS="accountDetails",e.PAYMENT="payment",e.SUCCESS="success",e))(K||{});const Qe=e=>{const{cart:t}=e,{customer:n}=we(),r=!!(n!=null&&n.id),i=m.useMemo(()=>rn(t,n),[t,n]),o=m.useMemo(()=>_e(t),[t,r]);let a="accountDetails";return i&&(a="accountDetails"),o&&(a="payment"),a},Xe=m.createContext(null),ln={setStep:(e,t)=>({...e,step:t})},un=Ut({actionHandlers:ln}),dn=({data:e,...t})=>{const r={step:Qe({...e}),cart:null,shippingOptions:[],paymentProviders:[],activePaymentSession:null},[i,o]=m.useReducer(un,r);return s.jsx(Xe.Provider,{value:{state:{...i,...e},dispatch:o},...t})},pn=({dispatch:e})=>({setStep:t=>e({name:"setStep",payload:t})}),V=()=>{const e=m.useContext(Xe),t=Qe(e.state),{state:n}=e,i=Et().filter(o=>o.key.startsWith(Vt));if(!n.step)throw new Error("useCheckout must be used within a CheckoutProvider");return{...n,...pn(e),goToNextStep:()=>e.dispatch({name:"setStep",payload:t}),isCartMutating:i.some(o=>["loading","submitting"].includes(o.state))}},be=({className:e,name:t,...n})=>s.jsx(z,{...n,className:U("[&_input]:!h-12 [&_input]:border-gray-200 [&_input]:!bg-white [&_input]:text-[16px] [&_input]:shadow-sm [&_input]:!ring-0","[&_input:-webkit-autofill]:!transition-[background-color_5000s_ease-in-out_0s]","[&_input:-webkit-autofill]:!shadow-[0_0_0_1000px_white_inset]","[&_label]:text-[16px] [&_label]:text-gray-600",e),name:t});function mn({title:e,titleId:t,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?m.createElement("title",{id:t},e):null,m.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const fn=m.forwardRef(mn),Ze=({completed:e,setStep:t,step:n,children:r})=>s.jsxs("header",{className:"relative flex items-center justify-between",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r}),e&&s.jsxs(s.Fragment,{children:[s.jsx(se,{className:"text-sm",variant:"link",onClick:()=>t(n),children:"Edit"}),s.jsx("span",{className:"absolute -left-10 mt-0.5 hidden h-6 w-6 items-center justify-center rounded-full bg-green-100 text-green-700 md:flex",children:s.jsx(fn,{className:"h-4 w-4"})})]})]}),He=({address:e,prefix:t})=>s.jsx(s.Fragment,{children:Object.keys(e).map(n=>{const r=n;if(e[r]!=null)return s.jsx(z,{type:"hidden",name:`${t}.${n}`,value:e[r]??""},r)})}),Pe=()=>{const e=Je();if(!(e!=null&&e.env))throw new Error("No env data found, this should be provided in the root loader");return{env:e==null?void 0:e.env}};var et={exports:{}},hn="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",gn=hn,yn=gn;function tt(){}function nt(){}nt.resetWarningCache=tt;var vn=function(){function e(r,i,o,a,u,c){if(c!==yn){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:nt,resetWarningCache:tt};return n.PropTypes=n,n};et.exports=vn();var xn=et.exports;const N=Nt(xn);function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fe(Object(n),!0).forEach(function(r){rt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ue(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ue=function(t){return typeof t}:ue=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(e)}function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function st(e,t){return bn(e)||Sn(e,t)||jn(e,t)||Cn()}function bn(e){if(Array.isArray(e))return e}function Sn(e,t){var n=e&&(typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"]);if(n!=null){var r=[],i=!0,o=!1,a,u;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(r.push(a.value),!(t&&r.length===t));i=!0);}catch(c){o=!0,u=c}finally{try{!i&&n.return!=null&&n.return()}finally{if(o)throw u}}return r}}function jn(e,t){if(e){if(typeof e=="string")return Me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Me(e,t)}}function Me(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var B=function(t,n,r){var i=!!r,o=b.useRef(r);b.useEffect(function(){o.current=r},[r]),b.useEffect(function(){if(!i||!t)return function(){};var a=function(){o.current&&o.current.apply(o,arguments)};return t.on(n,a),function(){t.off(n,a)}},[i,n,t,o])},Se=function(t){var n=b.useRef(t);return b.useEffect(function(){n.current=t},[t]),n.current},Z=function(t){return t!==null&&ue(t)==="object"},En=function(t){return Z(t)&&typeof t.then=="function"},Nn=function(t){return Z(t)&&typeof t.elements=="function"&&typeof t.createToken=="function"&&typeof t.createPaymentMethod=="function"&&typeof t.confirmCardPayment=="function"},Be="[object Object]",An=function e(t,n){if(!Z(t)||!Z(n))return t===n;var r=Array.isArray(t),i=Array.isArray(n);if(r!==i)return!1;var o=Object.prototype.toString.call(t)===Be,a=Object.prototype.toString.call(n)===Be;if(o!==a)return!1;if(!o&&!r)return t===n;var u=Object.keys(t),c=Object.keys(n);if(u.length!==c.length)return!1;for(var l={},d=0;d<u.length;d+=1)l[u[d]]=!0;for(var p=0;p<c.length;p+=1)l[c[p]]=!0;var h=Object.keys(l);if(h.length!==u.length)return!1;var S=t,g=n,v=function(f){return e(S[f],g[f])};return h.every(v)},ot=function(t,n,r){return Z(t)?Object.keys(t).reduce(function(i,o){var a=!Z(n)||!An(t[o],n[o]);return r.includes(o)?(a&&console.warn("Unsupported prop change: options.".concat(o," is not a mutable property.")),i):a?Le(Le({},i||{}),{},rt({},o,t[o])):i},null):null},it="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",Ue=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:it;if(t===null||Nn(t))return t;throw new Error(n)},_n=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:it;if(En(t))return{tag:"async",stripePromise:Promise.resolve(t).then(function(i){return Ue(i,n)})};var r=Ue(t,n);return r===null?{tag:"empty"}:{tag:"sync",stripe:r}},wn=function(t){!t||!t._registerWrapper||!t.registerAppInfo||(t._registerWrapper({name:"react-stripe-js",version:"2.7.3"}),t.registerAppInfo({name:"react-stripe-js",version:"2.7.3",url:"https://stripe.com/docs/stripe-js/react"}))},fe=b.createContext(null);fe.displayName="ElementsContext";var at=function(t,n){if(!t)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return t},Ie=function(t){var n=t.stripe,r=t.options,i=t.children,o=b.useMemo(function(){return _n(n)},[n]),a=b.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(r):null}}),u=st(a,2),c=u[0],l=u[1];b.useEffect(function(){var h=!0,S=function(v){l(function(C){return C.stripe?C:{stripe:v,elements:v.elements(r)}})};return o.tag==="async"&&!c.stripe?o.stripePromise.then(function(g){g&&h&&S(g)}):o.tag==="sync"&&!c.stripe&&S(o.stripe),function(){h=!1}},[o,c,r]);var d=Se(n);b.useEffect(function(){d!==null&&d!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[d,n]);var p=Se(r);return b.useEffect(function(){if(c.elements){var h=ot(r,p,["clientSecret","fonts"]);h&&c.elements.update(h)}},[r,p,c.elements]),b.useEffect(function(){wn(c.stripe)},[c.stripe]),b.createElement(fe.Provider,{value:c},i)};Ie.propTypes={stripe:N.any,options:N.object};var Pn=function(t){var n=b.useContext(fe);return at(n,t)},In=function(){var t=Pn("calls useElements()"),n=t.elements;return n};N.func.isRequired;var ct=b.createContext(null);ct.displayName="CustomCheckoutSdkContext";var Rn=function(t,n){if(!t)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(n," in an <CustomCheckoutProvider> provider."));return t},kn=b.createContext(null);kn.displayName="CustomCheckoutContext";N.any,N.shape({clientSecret:N.string.isRequired,elementsOptions:N.object}).isRequired;var je=function(t){var n=b.useContext(ct),r=b.useContext(fe);if(n&&r)throw new Error("You cannot wrap the part of your app that ".concat(t," in both <CustomCheckoutProvider> and <Elements> providers."));return n?Rn(n,t):at(r,t)},On=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},R=function(t,n){var r="".concat(On(t),"Element"),i=function(c){var l=c.id,d=c.className,p=c.options,h=p===void 0?{}:p,S=c.onBlur,g=c.onFocus,v=c.onReady,C=c.onChange,f=c.onEscape,_=c.onClick,A=c.onLoadError,w=c.onLoaderStart,y=c.onNetworksChange,I=c.onConfirm,O=c.onCancel,D=c.onShippingAddressChange,j=c.onShippingRateChange,T=je("mounts <".concat(r,">")),M="elements"in T?T.elements:null,$="customCheckoutSdk"in T?T.customCheckoutSdk:null,E=b.useState(null),Y=st(E,2),F=Y[0],Ct=Y[1],W=b.useRef(null),he=b.useRef(null);B(F,"blur",S),B(F,"focus",g),B(F,"escape",f),B(F,"click",_),B(F,"loaderror",A),B(F,"loaderstart",w),B(F,"networkschange",y),B(F,"confirm",I),B(F,"cancel",O),B(F,"shippingaddresschange",D),B(F,"shippingratechange",j),B(F,"change",C);var ge;v&&(t==="expressCheckout"?ge=v:ge=function(){v(F)}),B(F,"ready",ge),b.useLayoutEffect(function(){if(W.current===null&&he.current!==null&&(M||$)){var q=null;$?q=$.createElement(t,h):M&&(q=M.create(t,h)),W.current=q,Ct(q),q&&q.mount(he.current)}},[M,$,h]);var ke=Se(h);return b.useEffect(function(){if(W.current){var q=ot(h,ke,["paymentRequest"]);q&&W.current.update(q)}},[h,ke]),b.useLayoutEffect(function(){return function(){if(W.current&&typeof W.current.destroy=="function")try{W.current.destroy(),W.current=null}catch{}}},[]),b.createElement("div",{id:l,className:d,ref:he})},o=function(c){je("mounts <".concat(r,">"));var l=c.id,d=c.className;return b.createElement("div",{id:l,className:d})},a=n?o:i;return a.propTypes={id:N.string,className:N.string,onChange:N.func,onBlur:N.func,onFocus:N.func,onReady:N.func,onEscape:N.func,onClick:N.func,onLoadError:N.func,onLoaderStart:N.func,onNetworksChange:N.func,onConfirm:N.func,onCancel:N.func,onShippingAddressChange:N.func,onShippingRateChange:N.func,options:N.object},a.displayName=r,a.__elementType=t,a},k=typeof window>"u",Tn=b.createContext(null);Tn.displayName="EmbeddedCheckoutProviderContext";var Dn=function(){var t=je("calls useStripe()"),n=t.stripe;return n};R("auBankAccount",k);R("card",k);R("cardNumber",k);R("cardExpiry",k);R("cardCvc",k);R("fpxBank",k);R("iban",k);R("idealBank",k);R("p24Bank",k);R("epsBank",k);var Fn=R("payment",k);R("expressCheckout",k);R("paymentRequestButton",k);R("linkAuthentication",k);var Ln=R("address",k);R("shippingAddress",k);R("paymentMethodMessaging",k);R("affirmMessage",k);R("afterpayClearpayMessage",k);var lt="https://js.stripe.com/v3",Mn=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var Bn=function(){for(var t=document.querySelectorAll('script[src^="'.concat(lt,'"]')),n=0;n<t.length;n++){var r=t[n];if(Mn.test(r.src))return r}return null},Ve=function(t){var n="",r=document.createElement("script");r.src="".concat(lt).concat(n);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(r),r},Un=function(t,n){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:n})},te=null,ce=null,le=null,Vn=function(t){return function(){t(new Error("Failed to load Stripe.js"))}},qn=function(t,n){return function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))}},$n=function(t){return te!==null?te:(te=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var i=Bn();if(!(i&&t)){if(!i)i=Ve(t);else if(i&&le!==null&&ce!==null){var o;i.removeEventListener("load",le),i.removeEventListener("error",ce),(o=i.parentNode)===null||o===void 0||o.removeChild(i),i=Ve(t)}}le=qn(n,r),ce=Vn(r),i.addEventListener("load",le),i.addEventListener("error",ce)}catch(a){r(a);return}}),te.catch(function(n){return te=null,Promise.reject(n)}))},Wn=function(t,n,r){if(t===null)return null;var i=t.apply(void 0,n);return Un(i,r),i},ne,ut=!1,dt=function(){return ne||(ne=$n(null).catch(function(t){return ne=null,Promise.reject(t)}),ne)};Promise.resolve().then(function(){return dt()}).catch(function(e){ut||console.warn(e)});var pt=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];ut=!0;var i=Date.now();return dt().then(function(o){return Wn(o,n,i)})};const Gn=e=>({address:{firstName:(e==null?void 0:e.first_name)||"",lastName:(e==null?void 0:e.last_name)||"",address1:(e==null?void 0:e.address_1)||"",address2:(e==null?void 0:e.address_2)||"",province:(e==null?void 0:e.province)||"",city:(e==null?void 0:e.city)||"",countryCode:(e==null?void 0:e.country_code)||"us",postalCode:(e==null?void 0:e.postal_code)||"",phone:(e==null?void 0:e.phone)||""},completed:!1}),mt=({title:e,address:t,mode:n,allowedCountries:r=[],setAddress:i})=>{var d;const{env:o}=Pe(),{cart:a}=V(),{region:u}=qt(),c=p=>{var C,f;const h=((C=p.value.name)==null?void 0:C.split(" "))||[],S=h.slice(0,-1).join(" "),g=h.slice(-1).join(" "),v=p.complete&&!p.value.address.state;i({address:{firstName:p.value.firstName||S||"",lastName:p.value.lastName||g||"",address1:p.value.address.line1,address2:p.value.address.line2??"",province:v?"-":p.value.address.state,city:p.value.address.city,countryCode:(f=p.value.address.country)==null?void 0:f.toLowerCase(),postalCode:p.value.address.postal_code,phone:p.value.phone??""},completed:p.complete})},l=m.useMemo(()=>o.STRIPE_PUBLIC_KEY?pt(o.STRIPE_PUBLIC_KEY):null,[o.STRIPE_PUBLIC_KEY]);return a?s.jsxs("div",{children:[e&&s.jsx("h3",{className:"mt-6 text-sm",children:e}),s.jsx(Ie,{stripe:l,options:{mode:"setup",currency:u.currency_code,appearance:{variables:{borderRadius:"6px",spacingUnit:"4.601px",fontSizeBase:"16px",colorText:"#374151",fontWeightNormal:"400",fontWeightBold:"700",fontSizeSm:"16px"},rules:{".Input":{fontSize:"1rem",color:"#000000"},".Input:focus":{boxShadow:"inset 0 0 0 1px rgba(210, 213, 218, 1)"},".Label":{FontWeight:"700"}}}},children:s.jsx(Ln,{options:{mode:n,allowedCountries:r,display:{name:"split"},fields:{phone:"always"},validation:{phone:{required:"always"}},defaultValues:{address:{line1:t.address1,line2:t.address2,city:t.city,state:t.province,postal_code:t.postalCode,country:((d=t.countryCode)==null?void 0:d.toUpperCase())||"us"},phone:t.phone,firstName:t.firstName,lastName:t.lastName}},onChange:c})})]}):null},ft=({title:e,address:t,countryOptions:n})=>{var r;return s.jsxs("span",{children:[e&&s.jsx("dt",{className:"mt-6 text-sm font-bold text-gray-700",children:e}),s.jsxs("dd",{className:"mt-0.5",children:[(t==null?void 0:t.company)&&s.jsxs(s.Fragment,{children:[t==null?void 0:t.company,s.jsx("br",{})]}),t==null?void 0:t.address1,s.jsx("br",{}),(t==null?void 0:t.address2)&&s.jsxs(s.Fragment,{children:[t==null?void 0:t.address2,s.jsx("br",{})]}),t==null?void 0:t.city,", ",t==null?void 0:t.province," ",t==null?void 0:t.postalCode,s.jsx("br",{}),(t==null?void 0:t.countryCode)&&s.jsxs(s.Fragment,{children:[(r=n.find(({value:i})=>i===(t==null?void 0:t.countryCode)))==null?void 0:r.label,s.jsx("br",{})]})]})]})},Kn=(e,t)=>{var r,i,o;return e.shipping_address?e.shipping_address:!t||!((r=t==null?void 0:t.addresses)!=null&&r.length)?null:(t!=null&&t.default_shipping_address_id?(i=t.addresses)==null?void 0:i.find(a=>a.id===(t==null?void 0:t.default_shipping_address_id)):(o=t==null?void 0:t.addresses)==null?void 0:o[0])||null},Yn="new",Jn=()=>{var I,O,D;const e=H({key:pe.cart.accountDetails}),{customer:t}=we(),{regions:n}=$t(),{step:r,setStep:i,goToNextStep:o,cart:a,isCartMutating:u}=V(),c=r===K.ACCOUNT_DETAILS;if(!a)return null;const l=(n??[]).flatMap(j=>j.countries.map(T=>T.iso_2)),d=Kn(a,t),p=_e(a),h=["submitting","loading"].includes(e.state),S=!!((I=e.data)!=null&&I.errors),g=(d==null?void 0:d.id)??Yn,v=((D=(O=a.region)==null?void 0:O.countries)==null?void 0:D.map(j=>({value:j.iso_2,label:j.display_name})))??[],C={cartId:a.id,email:(t==null?void 0:t.email)||a.email||"",customerId:t==null?void 0:t.id,allowSuggestions:!0,shippingAddress:{...Ne(d)},shippingAddressId:g},f=ie({resolver:oe(Ht),defaultValues:C,fetcher:e,submitConfig:{method:"post",action:"/api/checkout/account-details"}}),_=j=>{f.setValue("shippingAddress.address1",j.address.address1??""),f.setValue("shippingAddress.address2",j.address.address2??""),f.setValue("shippingAddress.city",j.address.city??""),f.setValue("shippingAddress.province",j.address.province??""),f.setValue("shippingAddress.countryCode",j.address.countryCode??""),f.setValue("shippingAddress.postalCode",j.address.postalCode??""),f.setValue("shippingAddress.phone",j.address.phone??""),f.setValue("shippingAddress.firstName",j.address.firstName??""),f.setValue("shippingAddress.lastName",j.address.lastName??""),f.setValue("shippingAddress.company",j.address.company??""),f.setValue("shippingAddress.phone",j.address.phone??"")},A=f.watch("shippingAddress");m.useEffect(()=>{c&&!h&&!S&&p&&(f.reset(),o())},[h,p]);const w=()=>{o()},y=p&&!c;return s.jsxs("div",{className:"checkout-account-details",children:[s.jsx(Ze,{completed:y,setStep:i,step:K.ACCOUNT_DETAILS,children:"Account details"}),!c&&p&&s.jsx(ft,{title:"Shipping Address",address:A,countryOptions:v}),c&&s.jsxs(s.Fragment,{children:[t!=null&&t.email?s.jsx("p",{className:"mt-2 text-sm mb-2",children:"To get started, please select your shipping address."}):s.jsx("p",{className:"mt-2 text-sm mb-4",children:"To get started, enter your email address."}),s.jsx(ae,{...f,children:s.jsxs(e.Form,{id:"checkout-account-details-form",onSubmit:f.handleSubmit,children:[s.jsx(z,{type:"hidden",name:"cartId"}),s.jsx(z,{type:"hidden",name:"customerId"}),s.jsx(be,{name:"email",type:"email",autoComplete:"email",placeholder:"Email address",label:"Email Address",className:"[&_input]:!ring-0 mb-2"}),s.jsx(He,{address:A,prefix:"shippingAddress"}),s.jsx(be,{type:"hidden",name:"shippingAddressId",value:g}),s.jsx(mt,{mode:"shipping",address:A,allowedCountries:l,setAddress:_}),s.jsx(Ce,{}),s.jsxs(Tt,{children:[s.jsx(Ee,{disabled:h||u,children:h?"Saving...":"Save and continue"}),p&&s.jsx(se,{disabled:h,onClick:w,children:"Cancel edit"})]})]})})]})]})},zn="/assets/StripeBadge-D70kF_jj.png",Qn=({className:e})=>s.jsx("img",{className:e,width:320,src:zn,alt:"stripe security badge"});Dt({page:Te.number().int().min(0).default(0),pageSize:Te.number().int().min(1).default(10),sortField:Oe().optional(),sortOrder:Ft(["asc","desc"]).default("asc"),dataTableSearch:Oe().optional()}).passthrough();const Xn=({shippingOption:e,region:t,value:n})=>{const r=n===e.id;return s.jsx("div",{className:"relative col-span-1",children:s.jsx("label",{htmlFor:e.id,className:"",children:s.jsxs("div",{className:U("group relative flex h-full flex-col justify-between rounded-lg border bg-white p-4 shadow-sm","active:ring-primary-500 hover:border-gray-400 focus:outline-none active:ring-2",r?"border-transparent":"border-gray-300"),children:[s.jsxs("div",{className:"flex justify-between gap-1",children:[s.jsx("div",{className:"block text-sm font-bold text-gray-900",children:e.name}),s.jsx(Lt,{id:e.id,value:e.id,className:"text-primary-600 h-5 w-5 border-0",indicator:s.jsx(Mt,{className:"text-primary-600 h-5 w-5","aria-hidden":"true"})})]}),s.jsx("div",{className:"mt-6 flex items-end justify-between text-sm text-gray-500",children:s.jsx("div",{children:me(e.amount,{currency:t.currency_code})})}),s.jsx("div",{className:U("pointer-events-none absolute -inset-px rounded-lg border-2 active:border",r?"border-primary-500":"border-transparent"),"aria-hidden":"true"})]})})})},Zn=({name:e,shippingOptions:t,region:n,value:r,onValueChange:i,disabled:o})=>{const a=ze(),u=a.formState.isSubmitting,c=async l=>{if(!u){i==null||i(l);try{await a.handleSubmit()}catch(d){console.error("Failed to submit shipping option:",d)}}};return t.length?s.jsx(Bt,{name:e,value:r??"",onValueChange:c,className:U("xs:grid-cols-2 my-6 grid grid-cols-1 gap-4",u&&"pointer-events-none"),disabled:u||o,children:t.map(l=>s.jsx(Xn,{shippingOption:l,region:n},l.id))}):s.jsx("div",{children:"No shipping options available"})},Hn=(e,t)=>{var r;const n=((r=e.shipping_methods)==null?void 0:r.map(i=>i.shipping_option_id))??[];return Object.values(t).reduce((i,o)=>{const a=o.find(u=>n.includes(u.id));return i.push(a?a.id:o[0].id),i},[])},er=(e,t)=>({cartId:e.id,shippingOptionIds:Hn(e,t)}),tr=()=>{var f,_,A;const e=H(),{step:t,shippingOptions:n,setStep:r,goToNextStep:i,cart:o,isCartMutating:a}=V(),u=t===K.PAYMENT,c=["submitting","loading"].includes(e.state);if(!o)return null;const l=!!((f=e.data)!=null&&f.errors),d=_e(o),p=m.useMemo(()=>Ae(n),[n]),h=m.useMemo(()=>sn(o,n),[o,n]),S=m.useMemo(()=>er(o,p),[o,p]),g=ie({resolver:oe(Zt),defaultValues:S,fetcher:e,submitConfig:{method:"post",action:"/api/checkout/shipping-methods"}}),v=g.watch("shippingOptionIds");m.useEffect(()=>{var w;g.setValue("shippingOptionIds",((w=o.shipping_methods)==null?void 0:w.map(y=>y.shipping_option_id))??[])},[o.shipping_methods]),m.useEffect(()=>{u&&!c&&!l&&h&&i()},[c,h]);const C=!u&&d;return s.jsxs("div",{className:"checkout-delivery-method",children:[s.jsx(Ze,{completed:C,setStep:r,step:K.PAYMENT,children:"Delivery & Payment"}),!u&&s.jsxs(s.Fragment,{children:[((_=o.shipping_methods)==null?void 0:_.length)===0&&s.jsx(Qn,{className:"mt-4"}),s.jsx("dl",{children:(A=o.shipping_methods)==null?void 0:A.map((w,y)=>{var T;const{id:I,shipping_option_id:O,amount:D}=w,j=n.find(M=>M.id===O);return s.jsxs(m.Fragment,{children:[s.jsx("dt",{className:`${y>0?"mt-6":"mt-4"} text-sm font-bold text-gray-700`,children:"Delivery method for: All items"}),s.jsxs("dd",{className:"mt-0.5",children:[j==null?void 0:j.name," (",me(D,{currency:(T=o==null?void 0:o.region)==null?void 0:T.currency_code}),")"]})]},I)})})]}),u&&s.jsx(ae,{...g,children:s.jsxs(e.Form,{children:[s.jsx(z,{type:"hidden",name:"cartId",value:o.id}),Object.entries(p).map(([w,y],I)=>{var O;return y.length<1?null:s.jsxs(m.Fragment,{children:[I>0&&s.jsx("hr",{className:"my-6"}),!!((O=o==null?void 0:o.shipping_methods)!=null&&O.length)&&s.jsx(de,{type:"info",className:"my-6",children:"Choose your delivery option"}),s.jsx(Zn,{disabled:a,name:`shippingOptionIds.${I}`,shippingOptions:y,region:o.region,value:(v==null?void 0:v[I])??null,onValueChange:D=>g.setValue(`shippingOptionIds.${I}`,D)})]},w)})]})})]})},nr=({formId:e,item:t,className:n,maxInventory:r=10,...i})=>{const o=H({key:pe.cart.updateLineItem}),a=["submitting","loading"].includes(o.state),u=ie({resolver:oe(en),defaultValues:{lineItemId:t.id,quantity:t.quantity.toString()},fetcher:o,submitConfig:{method:"post",action:"/api/cart/line-items/update"}}),c=l=>{o.submit({lineItemId:t.id,quantity:l},{method:"post",action:"/api/cart/line-items/update"})};return s.jsx(ae,{...u,children:s.jsx(o.Form,{id:e,className:U("line-item-quantity-select",n),...i,onSubmit:u.handleSubmit,children:s.jsx(zt,{formId:e,className:U({"pointer-events-none opacity-50":a}),variant:t.variant,onChange:c})})})},rr=({item:e,name:t})=>{var a,u,c;const{cart:n}=V(),r=Wt(),i=()=>r.submit(e),o=["loading","submitting"].includes(r.state);return n?s.jsxs("li",{className:"flex px-4 py-6 sm:px-6",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Qt,{src:((u=(a=e.variant)==null?void 0:a.product)==null?void 0:u.thumbnail)||"",alt:e.product_title||"product thumbnail",className:"w-20 rounded-md"})}),s.jsxs("div",{className:"ml-6 flex flex-1 flex-col",children:[s.jsxs("div",{className:"flex",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h4",{className:"text-base",children:s.jsx(Ye,{to:`/products/${e.product_handle}`,className:"font-bold text-gray-700 hover:text-gray-800",children:e.product_title})}),s.jsx("p",{className:"mt-0.5 text-sm text-gray-500",children:e.variant_title})]}),s.jsx("div",{className:"ml-4 flow-root flex-shrink-0",children:s.jsx(se,{variant:"link",onClick:i,disabled:o,className:"text-sm",children:o?"Removing":"Remove"})})]}),s.jsxs("div",{className:"flex flex-1 items-end justify-between pt-2",children:[s.jsx("div",{className:"mr-4",children:s.jsx(nr,{formId:`quantity-${t}-${e.id}`,item:e})}),s.jsx("p",{className:"mt-1 text-lg",children:s.jsx("span",{className:"font-bold text-gray-900",children:me(e.unit_price,{currency:(c=n.region)==null?void 0:c.currency_code})})})]})]})]}):null},sr=({cart:e,name:t})=>{var n;return s.jsx("ul",{role:"list",className:"divide-y divide-gray-200",children:(n=e.items)==null?void 0:n.map(r=>s.jsx(rr,{item:r,name:t},r.id))})},or=({cart:e,promotion:t})=>{const n=H({key:pe.cart.removePromotionCode});return["submitting","loading"].includes(n.state)?null:s.jsxs(n.Form,{method:"post",action:"/api/checkout/remove-discount-code",children:[s.jsx("input",{type:"hidden",name:"cartId",value:e.id}),s.jsx("input",{type:"hidden",name:"code",value:t.code}),s.jsxs("button",{className:"focus:ring-primary-100 focus:border-primary-100 inline-flex h-8 items-center rounded-md border border-gray-300 bg-white px-2 text-xs font-bold text-gray-900 shadow-sm hover:bg-gray-100",children:[s.jsx("span",{children:t.code}),s.jsx("div",{className:"ml-[4px] inline-block text-gray-400",children:s.jsx(Gt,{className:"inline-block h-4 w-4 leading-none"})})]})]})},ir=({cart:e})=>{var p,h,S;const t=m.useRef(null),n=m.useRef(null),r=H(),[i,o]=m.useState(!!e.promotions.length),a=!!((p=e.promotions)!=null&&p.length),u=Object.keys(((h=r.data)==null?void 0:h.errors)||{}).length>0,c=["submitting","loading"].includes(r.state),l=ie({resolver:oe(tn),defaultValues:{cartId:e.id,code:""},fetcher:r,submitConfig:{method:"post",action:"/api/checkout/discount-code"}});m.useEffect(()=>{var g;!c&&!u&&(l.reset(),(g=n.current)==null||g.focus())},[c,u]);const d=()=>{o(!0),setTimeout(()=>{var g;return(g=n.current)==null?void 0:g.focus()},0)};return s.jsxs("div",{className:"mb-6",children:[!i&&s.jsx("div",{children:s.jsx(Xt,{size:"sm",onClick:d,children:"Add promo code"})}),i&&s.jsxs(s.Fragment,{children:[s.jsx(ae,{...l,children:s.jsxs(r.Form,{ref:t,onSubmit:l.handleSubmit,children:[s.jsx("input",{type:"hidden",name:"cartId",value:e.id}),s.jsxs("div",{className:"!my-0 !flex items-start gap-1",children:[s.jsx(be,{name:"code",className:"flex-grow",placeholder:"Discount code","aria-label":"discount code"}),s.jsx(Ee,{type:"submit",className:"flex-shrink-0 flex-grow-0",disabled:c,children:c?"Applying...":"Apply"})]}),s.jsx(Ce,{})]})}),a&&s.jsx("div",{className:"mt-2",children:(S=e.promotions)==null?void 0:S.map(g=>s.jsx(or,{cart:e,promotion:g},g.id))})]})]})},X=({label:e,amount:t,className:n,region:r})=>s.jsxs("div",{className:U("flex items-center justify-between text-sm",n),children:[s.jsx("dt",{children:e}),s.jsx("dd",{className:"font-bold text-gray-900",children:me(t||0,{currency:r==null?void 0:r.currency_code})})]}),ar=({shippingOptions:e,cart:t})=>{const r=(t.shipping_methods||[]).length>0,i=on(e),o=t.discount_total??0,a=t.shipping_total??0,u=t.total??0,c=r?u:u+i;return s.jsxs("div",{className:"border-t border-gray-200 px-4 py-6 sm:px-6",children:[s.jsx(ir,{cart:t}),s.jsxs("dl",{className:"flex flex-col gap-2",children:[s.jsx(X,{label:"Subtotal",amount:t.item_subtotal,region:t.region}),o>0&&s.jsx(X,{label:"Discount",amount:-o,region:t.region}),r&&s.jsx(X,{label:"Shipping",amount:a,region:t.region}),!r&&s.jsx(X,{label:"Estimated Shipping",amount:i,region:t.region}),s.jsx(X,{label:"Taxes",amount:t.tax_total,region:t.region}),s.jsx(X,{label:"Total",amount:c,className:"border-t border-gray-200 pt-6 !text-xl",region:t.region})]})]})},ht=({submitButton:e,name:t})=>{const{shippingOptions:n,cart:r}=V();return r?s.jsxs("div",{className:"my-0 rounded-lg border border-gray-200 bg-white shadow-sm",children:[s.jsx("h3",{className:"sr-only",children:"Items in your cart"}),s.jsx(sr,{cart:r,name:t}),s.jsx(ar,{cart:r,shippingOptions:n}),e&&s.jsx("div",{className:"border-t border-gray-200 p-4 sm:p-6",children:e})]}):null},gt=({id:e,submitMessage:t,onSubmit:n,paymentMethods:r,children:i,providerId:o,className:a})=>{var M,$;const{activePaymentSession:u,cart:c,isCartMutating:l}=V(),d=H({key:pe.cart.completeCheckout}),[p,h]=m.useState(!1),S=["submitting","loading"].includes(d.state)||p,g=r.filter(E=>E.provider_id===o),v=g.length>0,C=v?g[0].data.id:"new";if(!c)return null;const f=Ne(c.billing_address),_=Gn(c==null?void 0:c.shipping_address)??xe,A=(($=(M=c.region)==null?void 0:M.countries)==null?void 0:$.map(E=>({value:E.iso_2,label:E.display_name})))??[],w={cartId:c.id,paymentMethodId:C,sameAsShipping:!0,billingAddress:f,providerId:o},y=ie({resolver:oe(cn),defaultValues:w,fetcher:d,submitConfig:{method:"post",action:"/api/checkout/complete"}}),I=y.watch("sameAsShipping"),O=y.watch("billingAddress"),D=async E=>{E.preventDefault(),h(!0);const Y=y.getValues();return typeof n=="function"?await n(Y,E,{setSubmitting:h,submit:()=>y.handleSubmit()}):y.handleSubmit()},j=E=>{y.setValue("billingAddress.address1",E.address.address1??""),y.setValue("billingAddress.address2",E.address.address2??""),y.setValue("billingAddress.city",E.address.city??""),y.setValue("billingAddress.province",E.address.province??""),y.setValue("billingAddress.countryCode",E.address.countryCode??""),y.setValue("billingAddress.postalCode",E.address.postalCode??""),y.setValue("billingAddress.phone",E.address.phone??""),y.setValue("billingAddress.firstName",E.address.firstName??""),y.setValue("billingAddress.lastName",E.address.lastName??""),y.setValue("billingAddress.company",E.address.company??""),y.setValue("billingAddress.phone",E.address.phone??"")},T=()=>s.jsx(Ee,{form:e,className:"w-full lg:w-auto",disabled:S||l||!I&&!O,children:S?"Confirming...":t??"Confirm & Pay"});return u?s.jsx(s.Fragment,{children:s.jsxs(ae,{...y,children:[s.jsxs(d.Form,{id:e,onSubmit:D,className:a,children:[s.jsx(z,{type:"hidden",name:"cartId",value:c.id}),s.jsx(z,{type:"hidden",name:"providerId",value:o}),s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Billing address"}),s.jsx(nn,{className:"my-4",name:"sameAsShipping",label:"Same as shipping address"}),!I&&s.jsx(mt,{mode:"billing",address:O,setAddress:j}),s.jsx(He,{address:O,prefix:"billingAddress"}),I&&s.jsx("div",{className:"-mt-2 mb-4",children:s.jsx(ft,{address:_.address,countryOptions:A})}),!v&&s.jsx("input",{type:"hidden",name:"paymentMethodId",value:"new"}),s.jsx("div",{className:`stripe-payment-form ${C!=="new"?"hidden":""}`,children:i}),s.jsx(Ce,{})]}),s.jsx("div",{className:"block lg:hidden",children:s.jsx(ht,{name:"checkout",submitButton:s.jsx(T,{})})}),s.jsx("div",{className:"hidden lg:block",children:s.jsx(T,{})})]})}):null},cr=e=>s.jsx(gt,{providerId:"pp_system_default",id:"TestPaymentForm",submitMessage:"Checkout using Test Payment",className:"mt-4",...e}),lr=({options:e,children:t})=>{var u,c;const{env:n}=Pe(),{cart:r}=V(),i=m.useMemo(()=>n.STRIPE_PUBLIC_KEY?pt(n.STRIPE_PUBLIC_KEY):null,[]),o=m.useMemo(()=>{var l,d;return(d=(l=r==null?void 0:r.payment_collection)==null?void 0:l.payment_sessions)==null?void 0:d.find(p=>p.provider_id==="pp_stripe_stripe")},[(u=r==null?void 0:r.payment_collection)==null?void 0:u.payment_sessions]),a=(c=o==null?void 0:o.data)==null?void 0:c.client_secret;return!o||!i||!a?null:s.jsx(Ie,{stripe:i,options:e??{clientSecret:a},children:t},a)},ur=({isActiveStep:e,paymentMethods:t})=>{var v,C;const[n,r]=m.useState(),[i,o]=m.useState(),a=Dn(),u=In(),{activePaymentSession:c,cart:l}=V(),d=m.useMemo(()=>t==null?void 0:t.filter(f=>f.provider_id==="pp_stripe_stripe"),[t]);m.useEffect(()=>{u&&u.fetchUpdates()},[(v=c==null?void 0:c.payment)==null?void 0:v.updated_at]);const p=d.length>0,h=p?(C=d[0].data)==null?void 0:C.id:"new";if(m.useEffect(()=>{e&&n&&n.focus()},[e,n]),!l||!a||!u)return null;const S=async(f,_,{setSubmitting:A,submit:w})=>{if(o(void 0),f.paymentMethodId!=="new"){w(_.target);return}const y=f.sameAsShipping?Ne(l.billing_address):f.billingAddress,I={name:`${y.firstName} ${y.lastName}`,email:l.email,phone:y.phone||"",address:{line1:y.address1||"",line2:y.address2||"",city:y.city||"",state:y.province||"",postal_code:y.postalCode||"",country:y.countryCode||""}};return A(!0),a.confirmPayment({elements:u,confirmParams:{return_url:`${window.location.origin}/checkout/success`,payment_method_data:{billing_details:I}},redirect:"if_required"}).then(({paymentIntent:O,error:D})=>{if(D){o(D.message),A(!1),n==null||n.focus();return}w(_.target)}).catch(O=>{A(!1),console.error(O)})},g=f=>{r(f)};return s.jsx(s.Fragment,{children:s.jsx(gt,{providerId:"pp_stripe_stripe",id:"stripePaymentForm",paymentMethods:d,onSubmit:S,children:s.jsxs("div",{className:U({"h-0 overflow-hidden opacity-0":p&&h!=="new"}),children:[s.jsx(Fn,{onReady:g,className:"my-6 w-full",options:{fields:{billingDetails:{address:{country:"never",postalCode:"never"}}},terms:{card:"never"}}}),i&&s.jsx(de,{type:"error",className:U("form__error -mt-4 mb-2"),children:i})]})})})},dr=e=>{const{isActiveStep:t,...n}=e;return s.jsx(lr,{children:s.jsx(ur,{...n,isActiveStep:t})})},pr=()=>{const{env:e}=Pe(),{step:t,paymentProviders:n,cart:r}=V(),i=t===K.PAYMENT;if(!r)return null;const o=m.useMemo(()=>n==null?void 0:n.some(l=>l.id.includes("pp_stripe_stripe")),[n]),a=m.useMemo(()=>!!(n!=null&&n.some(l=>l.id.includes("pp_system_default"))),[n]),u=[{id:"pp_stripe_stripe",label:"Credit Card",component:dr,isActive:o},{id:"pp_system_default",label:"Test Payment",component:cr,isActive:a&&e.NODE_ENV==="development"}],c=m.useMemo(()=>u.filter(l=>l.isActive),[u]);return s.jsx("div",{className:"checkout-payment",children:s.jsx("div",{className:U({"h-0 overflow-hidden opacity-0":!i}),children:s.jsxs(ee.Group,{children:[c.length>1&&s.jsx(ee.List,{className:"bg-primary-50 mb-2 mt-6 inline-flex gap-0.5 rounded-full p-2",children:c.map((l,d)=>s.jsx(ee,{as:se,className:({selected:p})=>U("!rounded-full",{"!bg-white !text-gray-700 shadow-sm":p,"!bg-primary-50 !border-primary-100 !text-primary-600 hover:!text-primary-800 hover:!bg-primary-100 !border-none":!p}),children:l.label},l.id))}),s.jsx(ee.Panels,{children:c.map(l=>{const d=l.component;return s.jsx(ee.Panel,{children:s.jsx(d,{isActiveStep:i,paymentMethods:[]})},l.id)})})]})})})},qe={update:async e=>{const t=await fetch("/api/checkout/express",{method:"POST",body:ve(e)});return t.ok?[await t.json(),null]:[null,new Error("Failed to update shipping address")]}};/*!
 * react-paypal-js v8.9.2 (2025-10-02T20:17:55.069Z)
 * Copyright 2020-present, PayPal, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var L;(function(e){e.INITIAL="initial",e.PENDING="pending",e.REJECTED="rejected",e.RESOLVED="resolved"})(L||(L={}));var G;(function(e){e.LOADING_STATUS="setLoadingStatus",e.RESET_OPTIONS="resetOptions",e.SET_BRAINTREE_INSTANCE="braintreeInstance"})(G||(G={}));var $e;(function(e){e.NUMBER="number",e.CVV="cvv",e.EXPIRATION_DATE="expirationDate",e.EXPIRATION_MONTH="expirationMonth",e.EXPIRATION_YEAR="expirationYear",e.POSTAL_CODE="postalCode"})($e||($e={}));var P=function(){return P=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},P.apply(this,arguments)};function yt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function We(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var re="data-react-paypal-script-id",J={DATA_JS_SDK_LIBRARY:"dataJsSdkLibrary",DATA_LIBRARY_VALUE:"react-paypal-js",DATA_NAMESPACE:"dataNamespace",DATA_SDK_INTEGRATION_SOURCE:"dataSdkIntegrationSource"},mr="Failed to load the PayPal JS SDK script.",vt="paypal",fr="usePayPalScriptReducer must be used within a PayPalScriptProvider";function hr(e){return e===void 0&&(e=vt),window[e]}function gr(e){for(var t="",n=0;n<e.length;n++){var r=e[n].charCodeAt(0)*n;e[n+1]&&(r+=e[n+1].charCodeAt(0)*(n-1)),t+=String.fromCharCode(97+Math.abs(r)%26)}return t}function yr(e){var t=e.reactComponentName,n=e.sdkComponentKey,r=e.sdkRequestedComponents,i=r===void 0?"":r,o=e.sdkDataNamespace,a=o===void 0?vt:o,u=n.charAt(0).toUpperCase().concat(n.substring(1)),c="Unable to render <".concat(t," /> because window.").concat(a,".").concat(u," is undefined."),l=typeof i=="string"?i:i.join(",");if(!l.includes(n)){var d=[l,n].filter(Boolean).join();c+=`
To fix the issue, add '`.concat(n,"' to the list of components passed to the parent PayPalScriptProvider:")+"\n`<PayPalScriptProvider options={{ components: '".concat(d,"'}}>`.")}return c}function xt(e){var t=e,n=re;t[n];var r=yt(t,[n+""]);return"react-paypal-js-".concat(gr(JSON.stringify(r)))}function vr(e){var t=self.document.querySelector("script[".concat(re,'="').concat(e,'"]'));t!=null&&t.parentNode&&t.parentNode.removeChild(t)}function xr(e,t){var n,r;switch(t.type){case G.LOADING_STATUS:return typeof t.value=="object"?P(P({},e),{loadingStatus:t.value.state,loadingStatusErrorMessage:t.value.message}):P(P({},e),{loadingStatus:t.value});case G.RESET_OPTIONS:return vr(e.options[re]),P(P({},e),{loadingStatus:L.PENDING,options:P(P((n={},n[J.DATA_SDK_INTEGRATION_SOURCE]=J.DATA_LIBRARY_VALUE,n),t.value),(r={},r[re]="".concat(xt(t.value)),r))});case G.SET_BRAINTREE_INSTANCE:return P(P({},e),{braintreePayPalCheckoutInstance:t.value});default:return e}}var bt=m.createContext(null);function br(e){if(typeof(e==null?void 0:e.dispatch)=="function"&&e.dispatch.length!==0)return e;throw new Error(fr)}function Sr(){var e=br(m.useContext(bt)),t=P(P({},e),{isInitial:e.loadingStatus===L.INITIAL,isPending:e.loadingStatus===L.PENDING,isResolved:e.loadingStatus===L.RESOLVED,isRejected:e.loadingStatus===L.REJECTED});return[t,e.dispatch]}m.createContext({});function jr(e){var t=m.useRef(new Proxy({},{get:function(n,r,i){return typeof n[r]=="function"?function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return n[r].apply(n,o)}:Reflect.get(n,r,i)}}));return t.current=Object.assign(t.current,e),t.current}var Re=function(e){var t,n=e.className,r=n===void 0?"":n,i=e.disabled,o=i===void 0?!1:i,a=e.children,u=e.forceReRender,c=u===void 0?[]:u,l=yt(e,["className","disabled","children","forceReRender"]),d=o?{opacity:.38}:{},p="".concat(r," ").concat(o?"paypal-buttons-disabled":"").trim(),h=m.useRef(null),S=m.useRef(null),g=jr(l),v=Sr()[0],C=v.isResolved,f=v.options,_=m.useState(null),A=_[0],w=_[1],y=m.useState(!0),I=y[0],O=y[1],D=m.useState(null),j=D[1];function T(){S.current!==null&&S.current.close().catch(function(){})}return!((t=S.current)===null||t===void 0)&&t.updateProps&&S.current.updateProps({message:l.message}),m.useEffect(function(){if(C===!1)return T;var M=hr(f.dataNamespace);if(M===void 0||M.Buttons===void 0)return j(function(){throw new Error(yr({reactComponentName:Re.displayName,sdkComponentKey:"buttons",sdkRequestedComponents:f.components,sdkDataNamespace:f[J.DATA_NAMESPACE]}))}),T;var $=function(E,Y){w(Y),typeof l.onInit=="function"&&l.onInit(E,Y)};try{S.current=M.Buttons(P(P({},g),{onInit:$}))}catch(E){return j(function(){throw new Error("Failed to render <PayPalButtons /> component. Failed to initialize:  ".concat(E))})}return S.current.isEligible()===!1?(O(!1),T):(h.current&&S.current.render(h.current).catch(function(E){h.current===null||h.current.children.length===0||j(function(){throw new Error("Failed to render <PayPalButtons /> component. ".concat(E))})}),T)},We(We([C],c,!0),[l.fundingSource],!1)),m.useEffect(function(){A!==null&&(o===!0?A.disable().catch(function(){}):A.enable().catch(function(){}))},[o,A]),b.createElement(b.Fragment,null,I?b.createElement("div",{ref:h,style:d,className:p}):a)};Re.displayName="PayPalButtons";function Cr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Er(e,t){var n=document.querySelector('script[src="'.concat(e,'"]'));if(n===null)return null;var r=St(e,t),i=n.cloneNode();if(delete i.dataset.uidAuto,Object.keys(i.dataset).length!==Object.keys(r.dataset).length)return null;var o=!0;return Object.keys(i.dataset).forEach(function(a){i.dataset[a]!==r.dataset[a]&&(o=!1)}),o?n:null}function Nr(e){var t=e.url,n=e.attributes,r=e.onSuccess,i=e.onError,o=St(t,n);o.onerror=i,o.onload=r,document.head.insertBefore(o,document.head.firstElementChild)}function Ar(e){var t=e.sdkBaseUrl,n=e.environment,r=Cr(e,["sdkBaseUrl","environment"]),i=t||Pr(n),o=r,a=Object.keys(o).filter(function(l){return typeof o[l]<"u"&&o[l]!==null&&o[l]!==""}).reduce(function(l,d){var p=o[d].toString();return d=_r(d),d.substring(0,4)==="data"||d==="crossorigin"?l.attributes[d]=p:l.queryParams[d]=p,l},{queryParams:{},attributes:{}}),u=a.queryParams,c=a.attributes;return u["merchant-id"]&&u["merchant-id"].indexOf(",")!==-1&&(c["data-merchant-id"]=u["merchant-id"],u["merchant-id"]="*"),{url:"".concat(i,"?").concat(wr(u)),attributes:c}}function _r(e){var t=function(n,r){return(r?"-":"")+n.toLowerCase()};return e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,t)}function wr(e){var t="";return Object.keys(e).forEach(function(n){t.length!==0&&(t+="&"),t+=n+"="+e[n]}),t}function Pr(e){return e==="sandbox"?"https://www.sandbox.paypal.com/sdk/js":"https://www.paypal.com/sdk/js"}function St(e,t){t===void 0&&(t={});var n=document.createElement("script");return n.src=e,Object.keys(t).forEach(function(r){n.setAttribute(r,t[r]),r==="data-csp-nonce"&&n.setAttribute("nonce",t["data-csp-nonce"])}),n}function Ir(e,t){if(t===void 0&&(t=Promise),jt(e,t),typeof document>"u")return t.resolve(null);var n=Ar(e),r=n.url,i=n.attributes,o=i["data-namespace"]||"paypal",a=Ge(o);return i["data-js-sdk-library"]||(i["data-js-sdk-library"]="paypal-js"),Er(r,i)&&a?t.resolve(a):Rr({url:r,attributes:i},t).then(function(){var u=Ge(o);if(u)return u;throw new Error("The window.".concat(o," global variable is not available."))})}function Rr(e,t){t===void 0&&(t=Promise),jt(e,t);var n=e.url,r=e.attributes;if(typeof n!="string"||n.length===0)throw new Error("Invalid url.");if(typeof r<"u"&&typeof r!="object")throw new Error("Expected attributes to be an object.");return new t(function(i,o){if(typeof document>"u")return i();Nr({url:n,attributes:r,onSuccess:function(){return i()},onError:function(){var a=new Error('The script "'.concat(n,'" failed to load. Check the HTTP status code and response body in DevTools to learn more.'));return o(a)}})})}function Ge(e){return window[e]}function jt(e,t){if(typeof e!="object"||e===null)throw new Error("Expected an options object.");var n=e.environment;if(n&&n!=="production"&&n!=="sandbox")throw new Error('The `environment` option must be either "production" or "sandbox".');if(typeof t<"u"&&typeof t!="function")throw new Error("Expected PromisePonyfill to be a function.")}var kr=function(e){var t,n=e.options,r=n===void 0?{clientId:"test"}:n,i=e.children,o=e.deferLoading,a=o===void 0?!1:o,u=m.useReducer(xr,{options:P(P({},r),(t={},t[J.DATA_JS_SDK_LIBRARY]=J.DATA_LIBRARY_VALUE,t[J.DATA_SDK_INTEGRATION_SOURCE]=J.DATA_LIBRARY_VALUE,t[re]="".concat(xt(r)),t)),loadingStatus:a?L.INITIAL:L.PENDING}),c=u[0],l=u[1];return m.useEffect(function(){if(a===!1&&c.loadingStatus===L.INITIAL)return l({type:G.LOADING_STATUS,value:L.PENDING});if(c.loadingStatus===L.PENDING){var d=!0;return Ir(c.options).then(function(){d&&l({type:G.LOADING_STATUS,value:L.RESOLVED})}).catch(function(p){console.error("".concat(mr," ").concat(p)),d&&l({type:G.LOADING_STATUS,value:{state:L.REJECTED,message:String(p)}})}),function(){d=!1}}},[c.options,a,c.loadingStatus]),b.createElement(bt.Provider,{value:P(P({},c),{dispatch:l})},i)};function Ke(){}m.createContext({cardFieldsForm:null,fields:{},registerField:Ke,unregisterField:Ke});function Or({cart:e}){const t=At(),{paymentProviders:n,step:r}=V(),[i,o]=m.useState(null),[a,u]=m.useState(e),c=r===K.PAYMENT,l=m.useMemo(()=>n==null?void 0:n.some(g=>{var v;return(v=g.id)==null?void 0:v.includes("paypal")}),[n]),d=m.useMemo(()=>({clientId:"AUvtGlVenK_bQoUrek0Nl43oRCDETrBjP2ZlhRQcdBuJp1Pt16gSaitZV3aXAhUFIIQBGY29PqKhncLq",components:"buttons",intent:"capture",currency:(a.currency_code||"USD").toUpperCase()}),[a.currency_code]);if(m.useEffect(()=>{u(e)},[e]),!a||!l)return null;const p={borderRadius:10},h=async()=>{var _,A,w;const[g,v]=await qe.update({cartId:a.id,complete:!1});if(v)return o({title:"Error updating account details",description:v.message}),"";const f=(A=(_=g.cart.payment_collection)==null?void 0:_.payment_sessions)==null?void 0:A[0];return((w=f==null?void 0:f.data)==null?void 0:w.id)||""},S=async(g,v)=>{try{if(!(v!=null&&v.order))return;const[C,f]=await qe.update({cartId:a.id,complete:!0});if(f){o({title:"Payment failed",description:f.message});return}const{order:_}=C;if(!_){o({title:"Payment failed",description:"Error trying to complete checkout."});return}t(`/checkout/success?order_id=${_.id}`)}catch(C){const f=C instanceof Error?C.message:"Error trying to submit payment.";o({title:"Payment failed",description:f})}};return s.jsxs("div",{className:U("App",!c&&"hidden"),children:[i?s.jsx(de,{type:"error",title:i.title,className:"mt-4",children:i.description}):null,s.jsx("div",{className:"py-4 relative z-0",children:s.jsx(kr,{options:d,children:s.jsx(Re,{style:p,createOrder:h,onApprove:S,onError:g=>{const v=g instanceof Error?g.message:"PayPal error";o({title:"Payment failed",description:v})}})})})]})}const Tr=()=>{const{customer:e}=we(),{goToNextStep:t,cart:n}=V(),r=!!(e!=null&&e.id);if(n)return m.useEffect(()=>(r&&t(),()=>t()),[r]),s.jsx(s.Fragment,{children:s.jsxs("div",{className:"lg:min-h-[calc(100vh-320px)] lg:pl-8",children:[r&&s.jsxs(de,{type:"info",className:"mb-8",children:["Checking out as:"," ",s.jsxs("strong",{className:"font-bold",children:[e.first_name," ",e.last_name," (",e.email,")"]})]}),s.jsx(Jn,{}),s.jsx("hr",{className:"my-10"}),s.jsx(tr,{}),s.jsx(Or,{cart:n}),s.jsx(pr,{})]})})},Dr=()=>{const{step:e}=V();return s.jsx("div",{className:U("h-full",{"hidden lg:block":e===K.PAYMENT}),children:s.jsx("div",{className:"sticky top-24",children:s.jsx(ht,{name:"sidebar"})})})},Fr=({icon:e,title:t,description:n,action:r})=>s.jsxs("div",{className:"py-16 text-center",children:[e&&s.jsx("div",{className:"inline-block text-gray-300",children:s.jsx(e,{className:"h-10 w-10"})}),s.jsx("h2",{className:"mt-2 text-lg font-bold text-gray-900",children:t}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n}),r&&s.jsx("div",{className:"mt-6",children:r})]}),Hr=_t(function(){var o;const{shippingOptions:t,paymentProviders:n,activePaymentSession:r,cart:i}=wt();return!i||!((o=i.items)!=null&&o.length)?s.jsx(Fr,{icon:Kt,title:"No items in your cart.",description:"Add items to your cart",action:s.jsx(se,{variant:"primary",as:a=>s.jsx(Ye,{to:"/products",...a}),children:"Start shopping"})}):s.jsx(dn,{data:{cart:i,activePaymentSession:r,shippingOptions:t,paymentProviders:n},children:s.jsx("section",{children:s.jsx("div",{className:"mx-auto max-w-2xl px-4 pb-8 pt-6 sm:px-6 sm:pb-16 sm:pt-8 lg:max-w-7xl lg:px-8 lg:pb-24 lg:pt-16",children:s.jsxs("div",{className:"lg:grid lg:grid-cols-[4fr_3fr] lg:gap-x-12 xl:gap-x-16",children:[s.jsx(Tr,{}),s.jsx(Dr,{})]})})})})});export{Hr as default};
