import{r as m,j as o,f as dt,h as pt,R as y,g as ne,a as mt,L as Ue,w as ft,u as ht}from"./chunk-OIYGIGL5-DwAmQ0ss.js";import{a as H,F as Me,A as vt,o as gt,s as Ee,e as yt,c as Ne,f as xt,b as bt,m as St,d as ve}from"./data-table-router-form-CkcVdATv.js";import{u as qe,c as jt,e as Ct,b as Et,F as ge,f as ie}from"./prices-CbSl8Vzg.js";import{B as ae}from"./Button-CD5SaSlX.js";import{c as M}from"./clsx-B-dksMZM.js";import{u as Nt,a as At,F as wt,b as _t}from"./ShoppingCartIcon-CtqyQGRu.js";import{o as ee,c as Rt,s as E,d as It,b as ce}from"./zod-HdK7eP7T.js";import{a as le,R as ue,S as Ve,u as Pt}from"./SubmitButton-CaoY3KQG.js";import{I as Ot}from"./Image-LXxd3KYB.js";import{n as kt,Q as Tt}from"./QuantitySelector-S6ImSQ9T.js";import{B as Dt}from"./ButtonLink-C2zR5Z3r.js";import"./createLucideIcon-B4KlhTzx.js";import"./index-BBGT89su.js";import"./PlusIcon-Btf11K4w.js";const me=(t,e=new FormData,n="")=>t==null?e:typeof t=="object"&&!(t instanceof Date)&&!(t instanceof File)?(Object.entries(t).forEach(([r,i])=>{me(i,e,n?t[r]instanceof File?n:`${n}.${r}`:r)}),e):Array.isArray(t)?(t.forEach((r,i)=>{me(r,e,`${n}.${i}`)}),e):(e.append(n,t),e),Ft=ee({cartId:E(),shippingOptionIds:Rt(E())}),Lt=ee({cartId:E(),customerId:E().optional(),email:E().email("Please enter a valid email"),shippingAddress:ee({firstName:E().min(1,"First name is required"),lastName:E().min(1,"Last name is required"),company:E().optional(),address1:E().min(1,"Address is required"),address2:E().optional(),city:E().min(1,"City is required"),province:E().min(1,"Province is required"),countryCode:E().min(1,"Country is required"),postalCode:E().min(1,"Postal code is required"),phone:E().optional()}),shippingAddressId:E(),isExpressCheckout:It().optional()}),Bt=ee({lineItemId:E().min(1,"Line item ID is required"),quantity:kt().int()}),Ut=ee({cartId:E(),code:E().min(1,"Discount code is required")}),Ae={firstName:"",lastName:"",company:"",address1:"",address2:"",city:"",province:"",postalCode:"",countryCode:"",phone:""},Mt=t=>t?{...Ae,firstName:(t==null?void 0:t.first_name)||"",lastName:(t==null?void 0:t.last_name)||"",company:(t==null?void 0:t.company)||"",address1:(t==null?void 0:t.address_1)||"",address2:(t==null?void 0:t.address_2)||"",city:(t==null?void 0:t.city)||"",countryCode:(t==null?void 0:t.country_code)||"",phone:(t==null?void 0:t.phone)||"",postalCode:(t==null?void 0:t.postal_code)||"",province:(t==null?void 0:t.province)||""}:Ae,ye=t=>{const e=t.reduce((n,r)=>{const i=r.shipping_profile_id;return i&&(n[i]||(n[i]=[]),n[i].push(r)),n},{});return Object.keys(e).forEach(n=>e[n].sort((r,i)=>(r.amount||0)-(i.amount||0))),e},qt=(t,e)=>!!t.email||!!(e!=null&&e.email),xe=t=>{var e;return!!((e=t.shipping_address)!=null&&e.address_1)},Vt=(t,e)=>{var i;const n=((i=t.shipping_methods)==null?void 0:i.map(s=>s.shipping_option_id))||[],r=ye(e);return Object.values(r).every(s=>s.find(a=>n.includes(a.id)))};function Wt(t){if((t==null?void 0:t.length)<1)return 0;const e=ye(t);return Object.values(e).reduce((n,r)=>{const i=r.reduce((s,a)=>(s.amount||0)<((a==null?void 0:a.amount)||0)?s:a);return n+(i.amount||0)},0)}const be=()=>{const t=qe();return{customer:t==null?void 0:t.customer}};var K=(t=>(t.CONTACT_INFO="contactInfo",t.ACCOUNT_DETAILS="accountDetails",t.PAYMENT="payment",t.SUCCESS="success",t))(K||{});const We=t=>{const{cart:e}=t,{customer:n}=be(),r=!!(n!=null&&n.id),i=m.useMemo(()=>qt(e,n),[e,n]),s=m.useMemo(()=>xe(e),[e,r]);let a="accountDetails";return i&&(a="accountDetails"),s&&(a="payment"),a},$e=m.createContext(null),$t={setStep:(t,e)=>({...t,step:e})},Gt=jt({actionHandlers:$t}),Kt=({data:t,...e})=>{const r={step:We({...t}),cart:null,shippingOptions:[],paymentProviders:[],activePaymentSession:null},[i,s]=m.useReducer(Gt,r);return o.jsx($e.Provider,{value:{state:{...i,...t},dispatch:s},...e})},Yt=({dispatch:t})=>({setStep:e=>t({name:"setStep",payload:e})}),W=()=>{const t=m.useContext($e),e=We(t.state),{state:n}=t,i=dt().filter(s=>s.key.startsWith(Ct));if(!n.step)throw new Error("useCheckout must be used within a CheckoutProvider");return{...n,...Yt(t),goToNextStep:()=>t.dispatch({name:"setStep",payload:e}),isCartMutating:i.some(s=>["loading","submitting"].includes(s.state))}},fe=({className:t,name:e,...n})=>o.jsx(H,{...n,className:M("[&_input]:!h-12 [&_input]:border-gray-200 [&_input]:!bg-white [&_input]:text-[16px] [&_input]:shadow-sm [&_input]:!ring-0","[&_input:-webkit-autofill]:!transition-[background-color_5000s_ease-in-out_0s]","[&_input:-webkit-autofill]:!shadow-[0_0_0_1000px_white_inset]","[&_label]:text-[16px] [&_label]:text-gray-600",t),name:e});function Jt({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const zt=m.forwardRef(Jt),Ge=({completed:t,setStep:e,step:n,children:r})=>o.jsxs("header",{className:"relative flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r}),t&&o.jsxs(o.Fragment,{children:[o.jsx(ae,{className:"text-sm",variant:"link",onClick:()=>e(n),children:"Edit"}),o.jsx("span",{className:"absolute -left-10 mt-0.5 hidden h-6 w-6 items-center justify-center rounded-full bg-green-100 text-green-700 md:flex",children:o.jsx(zt,{className:"h-4 w-4"})})]})]}),Qt=({address:t,prefix:e})=>o.jsx(o.Fragment,{children:Object.keys(t).map(n=>{const r=n;if(t[r]!=null)return o.jsx(H,{type:"hidden",name:`${e}.${n}`,value:t[r]??""},r)})}),Xt=()=>{const t=qe();if(!(t!=null&&t.env))throw new Error("No env data found, this should be provided in the root loader");return{env:t==null?void 0:t.env}};var Ke={exports:{}},Zt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ht=Zt,en=Ht;function Ye(){}function Je(){}Je.resetWarningCache=Ye;var tn=function(){function t(r,i,s,a,l,c){if(c!==en){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Je,resetWarningCache:Ye};return n.PropTypes=n,n};Ke.exports=tn();var nn=Ke.exports;const S=pt(nn);function we(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function _e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?we(Object(n),!0).forEach(function(r){ze(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function se(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?se=function(e){return typeof e}:se=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(t)}function ze(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qe(t,e){return rn(t)||on(t,e)||sn(t,e)||an()}function rn(t){if(Array.isArray(t))return t}function on(t,e){var n=t&&(typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"]);if(n!=null){var r=[],i=!0,s=!1,a,l;try{for(n=n.call(t);!(i=(a=n.next()).done)&&(r.push(a.value),!(e&&r.length===e));i=!0);}catch(c){s=!0,l=c}finally{try{!i&&n.return!=null&&n.return()}finally{if(s)throw l}}return r}}function sn(t,e){if(t){if(typeof t=="string")return Re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(t,e)}}function Re(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function an(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var D=function(e,n,r){var i=!!r,s=y.useRef(r);y.useEffect(function(){s.current=r},[r]),y.useEffect(function(){if(!i||!e)return function(){};var a=function(){s.current&&s.current.apply(s,arguments)};return e.on(n,a),function(){e.off(n,a)}},[i,n,e,s])},he=function(e){var n=y.useRef(e);return y.useEffect(function(){n.current=e},[e]),n.current},z=function(e){return e!==null&&se(e)==="object"},cn=function(e){return z(e)&&typeof e.then=="function"},ln=function(e){return z(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},Ie="[object Object]",un=function t(e,n){if(!z(e)||!z(n))return e===n;var r=Array.isArray(e),i=Array.isArray(n);if(r!==i)return!1;var s=Object.prototype.toString.call(e)===Ie,a=Object.prototype.toString.call(n)===Ie;if(s!==a)return!1;if(!s&&!r)return e===n;var l=Object.keys(e),c=Object.keys(n);if(l.length!==c.length)return!1;for(var u={},p=0;p<l.length;p+=1)u[l[p]]=!0;for(var d=0;d<c.length;d+=1)u[c[d]]=!0;var h=Object.keys(u);if(h.length!==l.length)return!1;var b=e,v=n,g=function(f){return t(b[f],v[f])};return h.every(g)},Xe=function(e,n,r){return z(e)?Object.keys(e).reduce(function(i,s){var a=!z(n)||!un(e[s],n[s]);return r.includes(s)?(a&&console.warn("Unsupported prop change: options.".concat(s," is not a mutable property.")),i):a?_e(_e({},i||{}),{},ze({},s,e[s])):i},null):null},Ze="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",Pe=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ze;if(e===null||ln(e))return e;throw new Error(n)},dn=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ze;if(cn(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(i){return Pe(i,n)})};var r=Pe(e,n);return r===null?{tag:"empty"}:{tag:"sync",stripe:r}},pn=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"2.7.3"}),e.registerAppInfo({name:"react-stripe-js",version:"2.7.3",url:"https://stripe.com/docs/stripe-js/react"}))},Se=y.createContext(null);Se.displayName="ElementsContext";var mn=function(e,n){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return e},He=function(e){var n=e.stripe,r=e.options,i=e.children,s=y.useMemo(function(){return dn(n)},[n]),a=y.useState(function(){return{stripe:s.tag==="sync"?s.stripe:null,elements:s.tag==="sync"?s.stripe.elements(r):null}}),l=Qe(a,2),c=l[0],u=l[1];y.useEffect(function(){var h=!0,b=function(g){u(function(j){return j.stripe?j:{stripe:g,elements:g.elements(r)}})};return s.tag==="async"&&!c.stripe?s.stripePromise.then(function(v){v&&h&&b(v)}):s.tag==="sync"&&!c.stripe&&b(s.stripe),function(){h=!1}},[s,c,r]);var p=he(n);y.useEffect(function(){p!==null&&p!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[p,n]);var d=he(r);return y.useEffect(function(){if(c.elements){var h=Xe(r,d,["clientSecret","fonts"]);h&&c.elements.update(h)}},[r,d,c.elements]),y.useEffect(function(){pn(c.stripe)},[c.stripe]),y.createElement(Se.Provider,{value:c},i)};He.propTypes={stripe:S.any,options:S.object};S.func.isRequired;var et=y.createContext(null);et.displayName="CustomCheckoutSdkContext";var fn=function(e,n){if(!e)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(n," in an <CustomCheckoutProvider> provider."));return e},hn=y.createContext(null);hn.displayName="CustomCheckoutContext";S.any,S.shape({clientSecret:S.string.isRequired,elementsOptions:S.object}).isRequired;var Oe=function(e){var n=y.useContext(et),r=y.useContext(Se);if(n&&r)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CustomCheckoutProvider> and <Elements> providers."));return n?fn(n,e):mn(r,e)},vn=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},N=function(e,n){var r="".concat(vn(e),"Element"),i=function(c){var u=c.id,p=c.className,d=c.options,h=d===void 0?{}:d,b=c.onBlur,v=c.onFocus,g=c.onReady,j=c.onChange,f=c.onEscape,_=c.onClick,w=c.onLoadError,R=c.onLoaderStart,k=c.onNetworksChange,T=c.onConfirm,F=c.onCancel,B=c.onShippingAddressChange,x=c.onShippingRateChange,I=Oe("mounts <".concat(r,">")),U="elements"in I?I.elements:null,Y="customCheckoutSdk"in I?I.customCheckoutSdk:null,$=y.useState(null),Q=Qe($,2),P=Q[0],ut=Q[1],q=y.useRef(null),de=y.useRef(null);D(P,"blur",b),D(P,"focus",v),D(P,"escape",f),D(P,"click",_),D(P,"loaderror",w),D(P,"loaderstart",R),D(P,"networkschange",k),D(P,"confirm",T),D(P,"cancel",F),D(P,"shippingaddresschange",B),D(P,"shippingratechange",x),D(P,"change",j);var pe;g&&(e==="expressCheckout"?pe=g:pe=function(){g(P)}),D(P,"ready",pe),y.useLayoutEffect(function(){if(q.current===null&&de.current!==null&&(U||Y)){var L=null;Y?L=Y.createElement(e,h):U&&(L=U.create(e,h)),q.current=L,ut(L),L&&L.mount(de.current)}},[U,Y,h]);var Ce=he(h);return y.useEffect(function(){if(q.current){var L=Xe(h,Ce,["paymentRequest"]);L&&q.current.update(L)}},[h,Ce]),y.useLayoutEffect(function(){return function(){if(q.current&&typeof q.current.destroy=="function")try{q.current.destroy(),q.current=null}catch{}}},[]),y.createElement("div",{id:u,className:p,ref:de})},s=function(c){Oe("mounts <".concat(r,">"));var u=c.id,p=c.className;return y.createElement("div",{id:u,className:p})},a=n?s:i;return a.propTypes={id:S.string,className:S.string,onChange:S.func,onBlur:S.func,onFocus:S.func,onReady:S.func,onEscape:S.func,onClick:S.func,onLoadError:S.func,onLoaderStart:S.func,onNetworksChange:S.func,onConfirm:S.func,onCancel:S.func,onShippingAddressChange:S.func,onShippingRateChange:S.func,options:S.object},a.displayName=r,a.__elementType=e,a},A=typeof window>"u",gn=y.createContext(null);gn.displayName="EmbeddedCheckoutProviderContext";N("auBankAccount",A);N("card",A);N("cardNumber",A);N("cardExpiry",A);N("cardCvc",A);N("fpxBank",A);N("iban",A);N("idealBank",A);N("p24Bank",A);N("epsBank",A);N("payment",A);N("expressCheckout",A);N("paymentRequestButton",A);N("linkAuthentication",A);var yn=N("address",A);N("shippingAddress",A);N("paymentMethodMessaging",A);N("affirmMessage",A);N("afterpayClearpayMessage",A);var tt="https://js.stripe.com/v3",xn=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var bn=function(){for(var e=document.querySelectorAll('script[src^="'.concat(tt,'"]')),n=0;n<e.length;n++){var r=e[n];if(xn.test(r.src))return r}return null},ke=function(e){var n="",r=document.createElement("script");r.src="".concat(tt).concat(n);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(r),r},Sn=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:n})},X=null,re=null,oe=null,jn=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},Cn=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},En=function(e){return X!==null?X:(X=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var i=bn();if(!(i&&e)){if(!i)i=ke(e);else if(i&&oe!==null&&re!==null){var s;i.removeEventListener("load",oe),i.removeEventListener("error",re),(s=i.parentNode)===null||s===void 0||s.removeChild(i),i=ke(e)}}oe=Cn(n,r),re=jn(r),i.addEventListener("load",oe),i.addEventListener("error",re)}catch(a){r(a);return}}),X.catch(function(n){return X=null,Promise.reject(n)}))},Nn=function(e,n,r){if(e===null)return null;var i=e.apply(void 0,n);return Sn(i,r),i},Z,nt=!1,rt=function(){return Z||(Z=En(null).catch(function(e){return Z=null,Promise.reject(e)}),Z)};Promise.resolve().then(function(){return rt()}).catch(function(t){nt||console.warn(t)});var An=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];nt=!0;var i=Date.now();return rt().then(function(s){return Nn(s,n,i)})};const wn=({title:t,address:e,mode:n,allowedCountries:r=[],setAddress:i})=>{var p;const{env:s}=Xt(),{cart:a}=W(),{region:l}=Et(),c=d=>{var j,f;const h=((j=d.value.name)==null?void 0:j.split(" "))||[],b=h.slice(0,-1).join(" "),v=h.slice(-1).join(" "),g=d.complete&&!d.value.address.state;i({address:{firstName:d.value.firstName||b||"",lastName:d.value.lastName||v||"",address1:d.value.address.line1,address2:d.value.address.line2??"",province:g?"-":d.value.address.state,city:d.value.address.city,countryCode:(f=d.value.address.country)==null?void 0:f.toLowerCase(),postalCode:d.value.address.postal_code,phone:d.value.phone??""},completed:d.complete})},u=m.useMemo(()=>s.STRIPE_PUBLIC_KEY?An(s.STRIPE_PUBLIC_KEY):null,[s.STRIPE_PUBLIC_KEY]);return a?o.jsxs("div",{children:[t&&o.jsx("h3",{className:"mt-6 text-sm",children:t}),o.jsx(He,{stripe:u,options:{mode:"setup",currency:l.currency_code,appearance:{variables:{borderRadius:"6px",spacingUnit:"4.601px",fontSizeBase:"16px",colorText:"#374151",fontWeightNormal:"400",fontWeightBold:"700",fontSizeSm:"16px"},rules:{".Input":{fontSize:"1rem",color:"#000000"},".Input:focus":{boxShadow:"inset 0 0 0 1px rgba(210, 213, 218, 1)"},".Label":{FontWeight:"700"}}}},children:o.jsx(yn,{options:{mode:n,allowedCountries:r,display:{name:"split"},fields:{phone:"always"},validation:{phone:{required:"always"}},defaultValues:{address:{line1:e.address1,line2:e.address2,city:e.city,state:e.province,postal_code:e.postalCode,country:((p=e.countryCode)==null?void 0:p.toUpperCase())||"us"},phone:e.phone,firstName:e.firstName,lastName:e.lastName}},onChange:c})})]}):null},_n=({title:t,address:e,countryOptions:n})=>{var r;return o.jsxs("span",{children:[t&&o.jsx("dt",{className:"mt-6 text-sm font-bold text-gray-700",children:t}),o.jsxs("dd",{className:"mt-0.5",children:[(e==null?void 0:e.company)&&o.jsxs(o.Fragment,{children:[e==null?void 0:e.company,o.jsx("br",{})]}),e==null?void 0:e.address1,o.jsx("br",{}),(e==null?void 0:e.address2)&&o.jsxs(o.Fragment,{children:[e==null?void 0:e.address2,o.jsx("br",{})]}),e==null?void 0:e.city,", ",e==null?void 0:e.province," ",e==null?void 0:e.postalCode,o.jsx("br",{}),(e==null?void 0:e.countryCode)&&o.jsxs(o.Fragment,{children:[(r=n.find(({value:i})=>i===(e==null?void 0:e.countryCode)))==null?void 0:r.label,o.jsx("br",{})]})]})]})},Rn=(t,e)=>{var r,i,s;return t.shipping_address?t.shipping_address:!e||!((r=e==null?void 0:e.addresses)!=null&&r.length)?null:(e!=null&&e.default_shipping_address_id?(i=e.addresses)==null?void 0:i.find(a=>a.id===(e==null?void 0:e.default_shipping_address_id)):(s=e==null?void 0:e.addresses)==null?void 0:s[0])||null},In="new",Pn=()=>{var T,F,B;const t=ne({key:ge.cart.accountDetails}),{customer:e}=be(),{regions:n}=Nt(),{step:r,setStep:i,goToNextStep:s,cart:a,isCartMutating:l}=W(),c=r===K.ACCOUNT_DETAILS;if(!a)return null;const u=(n??[]).flatMap(x=>x.countries.map(I=>I.iso_2)),p=Rn(a,e),d=xe(a),h=["submitting","loading"].includes(t.state),b=!!((T=t.data)!=null&&T.errors),v=(p==null?void 0:p.id)??In,g=((B=(F=a.region)==null?void 0:F.countries)==null?void 0:B.map(x=>({value:x.iso_2,label:x.display_name})))??[],j={cartId:a.id,email:(e==null?void 0:e.email)||a.email||"",customerId:e==null?void 0:e.id,allowSuggestions:!0,shippingAddress:{...Mt(p)},shippingAddressId:v},f=le({resolver:ce(Lt),defaultValues:j,fetcher:t,submitConfig:{method:"post",action:"/api/checkout/account-details"}}),_=x=>{f.setValue("shippingAddress.address1",x.address.address1??""),f.setValue("shippingAddress.address2",x.address.address2??""),f.setValue("shippingAddress.city",x.address.city??""),f.setValue("shippingAddress.province",x.address.province??""),f.setValue("shippingAddress.countryCode",x.address.countryCode??""),f.setValue("shippingAddress.postalCode",x.address.postalCode??""),f.setValue("shippingAddress.phone",x.address.phone??""),f.setValue("shippingAddress.firstName",x.address.firstName??""),f.setValue("shippingAddress.lastName",x.address.lastName??""),f.setValue("shippingAddress.company",x.address.company??""),f.setValue("shippingAddress.phone",x.address.phone??"")},w=f.watch("shippingAddress");m.useEffect(()=>{c&&!h&&!b&&d&&(f.reset(),s())},[h,d]);const R=()=>{s()},k=d&&!c;return o.jsxs("div",{className:"checkout-account-details",children:[o.jsx(Ge,{completed:k,setStep:i,step:K.ACCOUNT_DETAILS,children:"Account details"}),!c&&d&&o.jsx(_n,{title:"Shipping Address",address:w,countryOptions:g}),c&&o.jsxs(o.Fragment,{children:[e!=null&&e.email?o.jsx("p",{className:"mt-2 text-sm mb-2",children:"To get started, please select your shipping address."}):o.jsx("p",{className:"mt-2 text-sm mb-4",children:"To get started, enter your email address."}),o.jsx(ue,{...f,children:o.jsxs(t.Form,{id:"checkout-account-details-form",onSubmit:f.handleSubmit,children:[o.jsx(H,{type:"hidden",name:"cartId"}),o.jsx(H,{type:"hidden",name:"customerId"}),o.jsx(fe,{name:"email",type:"email",autoComplete:"email",placeholder:"Email address",label:"Email Address",className:"[&_input]:!ring-0 mb-2"}),o.jsx(Qt,{address:w,prefix:"shippingAddress"}),o.jsx(fe,{type:"hidden",name:"shippingAddressId",value:v}),o.jsx(wn,{mode:"shipping",address:w,allowedCountries:u,setAddress:_}),o.jsx(Me,{}),o.jsxs(vt,{children:[o.jsx(Ve,{disabled:h||l,children:h?"Saving...":"Save and continue"}),d&&o.jsx(ae,{disabled:h,onClick:R,children:"Cancel edit"})]})]})})]})]})},On="/assets/StripeBadge-D70kF_jj.png",kn=({className:t})=>o.jsx("img",{className:t,width:320,src:On,alt:"stripe security badge"});gt({page:Ne.number().int().min(0).default(0),pageSize:Ne.number().int().min(1).default(10),sortField:Ee().optional(),sortOrder:yt(["asc","desc"]).default("asc"),dataTableSearch:Ee().optional()}).passthrough();const Tn=({shippingOption:t,region:e,value:n})=>{const r=n===t.id;return o.jsx("div",{className:"relative col-span-1",children:o.jsx("label",{htmlFor:t.id,className:"",children:o.jsxs("div",{className:M("group relative flex h-full flex-col justify-between rounded-lg border bg-white p-4 shadow-sm","active:ring-primary-500 hover:border-gray-400 focus:outline-none active:ring-2",r?"border-transparent":"border-gray-300"),children:[o.jsxs("div",{className:"flex justify-between gap-1",children:[o.jsx("div",{className:"block text-sm font-bold text-gray-900",children:t.name}),o.jsx(xt,{id:t.id,value:t.id,className:"text-primary-600 h-5 w-5 border-0",indicator:o.jsx(bt,{className:"text-primary-600 h-5 w-5","aria-hidden":"true"})})]}),o.jsx("div",{className:"mt-6 flex items-end justify-between text-sm text-gray-500",children:o.jsx("div",{children:ie(t.amount,{currency:e.currency_code})})}),o.jsx("div",{className:M("pointer-events-none absolute -inset-px rounded-lg border-2 active:border",r?"border-primary-500":"border-transparent"),"aria-hidden":"true"})]})})})},Dn=({name:t,shippingOptions:e,region:n,value:r,onValueChange:i,disabled:s})=>{const a=Pt(),l=a.formState.isSubmitting,c=async u=>{if(!l){i==null||i(u);try{await a.handleSubmit()}catch(p){console.error("Failed to submit shipping option:",p)}}};return e.length?o.jsx(St,{name:t,value:r??"",onValueChange:c,className:M("xs:grid-cols-2 my-6 grid grid-cols-1 gap-4",l&&"pointer-events-none"),disabled:l||s,children:e.map(u=>o.jsx(Tn,{shippingOption:u,region:n},u.id))}):o.jsx("div",{children:"No shipping options available"})},Fn=(t,e)=>{var r;const n=((r=t.shipping_methods)==null?void 0:r.map(i=>i.shipping_option_id))??[];return Object.values(e).reduce((i,s)=>{const a=s.find(l=>n.includes(l.id));return i.push(a?a.id:s[0].id),i},[])},Ln=(t,e)=>({cartId:t.id,shippingOptionIds:Fn(t,e)}),Bn=()=>{var f,_,w;const t=ne(),{step:e,shippingOptions:n,setStep:r,goToNextStep:i,cart:s,isCartMutating:a}=W(),l=e===K.PAYMENT,c=["submitting","loading"].includes(t.state);if(!s)return null;const u=!!((f=t.data)!=null&&f.errors),p=xe(s),d=m.useMemo(()=>ye(n),[n]),h=m.useMemo(()=>Vt(s,n),[s,n]),b=m.useMemo(()=>Ln(s,d),[s,d]),v=le({resolver:ce(Ft),defaultValues:b,fetcher:t,submitConfig:{method:"post",action:"/api/checkout/shipping-methods"}}),g=v.watch("shippingOptionIds");m.useEffect(()=>{var R;v.setValue("shippingOptionIds",((R=s.shipping_methods)==null?void 0:R.map(k=>k.shipping_option_id))??[])},[s.shipping_methods]),m.useEffect(()=>{l&&!c&&!u&&h&&i()},[c,h]);const j=!l&&p;return o.jsxs("div",{className:"checkout-delivery-method",children:[o.jsx(Ge,{completed:j,setStep:r,step:K.PAYMENT,children:"Delivery & Payment"}),!l&&o.jsxs(o.Fragment,{children:[((_=s.shipping_methods)==null?void 0:_.length)===0&&o.jsx(kn,{className:"mt-4"}),o.jsx("dl",{children:(w=s.shipping_methods)==null?void 0:w.map((R,k)=>{var I;const{id:T,shipping_option_id:F,amount:B}=R,x=n.find(U=>U.id===F);return o.jsxs(m.Fragment,{children:[o.jsx("dt",{className:`${k>0?"mt-6":"mt-4"} text-sm font-bold text-gray-700`,children:"Delivery method for: All items"}),o.jsxs("dd",{className:"mt-0.5",children:[x==null?void 0:x.name," (",ie(B,{currency:(I=s==null?void 0:s.region)==null?void 0:I.currency_code}),")"]})]},T)})})]}),l&&o.jsx(ue,{...v,children:o.jsxs(t.Form,{children:[o.jsx(H,{type:"hidden",name:"cartId",value:s.id}),Object.entries(d).map(([R,k],T)=>{var F;return k.length<1?null:o.jsxs(m.Fragment,{children:[T>0&&o.jsx("hr",{className:"my-6"}),!!((F=s==null?void 0:s.shipping_methods)!=null&&F.length)&&o.jsx(ve,{type:"info",className:"my-6",children:"Choose your delivery option"}),o.jsx(Dn,{disabled:a,name:`shippingOptionIds.${T}`,shippingOptions:k,region:s.region,value:(g==null?void 0:g[T])??null,onValueChange:B=>v.setValue(`shippingOptionIds.${T}`,B)})]},R)})]})})]})},Te={update:async t=>{const e=await fetch("/api/checkout/express",{method:"POST",body:me(t)});return e.ok?[await e.json(),null]:[null,new Error("Failed to update shipping address")]}};/*!
 * react-paypal-js v8.9.2 (2025-10-02T20:17:55.069Z)
 * Copyright 2020-present, PayPal, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var O;(function(t){t.INITIAL="initial",t.PENDING="pending",t.REJECTED="rejected",t.RESOLVED="resolved"})(O||(O={}));var V;(function(t){t.LOADING_STATUS="setLoadingStatus",t.RESET_OPTIONS="resetOptions",t.SET_BRAINTREE_INSTANCE="braintreeInstance"})(V||(V={}));var De;(function(t){t.NUMBER="number",t.CVV="cvv",t.EXPIRATION_DATE="expirationDate",t.EXPIRATION_MONTH="expirationMonth",t.EXPIRATION_YEAR="expirationYear",t.POSTAL_CODE="postalCode"})(De||(De={}));var C=function(){return C=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},C.apply(this,arguments)};function ot(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Fe(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var te="data-react-paypal-script-id",G={DATA_JS_SDK_LIBRARY:"dataJsSdkLibrary",DATA_LIBRARY_VALUE:"react-paypal-js",DATA_NAMESPACE:"dataNamespace",DATA_SDK_INTEGRATION_SOURCE:"dataSdkIntegrationSource"},Un="Failed to load the PayPal JS SDK script.",st="paypal",Mn="usePayPalScriptReducer must be used within a PayPalScriptProvider";function qn(t){return t===void 0&&(t=st),window[t]}function Vn(t){for(var e="",n=0;n<t.length;n++){var r=t[n].charCodeAt(0)*n;t[n+1]&&(r+=t[n+1].charCodeAt(0)*(n-1)),e+=String.fromCharCode(97+Math.abs(r)%26)}return e}function Wn(t){var e=t.reactComponentName,n=t.sdkComponentKey,r=t.sdkRequestedComponents,i=r===void 0?"":r,s=t.sdkDataNamespace,a=s===void 0?st:s,l=n.charAt(0).toUpperCase().concat(n.substring(1)),c="Unable to render <".concat(e," /> because window.").concat(a,".").concat(l," is undefined."),u=typeof i=="string"?i:i.join(",");if(!u.includes(n)){var p=[u,n].filter(Boolean).join();c+=`
To fix the issue, add '`.concat(n,"' to the list of components passed to the parent PayPalScriptProvider:")+"\n`<PayPalScriptProvider options={{ components: '".concat(p,"'}}>`.")}return c}function it(t){var e=t,n=te;e[n];var r=ot(e,[n+""]);return"react-paypal-js-".concat(Vn(JSON.stringify(r)))}function $n(t){var e=self.document.querySelector("script[".concat(te,'="').concat(t,'"]'));e!=null&&e.parentNode&&e.parentNode.removeChild(e)}function Gn(t,e){var n,r;switch(e.type){case V.LOADING_STATUS:return typeof e.value=="object"?C(C({},t),{loadingStatus:e.value.state,loadingStatusErrorMessage:e.value.message}):C(C({},t),{loadingStatus:e.value});case V.RESET_OPTIONS:return $n(t.options[te]),C(C({},t),{loadingStatus:O.PENDING,options:C(C((n={},n[G.DATA_SDK_INTEGRATION_SOURCE]=G.DATA_LIBRARY_VALUE,n),e.value),(r={},r[te]="".concat(it(e.value)),r))});case V.SET_BRAINTREE_INSTANCE:return C(C({},t),{braintreePayPalCheckoutInstance:e.value});default:return t}}var at=m.createContext(null);function Kn(t){if(typeof(t==null?void 0:t.dispatch)=="function"&&t.dispatch.length!==0)return t;throw new Error(Mn)}function Yn(){var t=Kn(m.useContext(at)),e=C(C({},t),{isInitial:t.loadingStatus===O.INITIAL,isPending:t.loadingStatus===O.PENDING,isResolved:t.loadingStatus===O.RESOLVED,isRejected:t.loadingStatus===O.REJECTED});return[e,t.dispatch]}m.createContext({});function Jn(t){var e=m.useRef(new Proxy({},{get:function(n,r,i){return typeof n[r]=="function"?function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];return n[r].apply(n,s)}:Reflect.get(n,r,i)}}));return e.current=Object.assign(e.current,t),e.current}var je=function(t){var e,n=t.className,r=n===void 0?"":n,i=t.disabled,s=i===void 0?!1:i,a=t.children,l=t.forceReRender,c=l===void 0?[]:l,u=ot(t,["className","disabled","children","forceReRender"]),p=s?{opacity:.38}:{},d="".concat(r," ").concat(s?"paypal-buttons-disabled":"").trim(),h=m.useRef(null),b=m.useRef(null),v=Jn(u),g=Yn()[0],j=g.isResolved,f=g.options,_=m.useState(null),w=_[0],R=_[1],k=m.useState(!0),T=k[0],F=k[1],B=m.useState(null),x=B[1];function I(){b.current!==null&&b.current.close().catch(function(){})}return!((e=b.current)===null||e===void 0)&&e.updateProps&&b.current.updateProps({message:u.message}),m.useEffect(function(){if(j===!1)return I;var U=qn(f.dataNamespace);if(U===void 0||U.Buttons===void 0)return x(function(){throw new Error(Wn({reactComponentName:je.displayName,sdkComponentKey:"buttons",sdkRequestedComponents:f.components,sdkDataNamespace:f[G.DATA_NAMESPACE]}))}),I;var Y=function($,Q){R(Q),typeof u.onInit=="function"&&u.onInit($,Q)};try{b.current=U.Buttons(C(C({},v),{onInit:Y}))}catch($){return x(function(){throw new Error("Failed to render <PayPalButtons /> component. Failed to initialize:  ".concat($))})}return b.current.isEligible()===!1?(F(!1),I):(h.current&&b.current.render(h.current).catch(function($){h.current===null||h.current.children.length===0||x(function(){throw new Error("Failed to render <PayPalButtons /> component. ".concat($))})}),I)},Fe(Fe([j],c,!0),[u.fundingSource],!1)),m.useEffect(function(){w!==null&&(s===!0?w.disable().catch(function(){}):w.enable().catch(function(){}))},[s,w]),y.createElement(y.Fragment,null,T?y.createElement("div",{ref:h,style:p,className:d}):a)};je.displayName="PayPalButtons";function zn(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Qn(t,e){var n=document.querySelector('script[src="'.concat(t,'"]'));if(n===null)return null;var r=ct(t,e),i=n.cloneNode();if(delete i.dataset.uidAuto,Object.keys(i.dataset).length!==Object.keys(r.dataset).length)return null;var s=!0;return Object.keys(i.dataset).forEach(function(a){i.dataset[a]!==r.dataset[a]&&(s=!1)}),s?n:null}function Xn(t){var e=t.url,n=t.attributes,r=t.onSuccess,i=t.onError,s=ct(e,n);s.onerror=i,s.onload=r,document.head.insertBefore(s,document.head.firstElementChild)}function Zn(t){var e=t.sdkBaseUrl,n=t.environment,r=zn(t,["sdkBaseUrl","environment"]),i=e||tr(n),s=r,a=Object.keys(s).filter(function(u){return typeof s[u]<"u"&&s[u]!==null&&s[u]!==""}).reduce(function(u,p){var d=s[p].toString();return p=Hn(p),p.substring(0,4)==="data"||p==="crossorigin"?u.attributes[p]=d:u.queryParams[p]=d,u},{queryParams:{},attributes:{}}),l=a.queryParams,c=a.attributes;return l["merchant-id"]&&l["merchant-id"].indexOf(",")!==-1&&(c["data-merchant-id"]=l["merchant-id"],l["merchant-id"]="*"),{url:"".concat(i,"?").concat(er(l)),attributes:c}}function Hn(t){var e=function(n,r){return(r?"-":"")+n.toLowerCase()};return t.replace(/[A-Z]+(?![a-z])|[A-Z]/g,e)}function er(t){var e="";return Object.keys(t).forEach(function(n){e.length!==0&&(e+="&"),e+=n+"="+t[n]}),e}function tr(t){return t==="sandbox"?"https://www.sandbox.paypal.com/sdk/js":"https://www.paypal.com/sdk/js"}function ct(t,e){e===void 0&&(e={});var n=document.createElement("script");return n.src=t,Object.keys(e).forEach(function(r){n.setAttribute(r,e[r]),r==="data-csp-nonce"&&n.setAttribute("nonce",e["data-csp-nonce"])}),n}function nr(t,e){if(e===void 0&&(e=Promise),lt(t,e),typeof document>"u")return e.resolve(null);var n=Zn(t),r=n.url,i=n.attributes,s=i["data-namespace"]||"paypal",a=Le(s);return i["data-js-sdk-library"]||(i["data-js-sdk-library"]="paypal-js"),Qn(r,i)&&a?e.resolve(a):rr({url:r,attributes:i},e).then(function(){var l=Le(s);if(l)return l;throw new Error("The window.".concat(s," global variable is not available."))})}function rr(t,e){e===void 0&&(e=Promise),lt(t,e);var n=t.url,r=t.attributes;if(typeof n!="string"||n.length===0)throw new Error("Invalid url.");if(typeof r<"u"&&typeof r!="object")throw new Error("Expected attributes to be an object.");return new e(function(i,s){if(typeof document>"u")return i();Xn({url:n,attributes:r,onSuccess:function(){return i()},onError:function(){var a=new Error('The script "'.concat(n,'" failed to load. Check the HTTP status code and response body in DevTools to learn more.'));return s(a)}})})}function Le(t){return window[t]}function lt(t,e){if(typeof t!="object"||t===null)throw new Error("Expected an options object.");var n=t.environment;if(n&&n!=="production"&&n!=="sandbox")throw new Error('The `environment` option must be either "production" or "sandbox".');if(typeof e<"u"&&typeof e!="function")throw new Error("Expected PromisePonyfill to be a function.")}var or=function(t){var e,n=t.options,r=n===void 0?{clientId:"test"}:n,i=t.children,s=t.deferLoading,a=s===void 0?!1:s,l=m.useReducer(Gn,{options:C(C({},r),(e={},e[G.DATA_JS_SDK_LIBRARY]=G.DATA_LIBRARY_VALUE,e[G.DATA_SDK_INTEGRATION_SOURCE]=G.DATA_LIBRARY_VALUE,e[te]="".concat(it(r)),e)),loadingStatus:a?O.INITIAL:O.PENDING}),c=l[0],u=l[1];return m.useEffect(function(){if(a===!1&&c.loadingStatus===O.INITIAL)return u({type:V.LOADING_STATUS,value:O.PENDING});if(c.loadingStatus===O.PENDING){var p=!0;return nr(c.options).then(function(){p&&u({type:V.LOADING_STATUS,value:O.RESOLVED})}).catch(function(d){console.error("".concat(Un," ").concat(d)),p&&u({type:V.LOADING_STATUS,value:{state:O.REJECTED,message:String(d)}})}),function(){p=!1}}},[c.options,a,c.loadingStatus]),y.createElement(at.Provider,{value:C(C({},c),{dispatch:u})},i)};function Be(){}m.createContext({cardFieldsForm:null,fields:{},registerField:Be,unregisterField:Be});function sr({cart:t}){const e=mt(),{paymentProviders:n,step:r}=W(),[i,s]=m.useState(null),[a,l]=m.useState(t),c=r===K.PAYMENT,u=m.useMemo(()=>n==null?void 0:n.some(v=>{var g;return(g=v.id)==null?void 0:g.includes("paypal")}),[n]),p=m.useMemo(()=>({clientId:"AUvtGlVenK_bQoUrek0Nl43oRCDETrBjP2ZlhRQcdBuJp1Pt16gSaitZV3aXAhUFIIQBGY29PqKhncLq",components:"buttons",intent:"capture",currency:(a.currency_code||"USD").toUpperCase()}),[a.currency_code]);if(m.useEffect(()=>{l(t)},[t]),!a||!u)return null;const d={borderRadius:10},h=async()=>{var _,w,R;const[v,g]=await Te.update({cartId:a.id,complete:!1});if(g)return s({title:"Error updating account details",description:g.message}),"";const f=(w=(_=v.cart.payment_collection)==null?void 0:_.payment_sessions)==null?void 0:w[0];return((R=f==null?void 0:f.data)==null?void 0:R.id)||""},b=async(v,g)=>{try{if(!(g!=null&&g.order))return;const[j,f]=await Te.update({cartId:a.id,complete:!0});if(f){s({title:"Payment failed",description:f.message});return}const{order:_}=j;if(!_){s({title:"Payment failed",description:"Error trying to complete checkout."});return}e(`/checkout/success?order_id=${_.id}`)}catch(j){const f=j instanceof Error?j.message:"Error trying to submit payment.";s({title:"Payment failed",description:f})}};return o.jsxs("div",{className:M("App",!c&&"hidden"),children:[i?o.jsx(ve,{type:"error",title:i.title,className:"mt-4",children:i.description}):null,o.jsx("div",{className:"py-4 relative z-0",children:o.jsx(or,{options:p,children:o.jsx(je,{style:d,createOrder:h,onApprove:b,onError:v=>{const g=v instanceof Error?v.message:"PayPal error";s({title:"Payment failed",description:g})}})})})]})}const ir=()=>{const{customer:t}=be(),{goToNextStep:e,cart:n}=W(),r=!!(t!=null&&t.id);if(n)return m.useEffect(()=>(r&&e(),()=>e()),[r]),o.jsx(o.Fragment,{children:o.jsxs("div",{className:"lg:min-h-[calc(100vh-320px)] lg:pl-8",children:[r&&o.jsxs(ve,{type:"info",className:"mb-8",children:["Checking out as:"," ",o.jsxs("strong",{className:"font-bold",children:[t.first_name," ",t.last_name," (",t.email,")"]})]}),o.jsx(Pn,{}),o.jsx("hr",{className:"my-10"}),o.jsx(Bn,{}),o.jsx(sr,{cart:n})]})})},ar=({formId:t,item:e,className:n,maxInventory:r=10,...i})=>{const s=ne({key:ge.cart.updateLineItem}),a=["submitting","loading"].includes(s.state),l=le({resolver:ce(Bt),defaultValues:{lineItemId:e.id,quantity:e.quantity.toString()},fetcher:s,submitConfig:{method:"post",action:"/api/cart/line-items/update"}}),c=u=>{s.submit({lineItemId:e.id,quantity:u},{method:"post",action:"/api/cart/line-items/update"})};return o.jsx(ue,{...l,children:o.jsx(s.Form,{id:t,className:M("line-item-quantity-select",n),...i,onSubmit:l.handleSubmit,children:o.jsx(Tt,{formId:t,className:M({"pointer-events-none opacity-50":a}),variant:e.variant,onChange:c})})})},cr=({item:t,name:e})=>{var a,l,c;const{cart:n}=W(),r=At(),i=()=>r.submit(t),s=["loading","submitting"].includes(r.state);return n?o.jsxs("li",{className:"flex px-4 py-6 sm:px-6",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Ot,{src:((l=(a=t.variant)==null?void 0:a.product)==null?void 0:l.thumbnail)||"",alt:t.product_title||"product thumbnail",className:"w-20 rounded-md"})}),o.jsxs("div",{className:"ml-6 flex flex-1 flex-col",children:[o.jsxs("div",{className:"flex",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h4",{className:"text-base",children:o.jsx(Ue,{to:`/products/${t.product_handle}`,className:"font-bold text-gray-700 hover:text-gray-800",children:t.product_title})}),o.jsx("p",{className:"mt-0.5 text-sm text-gray-500",children:t.variant_title})]}),o.jsx("div",{className:"ml-4 flow-root flex-shrink-0",children:o.jsx(ae,{variant:"link",onClick:i,disabled:s,className:"text-sm",children:s?"Removing":"Remove"})})]}),o.jsxs("div",{className:"flex flex-1 items-end justify-between pt-2",children:[o.jsx("div",{className:"mr-4",children:o.jsx(ar,{formId:`quantity-${e}-${t.id}`,item:t})}),o.jsx("p",{className:"mt-1 text-lg",children:o.jsx("span",{className:"font-bold text-gray-900",children:ie(t.unit_price,{currency:(c=n.region)==null?void 0:c.currency_code})})})]})]})]}):null},lr=({cart:t,name:e})=>{var n;return o.jsx("ul",{role:"list",className:"divide-y divide-gray-200",children:(n=t.items)==null?void 0:n.map(r=>o.jsx(cr,{item:r,name:e},r.id))})},ur=({cart:t,promotion:e})=>{const n=ne({key:ge.cart.removePromotionCode});return["submitting","loading"].includes(n.state)?null:o.jsxs(n.Form,{method:"post",action:"/api/checkout/remove-discount-code",children:[o.jsx("input",{type:"hidden",name:"cartId",value:t.id}),o.jsx("input",{type:"hidden",name:"code",value:e.code}),o.jsxs("button",{className:"focus:ring-primary-100 focus:border-primary-100 inline-flex h-8 items-center rounded-md border border-gray-300 bg-white px-2 text-xs font-bold text-gray-900 shadow-sm hover:bg-gray-100",children:[o.jsx("span",{children:e.code}),o.jsx("div",{className:"ml-[4px] inline-block text-gray-400",children:o.jsx(wt,{className:"inline-block h-4 w-4 leading-none"})})]})]})},dr=({cart:t})=>{var d,h,b;const e=m.useRef(null),n=m.useRef(null),r=ne(),[i,s]=m.useState(!!t.promotions.length),a=!!((d=t.promotions)!=null&&d.length),l=Object.keys(((h=r.data)==null?void 0:h.errors)||{}).length>0,c=["submitting","loading"].includes(r.state),u=le({resolver:ce(Ut),defaultValues:{cartId:t.id,code:""},fetcher:r,submitConfig:{method:"post",action:"/api/checkout/discount-code"}});m.useEffect(()=>{var v;!c&&!l&&(u.reset(),(v=n.current)==null||v.focus())},[c,l]);const p=()=>{s(!0),setTimeout(()=>{var v;return(v=n.current)==null?void 0:v.focus()},0)};return o.jsxs("div",{className:"mb-6",children:[!i&&o.jsx("div",{children:o.jsx(Dt,{size:"sm",onClick:p,children:"Add promo code"})}),i&&o.jsxs(o.Fragment,{children:[o.jsx(ue,{...u,children:o.jsxs(r.Form,{ref:e,onSubmit:u.handleSubmit,children:[o.jsx("input",{type:"hidden",name:"cartId",value:t.id}),o.jsxs("div",{className:"!my-0 !flex items-start gap-1",children:[o.jsx(fe,{name:"code",className:"flex-grow",placeholder:"Discount code","aria-label":"discount code"}),o.jsx(Ve,{type:"submit",className:"flex-shrink-0 flex-grow-0",disabled:c,children:c?"Applying...":"Apply"})]}),o.jsx(Me,{})]})}),a&&o.jsx("div",{className:"mt-2",children:(b=t.promotions)==null?void 0:b.map(v=>o.jsx(ur,{cart:t,promotion:v},v.id))})]})]})},J=({label:t,amount:e,className:n,region:r})=>o.jsxs("div",{className:M("flex items-center justify-between text-sm",n),children:[o.jsx("dt",{children:t}),o.jsx("dd",{className:"font-bold text-gray-900",children:ie(e||0,{currency:r==null?void 0:r.currency_code})})]}),pr=({shippingOptions:t,cart:e})=>{const r=(e.shipping_methods||[]).length>0,i=Wt(t),s=e.discount_total??0,a=e.shipping_total??0,l=e.total??0,c=r?l:l+i;return o.jsxs("div",{className:"border-t border-gray-200 px-4 py-6 sm:px-6",children:[o.jsx(dr,{cart:e}),o.jsxs("dl",{className:"flex flex-col gap-2",children:[o.jsx(J,{label:"Subtotal",amount:e.item_subtotal,region:e.region}),s>0&&o.jsx(J,{label:"Discount",amount:-s,region:e.region}),r&&o.jsx(J,{label:"Shipping",amount:a,region:e.region}),!r&&o.jsx(J,{label:"Estimated Shipping",amount:i,region:e.region}),o.jsx(J,{label:"Taxes",amount:e.tax_total,region:e.region}),o.jsx(J,{label:"Total",amount:c,className:"border-t border-gray-200 pt-6 !text-xl",region:e.region})]})]})},mr=({submitButton:t,name:e})=>{const{shippingOptions:n,cart:r}=W();return r?o.jsxs("div",{className:"my-0 rounded-lg border border-gray-200 bg-white shadow-sm",children:[o.jsx("h3",{className:"sr-only",children:"Items in your cart"}),o.jsx(lr,{cart:r,name:e}),o.jsx(pr,{cart:r,shippingOptions:n}),t&&o.jsx("div",{className:"border-t border-gray-200 p-4 sm:p-6",children:t})]}):null},fr=()=>{const{step:t}=W();return o.jsx("div",{className:M("h-full",{"hidden lg:block":t===K.PAYMENT}),children:o.jsx("div",{className:"sticky top-24",children:o.jsx(mr,{name:"sidebar"})})})},hr=({icon:t,title:e,description:n,action:r})=>o.jsxs("div",{className:"py-16 text-center",children:[t&&o.jsx("div",{className:"inline-block text-gray-300",children:o.jsx(t,{className:"h-10 w-10"})}),o.jsx("h2",{className:"mt-2 text-lg font-bold text-gray-900",children:e}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n}),r&&o.jsx("div",{className:"mt-6",children:r})]}),Ir=ft(function(){var s;const{shippingOptions:e,paymentProviders:n,activePaymentSession:r,cart:i}=ht();return!i||!((s=i.items)!=null&&s.length)?o.jsx(hr,{icon:_t,title:"No items in your cart.",description:"Add items to your cart",action:o.jsx(ae,{variant:"primary",as:a=>o.jsx(Ue,{to:"/products",...a}),children:"Start shopping"})}):o.jsx(Kt,{data:{cart:i,activePaymentSession:r,shippingOptions:e,paymentProviders:n},children:o.jsx("section",{children:o.jsx("div",{className:"mx-auto max-w-2xl px-4 pb-8 pt-6 sm:px-6 sm:pb-16 sm:pt-8 lg:max-w-7xl lg:px-8 lg:pb-24 lg:pt-16",children:o.jsxs("div",{className:"lg:grid lg:grid-cols-[4fr_3fr] lg:gap-x-12 xl:gap-x-16",children:[o.jsx(ir,{}),o.jsx(fr,{})]})})})})});export{Ir as default};
